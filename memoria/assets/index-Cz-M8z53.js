(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const u of f)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function a(f){const u={};return f.integrity&&(u.integrity=f.integrity),f.referrerPolicy&&(u.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?u.credentials="include":f.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function l(f){if(f.ep)return;f.ep=!0;const u=a(f);fetch(f.href,u)}})();const hi=!1;var ko=Array.isArray,ll=Array.prototype.indexOf,un=Array.prototype.includes,Co=Array.from,Na=Object.defineProperty,sn=Object.getOwnPropertyDescriptor,La=Object.getOwnPropertyDescriptors,ul=Object.prototype,cl=Array.prototype,Ai=Object.getPrototypeOf,ga=Object.isExtensible;const ln=()=>{};function fl(r){return r()}function pi(r){for(var n=0;n<r.length;n++)r[n]()}function qa(){var r,n,a=new Promise((l,f)=>{r=l,n=f});return{promise:a,resolve:r,reject:n}}const _t=2,yo=4,Un=8,za=1<<24,hr=16,Jt=32,Hr=64,Oi=128,Ut=512,pt=1024,wt=2048,$t=4096,Ft=8192,fr=16384,Pi=32768,cn=65536,ya=1<<17,Ua=1<<18,yn=1<<19,Va=1<<20,Er=1<<25,Ur=32768,mi=1<<21,Bi=1<<22,Sr=1<<23,dr=Symbol("$state"),dl=Symbol("legacy props"),vl=Symbol(""),on=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Di(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function hl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function pl(r,n,a){throw new Error("https://svelte.dev/e/each_key_duplicate")}function ml(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function gl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function yl(r){throw new Error("https://svelte.dev/e/effect_orphan")}function bl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function _l(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function wl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function xl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function kl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Cl(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const El=1,Sl=2,Al=16,Ol=1,Pl=2,Bl=4,Dl=8,Ml=16,$a=1,jl=2,bt=Symbol(),Rl="http://www.w3.org/1999/xhtml";function Tl(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Ha(r){return r===this.v}function Ya(r,n){return r!=r?n==n:r!==n||r!==null&&typeof r=="object"||typeof r=="function"}function Wa(r){return!Ya(r,this.v)}let bn=!1,Il=!1;function Fl(){bn=!0}let Ze=null;function fn(r){Ze=r}function Bt(r,n=!1,a){Ze={p:Ze,i:!1,c:null,e:null,s:r,x:null,l:bn&&!n?{s:null,u:null,$:[]}:null}}function Dt(r){var n=Ze,a=n.e;if(a!==null){n.e=null;for(var l of a)vs(l)}return n.i=!0,Ze=n.p,{}}function _n(){return!bn||Ze!==null&&Ze.l===null}let Nr=[];function Ga(){var r=Nr;Nr=[],pi(r)}function rr(r){if(Nr.length===0&&!Ln){var n=Nr;queueMicrotask(()=>{n===Nr&&Ga()})}Nr.push(r)}function Kl(){for(;Nr.length>0;)Ga()}function Xa(r){var n=$e;if(n===null)return Te.f|=Sr,r;if((n.f&Pi)===0){if((n.f&Oi)===0)throw r;n.b.error(r)}else dn(r,n)}function dn(r,n){for(;n!==null;){if((n.f&Oi)!==0)try{n.b.error(r);return}catch(a){r=a}n=n.parent}throw r}const Nl=-7169;function it(r,n){r.f=r.f&Nl|n}function Mi(r){(r.f&Ut)!==0||r.deps===null?it(r,pt):it(r,$t)}function Qa(r){if(r!==null)for(const n of r)(n.f&_t)===0||(n.f&Ur)===0||(n.f^=Ur,Qa(n.deps))}function Ja(r,n,a){(r.f&wt)!==0?n.add(r):(r.f&$t)!==0&&a.add(r),Qa(r.deps),it(r,pt)}const ho=new Set;let Ye=null,gi=null,Gt=null,At=[],Eo=null,yi=!1,Ln=!1;class Ar{committed=!1;current=new Map;previous=new Map;#t=new Set;#s=new Set;#e=0;#i=0;#a=null;#n=new Set;#r=new Set;#o=new Map;is_fork=!1;#l=!1;is_deferred(){return this.is_fork||this.#i>0}skip_effect(n){this.#o.has(n)||this.#o.set(n,{d:[],m:[]})}unskip_effect(n){var a=this.#o.get(n);if(a){this.#o.delete(n);for(var l of a.d)it(l,wt),Xt(l);for(l of a.m)it(l,$t),Xt(l)}}process(n){At=[],this.apply();var a=[],l=[];for(const f of n)this.#u(f,a,l);if(this.is_deferred()){this.#c(l),this.#c(a);for(const[f,u]of this.#o)rs(f,u)}else{for(const f of this.#t)f();this.#t.clear(),this.#e===0&&this.#f(),gi=this,Ye=null,ba(l),ba(a),gi=null,this.#a?.resolve()}Gt=null}#u(n,a,l){n.f^=pt;for(var f=n.first,u=null;f!==null;){var h=f.f,m=(h&(Jt|Hr))!==0,g=m&&(h&pt)!==0,y=g||(h&Ft)!==0||this.#o.has(f);if(!y&&f.fn!==null){m?f.f^=pt:u!==null&&(h&(yo|Un|za))!==0?u.b.defer_effect(f):(h&yo)!==0?a.push(f):kn(f)&&((h&hr)!==0&&this.#r.add(f),pn(f));var B=f.first;if(B!==null){f=B;continue}}var S=f.parent;for(f=f.next;f===null&&S!==null;)S===u&&(u=null),f=S.next,S=S.parent}}#c(n){for(var a=0;a<n.length;a+=1)Ja(n[a],this.#n,this.#r)}capture(n,a){a!==bt&&!this.previous.has(n)&&this.previous.set(n,a),(n.f&Sr)===0&&(this.current.set(n,n.v),Gt?.set(n,n.v))}activate(){Ye=this,this.apply()}deactivate(){Ye===this&&(Ye=null,Gt=null)}flush(){if(this.activate(),At.length>0){if(Za(),Ye!==null&&Ye!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const n of this.#s)n(this);this.#s.clear()}#f(){if(ho.size>1){this.previous.clear();var n=Gt,a=!0;for(const f of ho){if(f===this){a=!1;continue}const u=[];for(const[m,g]of this.current){if(f.current.has(m))if(a&&g!==f.current.get(m))f.current.set(m,g);else continue;u.push(m)}if(u.length===0)continue;const h=[...f.current.keys()].filter(m=>!this.current.has(m));if(h.length>0){var l=At;At=[];const m=new Set,g=new Map;for(const y of u)es(y,h,m,g);if(At.length>0){Ye=f,f.apply();for(const y of At)f.#u(y,[],[]);f.deactivate()}At=l}}Ye=null,Gt=n}this.committed=!0,ho.delete(this)}increment(n){this.#e+=1,n&&(this.#i+=1)}decrement(n){this.#e-=1,n&&(this.#i-=1),!this.#l&&(this.#l=!0,rr(()=>{this.#l=!1,this.is_deferred()?At.length>0&&this.flush():this.revive()}))}revive(){for(const n of this.#n)this.#r.delete(n),it(n,wt),Xt(n);for(const n of this.#r)it(n,$t),Xt(n);this.flush()}oncommit(n){this.#t.add(n)}ondiscard(n){this.#s.add(n)}settled(){return(this.#a??=qa()).promise}static ensure(){if(Ye===null){const n=Ye=new Ar;ho.add(Ye),Ln||rr(()=>{Ye===n&&n.flush()})}return Ye}apply(){}}function Ll(r){var n=Ln;Ln=!0;try{for(var a;;){if(Kl(),At.length===0&&(Ye?.flush(),At.length===0))return Eo=null,a;Za()}}finally{Ln=n}}function Za(){yi=!0;var r=null;try{for(var n=0;At.length>0;){var a=Ar.ensure();if(n++>1e3){var l,f;ql()}a.process(At),Or.clear()}}finally{At=[],yi=!1,Eo=null}}function ql(){try{bl()}catch(r){dn(r,Eo)}}let lr=null;function ba(r){var n=r.length;if(n!==0){for(var a=0;a<n;){var l=r[a++];if((l.f&(fr|Ft))===0&&kn(l)&&(lr=new Set,pn(l),l.deps===null&&l.first===null&&l.nodes===null&&(l.teardown===null&&l.ac===null?ms(l):l.fn=null),lr?.size>0)){Or.clear();for(const f of lr){if((f.f&(fr|Ft))!==0)continue;const u=[f];let h=f.parent;for(;h!==null;)lr.has(h)&&(lr.delete(h),u.push(h)),h=h.parent;for(let m=u.length-1;m>=0;m--){const g=u[m];(g.f&(fr|Ft))===0&&pn(g)}}lr.clear()}}lr=null}}function es(r,n,a,l){if(!a.has(r)&&(a.add(r),r.reactions!==null))for(const f of r.reactions){const u=f.f;(u&_t)!==0?es(f,n,a,l):(u&(Bi|hr))!==0&&(u&wt)===0&&ts(f,n,l)&&(it(f,wt),Xt(f))}}function ts(r,n,a){const l=a.get(r);if(l!==void 0)return l;if(r.deps!==null)for(const f of r.deps){if(un.call(n,f))return!0;if((f.f&_t)!==0&&ts(f,n,a))return a.set(f,!0),!0}return a.set(r,!1),!1}function Xt(r){for(var n=Eo=r;n.parent!==null;){n=n.parent;var a=n.f;if(yi&&n===$e&&(a&hr)!==0&&(a&Ua)===0)return;if((a&(Hr|Jt))!==0){if((a&pt)===0)return;n.f^=pt}}At.push(n)}function rs(r,n){if(!((r.f&Jt)!==0&&(r.f&pt)!==0)){(r.f&wt)!==0?n.d.push(r):(r.f&$t)!==0&&n.m.push(r),it(r,pt);for(var a=r.first;a!==null;)rs(a,n),a=a.next}}function zl(r){let n=0,a=Vr(0),l;return()=>{Ri()&&(p(a),xn(()=>(n===0&&(l=ce(()=>r(()=>qn(a)))),n+=1,()=>{rr(()=>{n-=1,n===0&&(l?.(),l=void 0,qn(a))})})))}}var Ul=cn|yn|Oi;function Vl(r,n,a){new $l(r,n,a)}class $l{parent;is_pending=!1;#t;#s=null;#e;#i;#a;#n=null;#r=null;#o=null;#l=null;#u=null;#c=0;#f=0;#h=!1;#v=!1;#p=new Set;#m=new Set;#d=null;#w=zl(()=>(this.#d=Vr(this.#c),()=>{this.#d=null}));constructor(n,a,l){this.#t=n,this.#e=a,this.#i=l,this.parent=$e.b,this.is_pending=!!this.#e.pending,this.#a=Po(()=>{$e.b=this;{var f=this.#b();try{this.#n=zt(()=>l(f))}catch(u){this.error(u)}this.#f>0?this.#y():this.is_pending=!1}return()=>{this.#u?.remove()}},Ul)}#x(){try{this.#n=zt(()=>this.#i(this.#t))}catch(n){this.error(n)}}#k(){const n=this.#e.pending;n&&(this.#r=zt(()=>n(this.#t)),rr(()=>{var a=this.#b();this.#n=this.#g(()=>(Ar.ensure(),zt(()=>this.#i(a)))),this.#f>0?this.#y():(qr(this.#r,()=>{this.#r=null}),this.is_pending=!1)}))}#b(){var n=this.#t;return this.is_pending&&(this.#u=vr(),this.#t.before(this.#u),n=this.#u),n}defer_effect(n){Ja(n,this.#p,this.#m)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#g(n){var a=$e,l=Te,f=Ze;nr(this.#a),Ht(this.#a),fn(this.#a.ctx);try{return n()}catch(u){return Xa(u),null}finally{nr(a),Ht(l),fn(f)}}#y(){const n=this.#e.pending;this.#n!==null&&(this.#l=document.createDocumentFragment(),this.#l.append(this.#u),bs(this.#n,this.#l)),this.#r===null&&(this.#r=zt(()=>n(this.#t)))}#_(n){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(n);return}if(this.#f+=n,this.#f===0){this.is_pending=!1;for(const a of this.#p)it(a,wt),Xt(a);for(const a of this.#m)it(a,$t),Xt(a);this.#p.clear(),this.#m.clear(),this.#r&&qr(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null)}}update_pending_count(n){this.#_(n),this.#c+=n,!(!this.#d||this.#h)&&(this.#h=!0,rr(()=>{this.#h=!1,this.#d&&hn(this.#d,this.#c)}))}get_effect_pending(){return this.#w(),p(this.#d)}error(n){var a=this.#e.onerror;let l=this.#e.failed;if(this.#v||!a&&!l)throw n;this.#n&&(Pt(this.#n),this.#n=null),this.#r&&(Pt(this.#r),this.#r=null),this.#o&&(Pt(this.#o),this.#o=null);var f=!1,u=!1;const h=()=>{if(f){Tl();return}f=!0,u&&Cl(),Ar.ensure(),this.#c=0,this.#o!==null&&qr(this.#o,()=>{this.#o=null}),this.is_pending=this.has_pending_snippet(),this.#n=this.#g(()=>(this.#v=!1,zt(()=>this.#i(this.#t)))),this.#f>0?this.#y():this.is_pending=!1};rr(()=>{try{u=!0,a?.(n,h),u=!1}catch(m){dn(m,this.#a&&this.#a.parent)}l&&(this.#o=this.#g(()=>{Ar.ensure(),this.#v=!0;try{return zt(()=>{l(this.#t,()=>n,()=>h)})}catch(m){return dn(m,this.#a.parent),null}finally{this.#v=!1}}))})}}function Hl(r,n,a,l){const f=_n()?So:vn;var u=r.filter(A=>!A.settled);if(a.length===0&&u.length===0){l(n.map(f));return}var h=Ye,m=$e,g=Yl(),y=u.length===1?u[0].promise:u.length>1?Promise.all(u.map(A=>A.promise)):null;function B(A){g();try{l(A)}catch(F){(m.f&fr)===0&&dn(F,m)}h?.deactivate(),bi()}if(a.length===0){y.then(()=>B(n.map(f)));return}function S(){g(),Promise.all(a.map(A=>Wl(A))).then(A=>B([...n.map(f),...A])).catch(A=>dn(A,m))}y?y.then(S):S()}function Yl(){var r=$e,n=Te,a=Ze,l=Ye;return function(u=!0){nr(r),Ht(n),fn(a),u&&l?.activate()}}function bi(){nr(null),Ht(null),fn(null)}function So(r){var n=_t|wt,a=Te!==null&&(Te.f&_t)!==0?Te:null;return $e!==null&&($e.f|=yn),{ctx:Ze,deps:null,effects:null,equals:Ha,f:n,fn:r,reactions:null,rv:0,v:bt,wv:0,parent:a??$e,ac:null}}function Wl(r,n,a){let l=$e;l===null&&hl();var f=l.b,u=void 0,h=Vr(bt),m=!Te,g=new Map;return iu(()=>{var y=qa();u=y.promise;try{Promise.resolve(r()).then(y.resolve,y.reject).then(()=>{B===Ye&&B.committed&&B.deactivate(),bi()})}catch(F){y.reject(F),bi()}var B=Ye;if(m){var S=f.is_rendered();f.update_pending_count(1),B.increment(S),g.get(B)?.reject(on),g.delete(B),g.set(B,y)}const A=(F,R=void 0)=>{if(B.activate(),R)R!==on&&(h.f|=Sr,hn(h,R));else{(h.f&Sr)!==0&&(h.f^=Sr),hn(h,F);for(const[$,re]of g){if(g.delete($),$===B)break;re.reject(on)}}m&&(f.update_pending_count(-1),B.decrement(S))};y.promise.then(A,F=>A(null,F||"unknown"))}),Oo(()=>{for(const y of g.values())y.reject(on)}),new Promise(y=>{function B(S){function A(){S===u?y(h):B(u)}S.then(A,A)}B(u)})}function vn(r){const n=So(r);return n.equals=Wa,n}function ns(r){var n=r.effects;if(n!==null){r.effects=null;for(var a=0;a<n.length;a+=1)Pt(n[a])}}function Gl(r){for(var n=r.parent;n!==null;){if((n.f&_t)===0)return(n.f&fr)===0?n:null;n=n.parent}return null}function ji(r){var n,a=$e;nr(Gl(r));try{r.f&=~Ur,ns(r),n=ks(r)}finally{nr(a)}return n}function os(r){var n=ji(r);if(!r.equals(n)&&(r.wv=ws(),(!Ye?.is_fork||r.deps===null)&&(r.v=n,r.deps===null))){it(r,pt);return}Br||(Gt!==null?(Ri()||Ye?.is_fork)&&Gt.set(r,n):Mi(r))}let _i=new Set;const Or=new Map;let is=!1;function Vr(r,n){var a={f:0,v:r,reactions:null,equals:Ha,rv:0,wv:0};return a}function xr(r,n){const a=Vr(r);return lu(a),a}function ie(r,n=!1,a=!0){const l=Vr(r);return n||(l.equals=Wa),bn&&a&&Ze!==null&&Ze.l!==null&&(Ze.l.s??=[]).push(l),l}function It(r,n){return T(r,ce(()=>p(r))),n}function T(r,n,a=!1){Te!==null&&(!Qt||(Te.f&ya)!==0)&&_n()&&(Te.f&(_t|hr|Bi|ya))!==0&&(Vt===null||!un.call(Vt,r))&&kl();let l=a?an(n):n;return hn(r,l)}function hn(r,n){if(!r.equals(n)){var a=r.v;Br?Or.set(r,n):Or.set(r,a),r.v=n;var l=Ar.ensure();if(l.capture(r,a),(r.f&_t)!==0){const f=r;(r.f&wt)!==0&&ji(f),Mi(f)}r.wv=ws(),as(r,wt),_n()&&$e!==null&&($e.f&pt)!==0&&($e.f&(Jt|Hr))===0&&(qt===null?uu([r]):qt.push(r)),!l.is_fork&&_i.size>0&&!is&&Xl()}return n}function Xl(){is=!1;for(const r of _i)(r.f&pt)!==0&&it(r,$t),kn(r)&&pn(r);_i.clear()}function _a(r,n=1){var a=p(r),l=n===1?a++:a--;return T(r,a),l}function qn(r){T(r,r.v+1)}function as(r,n){var a=r.reactions;if(a!==null)for(var l=_n(),f=a.length,u=0;u<f;u++){var h=a[u],m=h.f;if(!(!l&&h===$e)){var g=(m&wt)===0;if(g&&it(h,n),(m&_t)!==0){var y=h;Gt?.delete(y),(m&Ur)===0&&(m&Ut&&(h.f|=Ur),as(y,$t))}else g&&((m&hr)!==0&&lr!==null&&lr.add(h),Xt(h))}}}function an(r){if(typeof r!="object"||r===null||dr in r)return r;const n=Ai(r);if(n!==ul&&n!==cl)return r;var a=new Map,l=ko(r),f=xr(0),u=zr,h=m=>{if(zr===u)return m();var g=Te,y=zr;Ht(null),Ca(u);var B=m();return Ht(g),Ca(y),B};return l&&a.set("length",xr(r.length)),new Proxy(r,{defineProperty(m,g,y){(!("value"in y)||y.configurable===!1||y.enumerable===!1||y.writable===!1)&&wl();var B=a.get(g);return B===void 0?h(()=>{var S=xr(y.value);return a.set(g,S),S}):T(B,y.value,!0),!0},deleteProperty(m,g){var y=a.get(g);if(y===void 0){if(g in m){const B=h(()=>xr(bt));a.set(g,B),qn(f)}}else T(y,bt),qn(f);return!0},get(m,g,y){if(g===dr)return r;var B=a.get(g),S=g in m;if(B===void 0&&(!S||sn(m,g)?.writable)&&(B=h(()=>{var F=an(S?m[g]:bt),R=xr(F);return R}),a.set(g,B)),B!==void 0){var A=p(B);return A===bt?void 0:A}return Reflect.get(m,g,y)},getOwnPropertyDescriptor(m,g){var y=Reflect.getOwnPropertyDescriptor(m,g);if(y&&"value"in y){var B=a.get(g);B&&(y.value=p(B))}else if(y===void 0){var S=a.get(g),A=S?.v;if(S!==void 0&&A!==bt)return{enumerable:!0,configurable:!0,value:A,writable:!0}}return y},has(m,g){if(g===dr)return!0;var y=a.get(g),B=y!==void 0&&y.v!==bt||Reflect.has(m,g);if(y!==void 0||$e!==null&&(!B||sn(m,g)?.writable)){y===void 0&&(y=h(()=>{var A=B?an(m[g]):bt,F=xr(A);return F}),a.set(g,y));var S=p(y);if(S===bt)return!1}return B},set(m,g,y,B){var S=a.get(g),A=g in m;if(l&&g==="length")for(var F=y;F<S.v;F+=1){var R=a.get(F+"");R!==void 0?T(R,bt):F in m&&(R=h(()=>xr(bt)),a.set(F+"",R))}if(S===void 0)(!A||sn(m,g)?.writable)&&(S=h(()=>xr(void 0)),T(S,an(y)),a.set(g,S));else{A=S.v!==bt;var $=h(()=>an(y));T(S,$)}var re=Reflect.getOwnPropertyDescriptor(m,g);if(re?.set&&re.set.call(B,y),!A){if(l&&typeof g=="string"){var ue=a.get("length"),de=Number(g);Number.isInteger(de)&&de>=ue.v&&T(ue,de+1)}qn(f)}return!0},ownKeys(m){p(f);var g=Reflect.ownKeys(m).filter(S=>{var A=a.get(S);return A===void 0||A.v!==bt});for(var[y,B]of a)B.v!==bt&&!(y in m)&&g.push(y);return g},setPrototypeOf(){xl()}})}function wa(r){try{if(r!==null&&typeof r=="object"&&dr in r)return r[dr]}catch{}return r}function Ql(r,n){return Object.is(wa(r),wa(n))}var zn,ss,ls,us;function Jl(){if(zn===void 0){zn=window,ss=/Firefox/.test(navigator.userAgent);var r=Element.prototype,n=Node.prototype,a=Text.prototype;ls=sn(n,"firstChild").get,us=sn(n,"nextSibling").get,ga(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),ga(a)&&(a.__t=void 0)}}function vr(r=""){return document.createTextNode(r)}function ur(r){return ls.call(r)}function Vn(r){return us.call(r)}function M(r,n){return ur(r)}function Pr(r,n=!1){{var a=ur(r);return a instanceof Comment&&a.data===""?Vn(a):a}}function K(r,n=1,a=!1){let l=r;for(;n--;)l=Vn(l);return l}function Zl(r){r.textContent=""}function cs(){return!1}let xa=!1;function eu(){xa||(xa=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{if(!r.defaultPrevented)for(const n of r.target.elements)n.__on_r?.()})},{capture:!0}))}function Ao(r){var n=Te,a=$e;Ht(null),nr(null);try{return r()}finally{Ht(n),nr(a)}}function fs(r,n,a,l=a){r.addEventListener(n,()=>Ao(a));const f=r.__on_r;f?r.__on_r=()=>{f(),l(!0)}:r.__on_r=()=>l(!0),eu()}function ds(r){$e===null&&(Te===null&&yl(),gl()),Br&&ml()}function tu(r,n){var a=n.last;a===null?n.last=n.first=r:(a.next=r,r.prev=a,n.last=r)}function or(r,n,a){var l=$e;l!==null&&(l.f&Ft)!==0&&(r|=Ft);var f={ctx:Ze,deps:null,nodes:null,f:r|wt|Ut,first:null,fn:n,last:null,next:null,parent:l,b:l&&l.b,prev:null,teardown:null,wv:0,ac:null};if(a)try{pn(f),f.f|=Pi}catch(m){throw Pt(f),m}else n!==null&&Xt(f);var u=f;if(a&&u.deps===null&&u.teardown===null&&u.nodes===null&&u.first===u.last&&(u.f&yn)===0&&(u=u.first,(r&hr)!==0&&(r&cn)!==0&&u!==null&&(u.f|=cn)),u!==null&&(u.parent=l,l!==null&&tu(u,l),Te!==null&&(Te.f&_t)!==0&&(r&Hr)===0)){var h=Te;(h.effects??=[]).push(u)}return f}function Ri(){return Te!==null&&!Qt}function Oo(r){const n=or(Un,null,!1);return it(n,pt),n.teardown=r,n}function wi(r){ds();var n=$e.f,a=!Te&&(n&Jt)!==0&&(n&Pi)===0;if(a){var l=Ze;(l.e??=[]).push(r)}else return vs(r)}function vs(r){return or(yo|Va,r,!1)}function ru(r){return ds(),or(Un|Va,r,!0)}function nu(r){Ar.ensure();const n=or(Hr|yn,r,!0);return(a={})=>new Promise(l=>{a.outro?qr(n,()=>{Pt(n),l(void 0)}):(Pt(n),l(void 0))})}function ou(r){return or(yo,r,!1)}function ht(r,n){var a=Ze,l={effect:null,ran:!1,deps:r};a.l.$.push(l),l.effect=xn(()=>{r(),!l.ran&&(l.ran=!0,ce(n))})}function wn(){var r=Ze;xn(()=>{for(var n of r.l.$){n.deps();var a=n.effect;(a.f&pt)!==0&&a.deps!==null&&it(a,$t),kn(a)&&pn(a),n.ran=!1}})}function iu(r){return or(Bi|yn,r,!0)}function xn(r,n=0){return or(Un|n,r,!0)}function Ae(r,n=[],a=[],l=[]){Hl(l,n,a,f=>{or(Un,()=>r(...f.map(p)),!0)})}function Po(r,n=0){var a=or(hr|n,r,!0);return a}function zt(r){return or(Jt|yn,r,!0)}function hs(r){var n=r.teardown;if(n!==null){const a=Br,l=Te;ka(!0),Ht(null);try{n.call(null)}finally{ka(a),Ht(l)}}}function ps(r,n=!1){var a=r.first;for(r.first=r.last=null;a!==null;){const f=a.ac;f!==null&&Ao(()=>{f.abort(on)});var l=a.next;(a.f&Hr)!==0?a.parent=null:Pt(a,n),a=l}}function au(r){for(var n=r.first;n!==null;){var a=n.next;(n.f&Jt)===0&&Pt(n),n=a}}function Pt(r,n=!0){var a=!1;(n||(r.f&Ua)!==0)&&r.nodes!==null&&r.nodes.end!==null&&(su(r.nodes.start,r.nodes.end),a=!0),ps(r,n&&!a),bo(r,0),it(r,fr);var l=r.nodes&&r.nodes.t;if(l!==null)for(const u of l)u.stop();hs(r);var f=r.parent;f!==null&&f.first!==null&&ms(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes=r.ac=null}function su(r,n){for(;r!==null;){var a=r===n?null:Vn(r);r.remove(),r=a}}function ms(r){var n=r.parent,a=r.prev,l=r.next;a!==null&&(a.next=l),l!==null&&(l.prev=a),n!==null&&(n.first===r&&(n.first=l),n.last===r&&(n.last=a))}function qr(r,n,a=!0){var l=[];gs(r,l,!0);var f=()=>{a&&Pt(r),n&&n()},u=l.length;if(u>0){var h=()=>--u||f();for(var m of l)m.out(h)}else f()}function gs(r,n,a){if((r.f&Ft)===0){r.f^=Ft;var l=r.nodes&&r.nodes.t;if(l!==null)for(const m of l)(m.is_global||a)&&n.push(m);for(var f=r.first;f!==null;){var u=f.next,h=(f.f&cn)!==0||(f.f&Jt)!==0&&(r.f&hr)!==0;gs(f,n,h?a:!1),f=u}}}function Ti(r){ys(r,!0)}function ys(r,n){if((r.f&Ft)!==0){r.f^=Ft,(r.f&pt)===0&&(it(r,wt),Xt(r));for(var a=r.first;a!==null;){var l=a.next,f=(a.f&cn)!==0||(a.f&Jt)!==0;ys(a,f?n:!1),a=l}var u=r.nodes&&r.nodes.t;if(u!==null)for(const h of u)(h.is_global||n)&&h.in()}}function bs(r,n){if(r.nodes)for(var a=r.nodes.start,l=r.nodes.end;a!==null;){var f=a===l?null:Vn(a);n.append(a),a=f}}let mo=!1,Br=!1;function ka(r){Br=r}let Te=null,Qt=!1;function Ht(r){Te=r}let $e=null;function nr(r){$e=r}let Vt=null;function lu(r){Te!==null&&(Vt===null?Vt=[r]:Vt.push(r))}let Ot=null,Tt=0,qt=null;function uu(r){qt=r}let _s=1,Lr=0,zr=Lr;function Ca(r){zr=r}function ws(){return++_s}function kn(r){var n=r.f;if((n&wt)!==0)return!0;if(n&_t&&(r.f&=~Ur),(n&$t)!==0){for(var a=r.deps,l=a.length,f=0;f<l;f++){var u=a[f];if(kn(u)&&os(u),u.wv>r.wv)return!0}(n&Ut)!==0&&Gt===null&&it(r,pt)}return!1}function xs(r,n,a=!0){var l=r.reactions;if(l!==null&&!(Vt!==null&&un.call(Vt,r)))for(var f=0;f<l.length;f++){var u=l[f];(u.f&_t)!==0?xs(u,n,!1):n===u&&(a?it(u,wt):(u.f&pt)!==0&&it(u,$t),Xt(u))}}function ks(r){var n=Ot,a=Tt,l=qt,f=Te,u=Vt,h=Ze,m=Qt,g=zr,y=r.f;Ot=null,Tt=0,qt=null,Te=(y&(Jt|Hr))===0?r:null,Vt=null,fn(r.ctx),Qt=!1,zr=++Lr,r.ac!==null&&(Ao(()=>{r.ac.abort(on)}),r.ac=null);try{r.f|=mi;var B=r.fn,S=B(),A=r.deps,F=Ye?.is_fork;if(Ot!==null){var R;if(F||bo(r,Tt),A!==null&&Tt>0)for(A.length=Tt+Ot.length,R=0;R<Ot.length;R++)A[Tt+R]=Ot[R];else r.deps=A=Ot;if(Ri()&&(r.f&Ut)!==0)for(R=Tt;R<A.length;R++)(A[R].reactions??=[]).push(r)}else!F&&A!==null&&Tt<A.length&&(bo(r,Tt),A.length=Tt);if(_n()&&qt!==null&&!Qt&&A!==null&&(r.f&(_t|$t|wt))===0)for(R=0;R<qt.length;R++)xs(qt[R],r);if(f!==null&&f!==r){if(Lr++,f.deps!==null)for(let $=0;$<a;$+=1)f.deps[$].rv=Lr;if(n!==null)for(const $ of n)$.rv=Lr;qt!==null&&(l===null?l=qt:l.push(...qt))}return(r.f&Sr)!==0&&(r.f^=Sr),S}catch($){return Xa($)}finally{r.f^=mi,Ot=n,Tt=a,qt=l,Te=f,Vt=u,fn(h),Qt=m,zr=g}}function cu(r,n){let a=n.reactions;if(a!==null){var l=ll.call(a,r);if(l!==-1){var f=a.length-1;f===0?a=n.reactions=null:(a[l]=a[f],a.pop())}}if(a===null&&(n.f&_t)!==0&&(Ot===null||!un.call(Ot,n))){var u=n;(u.f&Ut)!==0&&(u.f^=Ut,u.f&=~Ur),Mi(u),ns(u),bo(u,0)}}function bo(r,n){var a=r.deps;if(a!==null)for(var l=n;l<a.length;l++)cu(r,a[l])}function pn(r){var n=r.f;if((n&fr)===0){it(r,pt);var a=$e,l=mo;$e=r,mo=!0;try{(n&(hr|za))!==0?au(r):ps(r),hs(r);var f=ks(r);r.teardown=typeof f=="function"?f:null,r.wv=_s;var u;hi&&Il&&(r.f&wt)!==0&&r.deps}finally{mo=l,$e=a}}}async function fu(){await Promise.resolve(),Ll()}function p(r){var n=r.f,a=(n&_t)!==0;if(Te!==null&&!Qt){var l=$e!==null&&($e.f&fr)!==0;if(!l&&(Vt===null||!un.call(Vt,r))){var f=Te.deps;if((Te.f&mi)!==0)r.rv<Lr&&(r.rv=Lr,Ot===null&&f!==null&&f[Tt]===r?Tt++:Ot===null?Ot=[r]:Ot.push(r));else{(Te.deps??=[]).push(r);var u=r.reactions;u===null?r.reactions=[Te]:un.call(u,Te)||u.push(Te)}}}if(Br&&Or.has(r))return Or.get(r);if(a){var h=r;if(Br){var m=h.v;return((h.f&pt)===0&&h.reactions!==null||Es(h))&&(m=ji(h)),Or.set(h,m),m}var g=(h.f&Ut)===0&&!Qt&&Te!==null&&(mo||(Te.f&Ut)!==0),y=h.deps===null;kn(h)&&(g&&(h.f|=Ut),os(h)),g&&!y&&Cs(h)}if(Gt?.has(r))return Gt.get(r);if((r.f&Sr)!==0)throw r.v;return r.v}function Cs(r){if(r.deps!==null){r.f|=Ut;for(const n of r.deps)(n.reactions??=[]).push(r),(n.f&_t)!==0&&(n.f&Ut)===0&&Cs(n)}}function Es(r){if(r.v===bt)return!0;if(r.deps===null)return!1;for(const n of r.deps)if(Or.has(n)||(n.f&_t)!==0&&Es(n))return!0;return!1}function ce(r){var n=Qt;try{return Qt=!0,r()}finally{Qt=n}}function We(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(dr in r)xi(r);else if(!Array.isArray(r))for(let n in r){const a=r[n];typeof a=="object"&&a&&dr in a&&xi(a)}}}function xi(r,n=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!n.has(r)){n.add(r),r instanceof Date&&r.getTime();for(let l in r)try{xi(r[l],n)}catch{}const a=Ai(r);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const l=La(a);for(let f in l){const u=l[f].get;if(u)try{u.call(r)}catch{}}}}}const du=["touchstart","touchmove"];function vu(r){return du.includes(r)}const hu=new Set,Ea=new Set;function pu(r,n,a,l={}){function f(u){if(l.capture||Kn.call(n,u),!u.cancelBubble)return Ao(()=>a?.call(this,u))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?rr(()=>{n.addEventListener(r,f,l)}):n.addEventListener(r,f,l),f}function he(r,n,a,l,f){var u={capture:l,passive:f},h=pu(r,n,a,u);(n===document.body||n===window||n===document||n instanceof HTMLMediaElement)&&Oo(()=>{n.removeEventListener(r,h,u)})}let Sa=null;function Kn(r){var n=this,a=n.ownerDocument,l=r.type,f=r.composedPath?.()||[],u=f[0]||r.target;Sa=r;var h=0,m=Sa===r&&r.__root;if(m){var g=f.indexOf(m);if(g!==-1&&(n===document||n===window)){r.__root=n;return}var y=f.indexOf(n);if(y===-1)return;g<=y&&(h=g)}if(u=f[h]||r.target,u!==n){Na(r,"currentTarget",{configurable:!0,get(){return u||a}});var B=Te,S=$e;Ht(null),nr(null);try{for(var A,F=[];u!==null;){var R=u.assignedSlot||u.parentNode||u.host||null;try{var $=u["__"+l];$!=null&&(!u.disabled||r.target===u)&&$.call(u,r)}catch(re){A?F.push(re):A=re}if(r.cancelBubble||R===n||R===null)break;u=R}if(A){for(let re of F)queueMicrotask(()=>{throw re});throw A}}finally{r.__root=n,delete r.currentTarget,Ht(B),nr(S)}}}function Ss(r){var n=document.createElement("template");return n.innerHTML=r.replaceAll("<!>","<!---->"),n.content}function mn(r,n){var a=$e;a.nodes===null&&(a.nodes={start:r,end:n,a:null,t:null})}function J(r,n){var a=(n&$a)!==0,l=(n&jl)!==0,f,u=!r.startsWith("<!>");return()=>{f===void 0&&(f=Ss(u?r:"<!>"+r),a||(f=ur(f)));var h=l||ss?document.importNode(f,!0):f.cloneNode(!0);if(a){var m=ur(h),g=h.lastChild;mn(m,g)}else mn(h,h);return h}}function mu(r,n,a="svg"){var l=!r.startsWith("<!>"),f=(n&$a)!==0,u=`<${a}>${l?r:"<!>"+r}</${a}>`,h;return()=>{if(!h){var m=Ss(u),g=ur(m);if(f)for(h=document.createDocumentFragment();ur(g);)h.appendChild(ur(g));else h=ur(g)}var y=h.cloneNode(!0);if(f){var B=ur(y),S=y.lastChild;mn(B,S)}else mn(y,y);return y}}function Et(r,n){return mu(r,n,"svg")}function As(r=""){{var n=vr(r+"");return mn(n,n),n}}function Bo(){var r=document.createDocumentFragment(),n=document.createComment(""),a=vr();return r.append(n,a),mn(n,a),r}function z(r,n){r!==null&&r.before(n)}function Se(r,n){var a=n==null?"":typeof n=="object"?n+"":n;a!==(r.__t??=r.nodeValue)&&(r.__t=a,r.nodeValue=a+"")}function gu(r,n){return yu(r,n)}const rn=new Map;function yu(r,{target:n,anchor:a,props:l={},events:f,context:u,intro:h=!0}){Jl();var m=new Set,g=S=>{for(var A=0;A<S.length;A++){var F=S[A];if(!m.has(F)){m.add(F);var R=vu(F);n.addEventListener(F,Kn,{passive:R});var $=rn.get(F);$===void 0?(document.addEventListener(F,Kn,{passive:R}),rn.set(F,1)):rn.set(F,$+1)}}};g(Co(hu)),Ea.add(g);var y=void 0,B=nu(()=>{var S=a??n.appendChild(vr());return Vl(S,{pending:()=>{}},A=>{Bt({});var F=Ze;u&&(F.c=u),f&&(l.$$events=f),y=r(A,l)||{},Dt()}),()=>{for(var A of m){n.removeEventListener(A,Kn);var F=rn.get(A);--F===0?(document.removeEventListener(A,Kn),rn.delete(A)):rn.set(A,F)}Ea.delete(g),S!==a&&S.parentNode?.removeChild(S)}});return bu.set(y,B),y}let bu=new WeakMap;class Os{anchor;#t=new Map;#s=new Map;#e=new Map;#i=new Set;#a=!0;constructor(n,a=!0){this.anchor=n,this.#a=a}#n=()=>{var n=Ye;if(this.#t.has(n)){var a=this.#t.get(n),l=this.#s.get(a);if(l)Ti(l),this.#i.delete(a);else{var f=this.#e.get(a);f&&(this.#s.set(a,f.effect),this.#e.delete(a),f.fragment.lastChild.remove(),this.anchor.before(f.fragment),l=f.effect)}for(const[u,h]of this.#t){if(this.#t.delete(u),u===n)break;const m=this.#e.get(h);m&&(Pt(m.effect),this.#e.delete(h))}for(const[u,h]of this.#s){if(u===a||this.#i.has(u))continue;const m=()=>{if(Array.from(this.#t.values()).includes(u)){var y=document.createDocumentFragment();bs(h,y),y.append(vr()),this.#e.set(u,{effect:h,fragment:y})}else Pt(h);this.#i.delete(u),this.#s.delete(u)};this.#a||!l?(this.#i.add(u),qr(h,m,!1)):m()}}};#r=n=>{this.#t.delete(n);const a=Array.from(this.#t.values());for(const[l,f]of this.#e)a.includes(l)||(Pt(f.effect),this.#e.delete(l))};ensure(n,a){var l=Ye,f=cs();if(a&&!this.#s.has(n)&&!this.#e.has(n))if(f){var u=document.createDocumentFragment(),h=vr();u.append(h),this.#e.set(n,{effect:zt(()=>a(h)),fragment:u})}else this.#s.set(n,zt(()=>a(this.anchor)));if(this.#t.set(l,n),f){for(const[m,g]of this.#s)m===n?l.unskip_effect(g):l.skip_effect(g);for(const[m,g]of this.#e)m===n?l.unskip_effect(g.effect):l.skip_effect(g.effect);l.oncommit(this.#n),l.ondiscard(this.#r)}else this.#n()}}function me(r,n,a=!1){var l=new Os(r),f=a?cn:0;function u(h,m){l.ensure(h,m)}Po(()=>{var h=!1;n((m,g=0)=>{h=!0,u(g,m)}),h||u(!1,null)},f)}const _u=Symbol("NaN");function wu(r,n,a){var l=new Os(r),f=!_n();Po(()=>{var u=n();u!==u&&(u=_u),f&&u!==null&&typeof u=="object"&&(u={}),l.ensure(u,a)})}function xu(r,n,a){for(var l=[],f=n.length,u,h=n.length,m=0;m<f;m++){let S=n[m];qr(S,()=>{if(u){if(u.pending.delete(S),u.done.add(S),u.pending.size===0){var A=r.outrogroups;ki(Co(u.done)),A.delete(u),A.size===0&&(r.outrogroups=null)}}else h-=1},!1)}if(h===0){var g=l.length===0&&a!==null;if(g){var y=a,B=y.parentNode;Zl(B),B.append(y),r.items.clear()}ki(n,!g)}else u={pending:new Set(n),done:new Set},(r.outrogroups??=new Set).add(u)}function ki(r,n=!0){for(var a=0;a<r.length;a++)Pt(r[a],n)}var Aa;function Ps(r,n,a,l,f,u=null){var h=r,m=new Map;{var g=r;h=g.appendChild(vr())}var y=null,B=vn(()=>{var re=a();return ko(re)?re:re==null?[]:Co(re)}),S,A=!0;function F(){$.fallback=y,ku($,S,h,n,l),y!==null&&(S.length===0?(y.f&Er)===0?Ti(y):(y.f^=Er,Nn(y,null,h)):qr(y,()=>{y=null}))}var R=Po(()=>{S=p(B);for(var re=S.length,ue=new Set,de=Ye,ge=cs(),_e=0;_e<re;_e+=1){var X=S[_e],ae=l(X,_e),ve=A?null:m.get(ae);ve?(ve.v&&hn(ve.v,X),ve.i&&hn(ve.i,_e),ge&&de.unskip_effect(ve.e)):(ve=Cu(m,A?h:Aa??=vr(),X,ae,_e,f,n,a),A||(ve.e.f|=Er),m.set(ae,ve)),ue.add(ae)}if(re===0&&u&&!y&&(A?y=zt(()=>u(h)):(y=zt(()=>u(Aa??=vr())),y.f|=Er)),re>ue.size&&pl(),!A)if(ge){for(const[le,Be]of m)ue.has(le)||de.skip_effect(Be.e);de.oncommit(F),de.ondiscard(()=>{})}else F();p(B)}),$={effect:R,items:m,outrogroups:null,fallback:y};A=!1}function In(r){for(;r!==null&&(r.f&Jt)===0;)r=r.next;return r}function ku(r,n,a,l,f){var u=n.length,h=r.items,m=In(r.effect.first),g,y=null,B=[],S=[],A,F,R,$;for($=0;$<u;$+=1){if(A=n[$],F=f(A,$),R=h.get(F).e,r.outrogroups!==null)for(const le of r.outrogroups)le.pending.delete(R),le.done.delete(R);if((R.f&Er)!==0)if(R.f^=Er,R===m)Nn(R,null,a);else{var re=y?y.next:m;R===r.effect.last&&(r.effect.last=R.prev),R.prev&&(R.prev.next=R.next),R.next&&(R.next.prev=R.prev),kr(r,y,R),kr(r,R,re),Nn(R,re,a),y=R,B=[],S=[],m=In(y.next);continue}if((R.f&Ft)!==0&&Ti(R),R!==m){if(g!==void 0&&g.has(R)){if(B.length<S.length){var ue=S[0],de;y=ue.prev;var ge=B[0],_e=B[B.length-1];for(de=0;de<B.length;de+=1)Nn(B[de],ue,a);for(de=0;de<S.length;de+=1)g.delete(S[de]);kr(r,ge.prev,_e.next),kr(r,y,ge),kr(r,_e,ue),m=ue,y=_e,$-=1,B=[],S=[]}else g.delete(R),Nn(R,m,a),kr(r,R.prev,R.next),kr(r,R,y===null?r.effect.first:y.next),kr(r,y,R),y=R;continue}for(B=[],S=[];m!==null&&m!==R;)(g??=new Set).add(m),S.push(m),m=In(m.next);if(m===null)continue}(R.f&Er)===0&&B.push(R),y=R,m=In(R.next)}if(r.outrogroups!==null){for(const le of r.outrogroups)le.pending.size===0&&(ki(Co(le.done)),r.outrogroups?.delete(le));r.outrogroups.size===0&&(r.outrogroups=null)}if(m!==null||g!==void 0){var X=[];if(g!==void 0)for(R of g)(R.f&Ft)===0&&X.push(R);for(;m!==null;)(m.f&Ft)===0&&m!==r.fallback&&X.push(m),m=In(m.next);var ae=X.length;if(ae>0){var ve=u===0?a:null;xu(r,X,ve)}}}function Cu(r,n,a,l,f,u,h,m){var g=(h&El)!==0?(h&Al)===0?ie(a,!1,!1):Vr(a):null,y=(h&Sl)!==0?Vr(f):null;return{v:g,i:y,e:zt(()=>(u(n,g??a,y??f,m),()=>{r.delete(l)}))}}function Nn(r,n,a){if(r.nodes)for(var l=r.nodes.start,f=r.nodes.end,u=n&&(n.f&Er)===0?n.nodes.start:a;l!==null;){var h=Vn(l);if(u.before(l),l===f)return;l=h}}function kr(r,n,a){n===null?r.effect.first=a:n.next=a,a===null?r.effect.last=n:a.prev=n}const Oa=[...` 	
\r\fÂ \v\uFEFF`];function Eu(r,n,a){var l=r==null?"":""+r;if(a){for(var f in a)if(a[f])l=l?l+" "+f:f;else if(l.length)for(var u=f.length,h=0;(h=l.indexOf(f,h))>=0;){var m=h+u;(h===0||Oa.includes(l[h-1]))&&(m===l.length||Oa.includes(l[m]))?l=(h===0?"":l.substring(0,h))+l.substring(m+1):h=m}}return l===""?null:l}function Dr(r,n,a,l,f,u){var h=r.__className;if(h!==a||h===void 0){var m=Eu(a,l,u);m==null?r.removeAttribute("class"):r.className=m,r.__className=a}else if(u&&f!==u)for(var g in u){var y=!!u[g];(f==null||y!==!!f[g])&&r.classList.toggle(g,y)}return u}const Su=Symbol("is custom element"),Au=Symbol("is html");function $r(r,n,a,l){var f=Ou(r);f[n]!==(f[n]=a)&&(n==="loading"&&(r[vl]=a),a==null?r.removeAttribute(n):typeof a!="string"&&Pu(r).includes(n)?r[n]=a:r.setAttribute(n,a))}function Ou(r){return r.__attributes??={[Su]:r.nodeName.includes("-"),[Au]:r.namespaceURI===Rl}}var Pa=new Map;function Pu(r){var n=r.getAttribute("is")||r.nodeName,a=Pa.get(n);if(a)return a;Pa.set(n,a=[]);for(var l,f=r,u=Element.prototype;u!==f;){l=La(f);for(var h in l)l[h].set&&a.push(h);f=Ai(f)}return a}function Ci(r,n,a=n){var l=new WeakSet;fs(r,"input",async f=>{var u=f?r.defaultValue:r.value;if(u=di(r)?vi(u):u,a(u),Ye!==null&&l.add(Ye),await fu(),u!==(u=n())){var h=r.selectionStart,m=r.selectionEnd,g=r.value.length;if(r.value=u??"",m!==null){var y=r.value.length;h===m&&m===g&&y>g?(r.selectionStart=y,r.selectionEnd=y):(r.selectionStart=h,r.selectionEnd=Math.min(m,y))}}}),ce(n)==null&&r.value&&(a(di(r)?vi(r.value):r.value),Ye!==null&&l.add(Ye)),xn(()=>{var f=n();if(r===document.activeElement){var u=gi??Ye;if(l.has(u))return}di(r)&&f===vi(r.value)||r.type==="date"&&!f&&!r.value||f!==r.value&&(r.value=f??"")})}const fi=new Set;function Ba(r,n,a,l,f=l){var u=a.getAttribute("type")==="checkbox",h=r;if(n!==null)for(var m of n)h=h[m]??=[];h.push(a),fs(a,"change",()=>{var g=a.__value;u&&(g=Bu(h,g,a.checked)),f(g)},()=>f(u?[]:null)),xn(()=>{var g=l();u?(g=g||[],a.checked=g.includes(a.__value)):a.checked=Ql(a.__value,g)}),Oo(()=>{var g=h.indexOf(a);g!==-1&&h.splice(g,1)}),fi.has(h)||(fi.add(h),rr(()=>{h.sort((g,y)=>g.compareDocumentPosition(y)===4?-1:1),fi.delete(h)})),rr(()=>{})}function Bu(r,n,a){for(var l=new Set,f=0;f<r.length;f+=1)r[f].checked&&l.add(r[f].__value);return a||l.delete(n),Array.from(l)}function di(r){var n=r.type;return n==="number"||n==="range"}function vi(r){return r===""?null:+r}function Da(r,n){return r===n||r?.[dr]===n}function Ii(r={},n,a,l){return ou(()=>{var f,u;return xn(()=>{f=u,u=[],ce(()=>{r!==a(...u)&&(n(r,...u),f&&Da(a(...f),r)&&n(null,...f))})}),()=>{rr(()=>{u&&Da(a(...u),r)&&n(null,...u)})}}),r}function Fi(r){return function(...n){var a=n[0];return a.stopPropagation(),r?.apply(this,n)}}function Bs(r){return function(...n){var a=n[0];return a.preventDefault(),r?.apply(this,n)}}function Kt(r=!1){const n=Ze,a=n.l.u;if(!a)return;let l=()=>We(n.s);if(r){let f=0,u={};const h=So(()=>{let m=!1;const g=n.s;for(const y in g)g[y]!==u[y]&&(u[y]=g[y],m=!0);return m&&f++,f});l=()=>p(h)}a.b.length&&ru(()=>{Ma(n,l),pi(a.b)}),wi(()=>{const f=ce(()=>a.m.map(fl));return()=>{for(const u of f)typeof u=="function"&&u()}}),a.a.length&&wi(()=>{Ma(n,l),pi(a.a)})}function Ma(r,n){if(r.l.s)for(const a of r.l.s)p(a);n()}function Du(r,n){var a=r.$$events?.[n.type],l=ko(a)?a.slice():a==null?[]:[a];for(var f of l)f.call(this,n)}function Ds(r,n,a){if(r==null)return n(void 0),ln;const l=ce(()=>r.subscribe(n,a));return l.unsubscribe?()=>l.unsubscribe():l}const nn=[];function Ms(r,n=ln){let a=null;const l=new Set;function f(m){if(Ya(r,m)&&(r=m,a)){const g=!nn.length;for(const y of l)y[1](),nn.push(y,r);if(g){for(let y=0;y<nn.length;y+=2)nn[y][0](nn[y+1]);nn.length=0}}}function u(m){f(m(r))}function h(m,g=ln){const y=[m,g];return l.add(y),l.size===1&&(a=n(f,u)||ln),m(r),()=>{l.delete(y),l.size===0&&a&&(a(),a=null)}}return{set:f,update:u,subscribe:h}}function Mu(r){let n;return Ds(r,a=>n=a)(),n}let po=!1,Ei=Symbol();function Do(r,n,a){const l=a[n]??={store:null,source:ie(void 0),unsubscribe:ln};if(l.store!==r&&!(Ei in a))if(l.unsubscribe(),l.store=r??null,r==null)l.source.v=void 0,l.unsubscribe=ln;else{var f=!0;l.unsubscribe=Ds(r,u=>{f?l.source.v=u:T(l.source,u)}),f=!1}return r&&Ei in a?Mu(r):p(l.source)}function Mo(){const r={};function n(){Oo(()=>{for(var a in r)r[a].unsubscribe();Na(r,Ei,{enumerable:!1,value:!0})})}return[r,n]}function ju(r){var n=po;try{return po=!1,[r(),po]}finally{po=n}}function Pe(r,n,a,l){var f=!bn||(a&Pl)!==0,u=(a&Dl)!==0,h=(a&Ml)!==0,m=l,g=!0,y=()=>(g&&(g=!1,m=h?ce(l):l),m),B;if(u){var S=dr in r||dl in r;B=sn(r,n)?.set??(S&&n in r?ge=>r[n]=ge:void 0)}var A,F=!1;u?[A,F]=ju(()=>r[n]):A=r[n],A===void 0&&l!==void 0&&(A=y(),B&&(f&&_l(),B(A)));var R;if(f?R=()=>{var ge=r[n];return ge===void 0?y():(g=!0,ge)}:R=()=>{var ge=r[n];return ge!==void 0&&(m=void 0),ge===void 0?m:ge},f&&(a&Bl)===0)return R;if(B){var $=r.$$legacy;return(function(ge,_e){return arguments.length>0?((!f||!_e||$||F)&&B(_e?R():ge),ge):R()})}var re=!1,ue=((a&Ol)!==0?So:vn)(()=>(re=!1,R()));u&&p(ue);var de=$e;return(function(ge,_e){if(arguments.length>0){const X=_e?p(ue):f&&u?an(ge):ge;return T(ue,X),re=!0,m!==void 0&&(m=X),ge}return Br&&re||(de.f&fr)!==0?ue.v:p(ue)})}function jo(r){Ze===null&&Di(),bn&&Ze.l!==null?Tu(Ze).m.push(r):wi(()=>{const n=ce(r);if(typeof n=="function")return n})}function js(r){Ze===null&&Di(),jo(()=>()=>ce(r))}function Ru(r,n,{bubbles:a=!1,cancelable:l=!1}={}){return new CustomEvent(r,{detail:n,bubbles:a,cancelable:l})}function Cn(){const r=Ze;return r===null&&Di(),(n,a,l)=>{const f=r.s.$$events?.[n];if(f){const u=ko(f)?f.slice():[f],h=Ru(n,a,l);for(const m of u)m.call(r.x,h);return!h.defaultPrevented}return!0}}function Tu(r){var n=r.l;return n.u??={a:[],b:[],m:[]}}const Iu="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Iu);Fl();var Fu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ku(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var go={exports:{}},Nu=go.exports,ja;function Lu(){return ja||(ja=1,(function(r,n){((a,l)=>{r.exports=l()})(Nu,function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(o,i){o.__proto__=i}:function(o,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(o[s]=i[s])}))(e,t)},l=function(){return(l=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var s in t=arguments[o])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function f(e,t,o){for(var i,s=0,c=t.length;s<c;s++)!i&&s in t||((i=i||Array.prototype.slice.call(t,0,s))[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}var u=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Fu,h=Object.keys,m=Array.isArray;function g(e,t){return typeof t=="object"&&h(t).forEach(function(o){e[o]=t[o]}),e}typeof Promise>"u"||u.Promise||(u.Promise=Promise);var y=Object.getPrototypeOf,B={}.hasOwnProperty;function S(e,t){return B.call(e,t)}function A(e,t){typeof t=="function"&&(t=t(y(e))),(typeof Reflect>"u"?h:Reflect.ownKeys)(t).forEach(function(o){R(e,o,t[o])})}var F=Object.defineProperty;function R(e,t,o,i){F(e,t,g(o&&S(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},i))}function $(e){return{from:function(t){return e.prototype=Object.create(t.prototype),R(e.prototype,"constructor",e),{extend:A.bind(null,e.prototype)}}}}var re=Object.getOwnPropertyDescriptor,ue=[].slice;function de(e,t,o){return ue.call(e,t,o)}function ge(e,t){return t(e)}function _e(e){if(!e)throw new Error("Assertion Failed")}function X(e){u.setImmediate?setImmediate(e):setTimeout(e,0)}function ae(e,t){if(typeof t=="string"&&S(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var o=[],i=0,s=t.length;i<s;++i){var c=ae(e,t[i]);o.push(c)}return o}var d,v=t.indexOf(".");return v===-1||(d=e[t.substr(0,v)])==null?void 0:ae(d,t.substr(v+1))}function ve(e,t,o){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){_e(typeof o!="string"&&"length"in o);for(var i=0,s=t.length;i<s;++i)ve(e,t[i],o[i])}else{var c,d,v=t.indexOf(".");v!==-1?(c=t.substr(0,v),(v=t.substr(v+1))===""?o===void 0?m(e)&&!isNaN(parseInt(c))?e.splice(c,1):delete e[c]:e[c]=o:ve(d=(d=e[c])&&S(e,c)?d:e[c]={},v,o)):o===void 0?m(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=o}}function le(e){var t,o={};for(t in e)S(e,t)&&(o[t]=e[t]);return o}var Be=[].concat;function Ie(e){return Be.apply([],e)}var q="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ie([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return u[e]}),Fe=new Set(q.map(function(e){return u[e]})),Ue=null;function ee(e){return Ue=new WeakMap,e=(function t(o){if(!o||typeof o!="object")return o;var i=Ue.get(o);if(i)return i;if(m(o)){i=[],Ue.set(o,i);for(var s=0,c=o.length;s<c;++s)i.push(t(o[s]))}else if(Fe.has(o.constructor))i=o;else{var d,v=y(o);for(d in i=v===Object.prototype?{}:Object.create(v),Ue.set(o,i),o)S(o,d)&&(i[d]=t(o[d]))}return i})(e),Ue=null,e}var xe={}.toString;function De(e){return xe.call(e).slice(8,-1)}var Oe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",He=typeof Oe=="symbol"?function(e){var t;return e!=null&&(t=e[Oe])&&t.apply(e)}:function(){return null};function Ve(e,t){t=e.indexOf(t),0<=t&&e.splice(t,1)}var ke={};function Ke(e){var t,o,i,s;if(arguments.length===1){if(m(e))return e.slice();if(this===ke&&typeof e=="string")return[e];if(s=He(e))for(o=[];!(i=s.next()).done;)o.push(i.value);else{if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(o=new Array(t);t--;)o[t]=e[t]}}else for(t=arguments.length,o=new Array(t);t--;)o[t]=arguments[t];return o}var at=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},q=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],rt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(q),se={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ce(e,t){this.name=e,this.message=t}function Qe(e,t){return e+". Errors: "+Object.keys(t).map(function(o){return t[o].toString()}).filter(function(o,i,s){return s.indexOf(o)===i}).join(`
`)}function ct(e,t,o,i){this.failures=t,this.failedKeys=i,this.successCount=o,this.message=Qe(e,t)}function fe(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(o){return t[o]}),this.failuresByPos=t,this.message=Qe(e,this.failures)}$(Ce).from(Error).extend({toString:function(){return this.name+": "+this.message}}),$(ct).from(Ce),$(fe).from(Ce);var Me=rt.reduce(function(e,t){return e[t]=t+"Error",e},{}),ft=Ce,W=rt.reduce(function(e,t){var o=t+"Error";function i(s,c){this.name=o,s?typeof s=="string"?(this.message="".concat(s).concat(c?`
 `+c:""),this.inner=c||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=se[t]||o,this.inner=null)}return $(i).from(ft),e[t]=i,e},{}),Xe=(W.Syntax=SyntaxError,W.Type=TypeError,W.Range=RangeError,q.reduce(function(e,t){return e[t+"Error"]=W[t],e},{}));q=rt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=W[t]),e},{});function pe(){}function st(e){return e}function St(e,t){return e==null||e===st?t:function(o){return t(e(o))}}function vt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function V(e,t){return e===pe?t:function(){var o=e.apply(this,arguments),i=(o!==void 0&&(arguments[0]=o),this.onsuccess),s=this.onerror,c=(this.onsuccess=null,this.onerror=null,t.apply(this,arguments));return i&&(this.onsuccess=this.onsuccess?vt(i,this.onsuccess):i),s&&(this.onerror=this.onerror?vt(s,this.onerror):s),c!==void 0?c:o}}function Z(e,t){return e===pe?t:function(){e.apply(this,arguments);var o=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?vt(o,this.onsuccess):o),i&&(this.onerror=this.onerror?vt(i,this.onerror):i)}}function we(e,t){return e===pe?t:function(s){var i=e.apply(this,arguments),s=(g(s,i),this.onsuccess),c=this.onerror,d=(this.onsuccess=null,this.onerror=null,t.apply(this,arguments));return s&&(this.onsuccess=this.onsuccess?vt(s,this.onsuccess):s),c&&(this.onerror=this.onerror?vt(c,this.onerror):c),i===void 0?d===void 0?void 0:d:g(i,d)}}function be(e,t){return e===pe?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Ne(e,t){return e===pe?t:function(){var o=e.apply(this,arguments);if(o&&typeof o.then=="function"){for(var i=this,s=arguments.length,c=new Array(s);s--;)c[s]=arguments[s];return o.then(function(){return t.apply(i,c)})}return t.apply(this,arguments)}}q.ModifyError=ct,q.DexieError=Ce,q.BulkError=fe;var Le=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function xt(e){Le=e}var kt={},mt=100,Mt=typeof Promise>"u"?[]:(rt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Mt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),y(Mt),rt]:[rt,y(rt),rt]),rt=Mt[0],en=Mt[1],en=en&&en.then,jt=rt&&rt.constructor,En=!!Mt[2],Mr=function(e,t){Yt.push([e,t]),nt&&(queueMicrotask(Ks),nt=!1)},Sn=!0,nt=!0,dt=[],Nt=[],ir=st,Zt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:pe,pgp:!1,env:{},finalize:pe},oe=Zt,Yt=[],Wt=0,pr=[];function G(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=oe;if(typeof e!="function"){if(e!==kt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&To(this,this._value)}else this._state=null,this._value=null,++t.ref,(function o(i,s){try{s(function(c){if(i._state===null){if(c===i)throw new TypeError("A promise cannot be resolved with itself.");var d=i._lib&&Yr();c&&typeof c.then=="function"?o(i,function(v,w){c instanceof G?c._then(v,w):c.then(v,w)}):(i._state=!0,i._value=c,Ni(i)),d&&Wr()}},To.bind(null,i))}catch(c){To(i,c)}})(this,e)}var Ro={get:function(){var e=oe,t=Wn;function o(i,s){var c=this,d=!e.global&&(e!==oe||t!==Wn),v=d&&!gr(),w=new G(function(P,x){Io(c,new Ki(qi(i,e,d,v),qi(s,e,d,v),P,x,e))});return this._consoleTask&&(w._consoleTask=this._consoleTask),w}return o.prototype=kt,o},set:function(e){R(this,"then",e&&e.prototype===kt?Ro:{get:function(){return e},set:Ro.set})}};function Ki(e,t,o,i,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=o,this.reject=i,this.psd=s}function To(e,t){var o,i;Nt.push(t),e._state===null&&(o=e._lib&&Yr(),t=ir(t),e._state=!1,e._value=t,i=e,dt.some(function(s){return s._value===i._value})||dt.push(i),Ni(e),o)&&Wr()}function Ni(e){var t=e._listeners;e._listeners=[];for(var o=0,i=t.length;o<i;++o)Io(e,t[o]);var s=e._PSD;--s.ref||s.finalize(),Wt===0&&(++Wt,Mr(function(){--Wt==0&&Fo()},[]))}function Io(e,t){if(e._state===null)e._listeners.push(t);else{var o=e._state?t.onFulfilled:t.onRejected;if(o===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Wt,Mr(Fs,[o,e,t])}}function Fs(e,t,o){try{var i,s=t._value;!t._state&&Nt.length&&(Nt=[]),i=Le&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),t._state||Nt.indexOf(s)!==-1||(c=>{for(var d=dt.length;d;)if(dt[--d]._value===c._value)return dt.splice(d,1)})(t),o.resolve(i)}catch(c){o.reject(c)}finally{--Wt==0&&Fo(),--o.psd.ref||o.psd.finalize()}}function Ks(){jr(Zt,function(){Yr()&&Wr()})}function Yr(){var e=Sn;return nt=Sn=!1,e}function Wr(){var e,t,o;do for(;0<Yt.length;)for(e=Yt,Yt=[],o=e.length,t=0;t<o;++t){var i=e[t];i[0].apply(null,i[1])}while(0<Yt.length);nt=Sn=!0}function Fo(){for(var e=dt,t=(dt=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)}),pr.slice(0)),o=t.length;o;)t[--o]()}function $n(e){return new G(kt,!1,e)}function et(e,t){var o=oe;return function(){var i=Yr(),s=oe;try{return yr(o,!0),e.apply(this,arguments)}catch(c){t&&t(c)}finally{yr(s,!1),i&&Wr()}}}A(G.prototype,{then:Ro,_then:function(e,t){Io(this,new Ki(null,null,e,t,oe))},catch:function(e){var t,o;return arguments.length===1?this.then(null,e):(t=e,o=arguments[1],typeof t=="function"?this.then(null,function(i){return(i instanceof t?o:$n)(i)}):this.then(null,function(i){return(i&&i.name===t?o:$n)(i)}))},finally:function(e){return this.then(function(t){return G.resolve(e()).then(function(){return t})},function(t){return G.resolve(e()).then(function(){return $n(t)})})},timeout:function(e,t){var o=this;return e<1/0?new G(function(i,s){var c=setTimeout(function(){return s(new W.Timeout(t))},e);o.then(i,s).finally(clearTimeout.bind(null,c))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&R(G.prototype,Symbol.toStringTag,"Dexie.Promise"),Zt.env=Li(),A(G,{all:function(){var e=Ke.apply(null,arguments).map(Gn);return new G(function(t,o){e.length===0&&t([]);var i=e.length;e.forEach(function(s,c){return G.resolve(s).then(function(d){e[c]=d,--i||t(e)},o)})})},resolve:function(e){return e instanceof G?e:e&&typeof e.then=="function"?new G(function(t,o){e.then(t,o)}):new G(kt,!0,e)},reject:$n,race:function(){var e=Ke.apply(null,arguments).map(Gn);return new G(function(t,o){e.map(function(i){return G.resolve(i).then(t,o)})})},PSD:{get:function(){return oe},set:function(e){return oe=e}},totalEchoes:{get:function(){return Wn}},newPSD:mr,usePSD:jr,scheduler:{get:function(){return Mr},set:function(e){Mr=e}},rejectionMapper:{get:function(){return ir},set:function(e){ir=e}},follow:function(e,t){return new G(function(o,i){return mr(function(s,c){var d=oe;d.unhandleds=[],d.onunhandled=c,d.finalize=vt(function(){var v,w=this;v=function(){w.unhandleds.length===0?s():c(w.unhandleds[0])},pr.push(function P(){v(),pr.splice(pr.indexOf(P),1)}),++Wt,Mr(function(){--Wt==0&&Fo()},[])},d.finalize),e()},t,o,i)})}}),jt&&(jt.allSettled&&R(G,"allSettled",function(){var e=Ke.apply(null,arguments).map(Gn);return new G(function(t){e.length===0&&t([]);var o=e.length,i=new Array(o);e.forEach(function(s,c){return G.resolve(s).then(function(d){return i[c]={status:"fulfilled",value:d}},function(d){return i[c]={status:"rejected",reason:d}}).then(function(){return--o||t(i)})})})}),jt.any&&typeof AggregateError<"u"&&R(G,"any",function(){var e=Ke.apply(null,arguments).map(Gn);return new G(function(t,o){e.length===0&&o(new AggregateError([]));var i=e.length,s=new Array(i);e.forEach(function(c,d){return G.resolve(c).then(function(v){return t(v)},function(v){s[d]=v,--i||o(new AggregateError(s))})})})}),jt.withResolvers)&&(G.withResolvers=jt.withResolvers);var gt={awaits:0,echoes:0,id:0},Ns=0,Hn=[],Yn=0,Wn=0,Ls=0;function mr(e,d,o,i){var s=oe,c=Object.create(s),d=(c.parent=s,c.ref=0,c.global=!1,c.id=++Ls,Zt.env,c.env=En?{Promise:G,PromiseProp:{value:G,configurable:!0,writable:!0},all:G.all,race:G.race,allSettled:G.allSettled,any:G.any,resolve:G.resolve,reject:G.reject}:{},d&&g(c,d),++s.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()},jr(c,e,o,i));return c.ref===0&&c.finalize(),d}function Gr(){return gt.id||(gt.id=++Ns),++gt.awaits,gt.echoes+=mt,gt.id}function gr(){return!!gt.awaits&&(--gt.awaits==0&&(gt.id=0),gt.echoes=gt.awaits*mt,!0)}function Gn(e){return gt.echoes&&e&&e.constructor===jt?(Gr(),e.then(function(t){return gr(),t},function(t){return gr(),lt(t)})):e}function qs(){var e=Hn[Hn.length-1];Hn.pop(),yr(e,!1)}function yr(e,t){var o,i,s=oe;(t?!gt.echoes||Yn++&&e===oe:!Yn||--Yn&&e===oe)||queueMicrotask(t?(function(c){++Wn,gt.echoes&&--gt.echoes!=0||(gt.echoes=gt.awaits=gt.id=0),Hn.push(oe),yr(c,!0)}).bind(null,e):qs),e!==oe&&(oe=e,s===Zt&&(Zt.env=Li()),En)&&(o=Zt.env.Promise,i=e.env,s.global||e.global)&&(Object.defineProperty(u,"Promise",i.PromiseProp),o.all=i.all,o.race=i.race,o.resolve=i.resolve,o.reject=i.reject,i.allSettled&&(o.allSettled=i.allSettled),i.any)&&(o.any=i.any)}function Li(){var e=u.Promise;return En?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function jr(e,t,o,i,s){var c=oe;try{return yr(e,!0),t(o,i,s)}finally{yr(c,!1)}}function qi(e,t,o,i){return typeof e!="function"?e:function(){var s=oe;o&&Gr(),yr(t,!0);try{return e.apply(this,arguments)}finally{yr(s,!1),i&&queueMicrotask(gr)}}}function Ko(e){Promise===jt&&gt.echoes===0?Yn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+en).indexOf("[native code]")===-1&&(Gr=gr=pe);var lt=G.reject,Rr="ï¿¿",ar="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zi="String expected.",Xr=[],Xn="__dbnames",No="readonly",Lo="readwrite";function Tr(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ui={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Qn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=ee(t))[e],t}}function Vi(){throw W.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function je(e,t){try{var o=$i(e),i=$i(t);if(o!==i)return o==="Array"?1:i==="Array"?-1:o==="binary"?1:i==="binary"?-1:o==="string"?1:i==="string"?-1:o==="Date"?1:i!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":for(var s=Hi(e),c=Hi(t),d=s.length,v=c.length,w=d<v?d:v,P=0;P<w;++P)if(s[P]!==c[P])return s[P]<c[P]?-1:1;return d===v?0:d<v?-1:1;case"Array":for(var x=e,b=t,C=x.length,E=b.length,k=C<E?C:E,_=0;_<k;++_){var D=je(x[_],b[_]);if(D!==0)return D}return C===E?0:C<E?-1:1}}catch{}return NaN}function $i(e){var t=typeof e;return t=="object"&&(ArrayBuffer.isView(e)||(t=De(e))==="ArrayBuffer")?"binary":t}function Hi(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Jn(e,t,o){var i=e.schema.yProps;return i?(t&&0<o.numFailures&&(t=t.filter(function(s,c){return!o.failures[c]})),Promise.all(i.map(function(s){return s=s.updatesTable,t?e.db.table(s).where("k").anyOf(t).delete():e.db.table(s).clear()})).then(function(){return o})):o}Yi.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var o=t.add;if(m(o))return f(f([],m(e)?e:[],!0),o).sort();if(typeof o=="number")return(Number(e)||0)+o;if(typeof o=="bigint")try{return BigInt(e)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(t.remove!==void 0){var i=t.remove;if(m(i))return m(e)?e.filter(function(s){return!i.includes(s)}).sort():[];if(typeof i=="number")return Number(e)-i;if(typeof i=="bigint")try{return BigInt(e)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}return o=(o=t.replacePrefix)==null?void 0:o[0],o&&typeof e=="string"&&e.startsWith(o)?t.replacePrefix[1]+e.substring(o.length):e};var An=Yi;function Yi(e){this["@@propmod"]=e}function Wi(e,t){for(var o=h(t),i=o.length,s=!1,c=0;c<i;++c){var d=o[c],v=t[d],w=ae(e,d);v instanceof An?(ve(e,d,v.execute(w)),s=!0):w!==v&&(ve(e,d,v),s=!0)}return s}Je.prototype._trans=function(e,t,o){var i=this._tx||oe.trans,s=this.name,c=Le&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function d(P,x,b){if(b.schema[s])return t(b.idbtrans,b);throw new W.NotFound("Table "+s+" not part of transaction")}var v=Yr();try{var w=i&&i.db._novip===this.db._novip?i===oe.trans?i._promise(e,d,o):mr(function(){return i._promise(e,d,o)},{trans:i,transless:oe.transless||oe}):(function P(x,b,C,E){if(x.idbdb&&(x._state.openComplete||oe.letThrough||x._vip)){var k=x._createTransaction(b,C,x._dbSchema);try{k.create(),x._state.PR1398_maxLoop=3}catch(_){return _.name===Me.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return P(x,b,C,E)})):lt(_)}return k._promise(b,function(_,D){return mr(function(){return oe.trans=k,E(_,D,k)})}).then(function(_){if(b==="readwrite")try{k.idbtrans.commit()}catch{}return b==="readonly"?_:k._completion.then(function(){return _})})}if(x._state.openComplete)return lt(new W.DatabaseClosed(x._state.dbOpenError));if(!x._state.isBeingOpened){if(!x._state.autoOpen)return lt(new W.DatabaseClosed);x.open().catch(pe)}return x._state.dbReadyPromise.then(function(){return P(x,b,C,E)})})(this.db,e,[this.name],d);return c&&(w._consoleTask=c,w=w.catch(function(P){return console.trace(P),lt(P)})),w}finally{v&&Wr()}},Je.prototype.get=function(e,t){var o=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?lt(new W.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return o.core.get({trans:i,key:e}).then(function(s){return o.hook.reading.fire(s)})}).then(t)},Je.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(m(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=h(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&t.every(function(P){return 0<=v.keyPath.indexOf(P)})){for(var w=0;w<t.length;++w)if(t.indexOf(v.keyPath[w])===-1)return!1;return!0}return!1}).sort(function(v,w){return v.keyPath.length-w.keyPath.length})[0];if(o&&this.db._maxKey!==Rr)return d=o.keyPath.slice(0,t.length),this.where(d).equals(d.map(function(v){return e[v]}));!o&&Le&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function s(v,w){return je(v,w)===0}var d=t.reduce(function(x,w){var P=x[0],x=x[1],b=i[w],C=e[w];return[P||b,P||!b?Tr(x,b&&b.multi?function(E){return E=ae(E,w),m(E)&&E.some(function(k){return s(C,k)})}:function(E){return s(C,ae(E,w))}):x]},[null,null]),c=d[0],d=d[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(d):o?this.filter(d):this.where(t).equals("")},Je.prototype.filter=function(e){return this.toCollection().and(e)},Je.prototype.count=function(e){return this.toCollection().count(e)},Je.prototype.offset=function(e){return this.toCollection().offset(e)},Je.prototype.limit=function(e){return this.toCollection().limit(e)},Je.prototype.each=function(e){return this.toCollection().each(e)},Je.prototype.toArray=function(e){return this.toCollection().toArray(e)},Je.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Je.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,m(e)?"[".concat(e.join("+"),"]"):e))},Je.prototype.reverse=function(){return this.toCollection().reverse()},Je.prototype.mapToClass=function(e){for(var t=this.db,o=this.name,i=((this.schema.mappedClass=e).prototype instanceof Vi&&(e=(d=>{var v=x,w=d;if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");function P(){this.constructor=v}function x(){return d!==null&&d.apply(this,arguments)||this}return a(v,w),v.prototype=w===null?Object.create(w):(P.prototype=w.prototype,new P),Object.defineProperty(x.prototype,"db",{get:function(){return t},enumerable:!1,configurable:!0}),x.prototype.table=function(){return o},x})(e)),new Set),s=e.prototype;s;s=y(s))Object.getOwnPropertyNames(s).forEach(function(d){return i.add(d)});function c(d){if(!d)return d;var v,w=Object.create(e.prototype);for(v in d)if(!i.has(v))try{w[v]=d[v]}catch{}return w}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=c,this.hook("reading",c),e},Je.prototype.defineClass=function(){return this.mapToClass(function(e){g(this,e)})},Je.prototype.add=function(e,t){var o=this,i=this.schema.primKey,s=i.auto,c=i.keyPath,d=e;return c&&s&&(d=Qn(c)(e)),this._trans("readwrite",function(v){return o.core.mutate({trans:v,type:"add",keys:t!=null?[t]:null,values:[d]})}).then(function(v){return v.numFailures?G.reject(v.failures[0]):v.lastResult}).then(function(v){if(c)try{ve(e,c,v)}catch{}return v})},Je.prototype.upsert=function(e,t){var o=this,i=this.schema.primKey.keyPath;return this._trans("readwrite",function(s){return o.core.get({trans:s,key:e}).then(function(c){var d=c??{};return Wi(d,t),i&&ve(d,i,e),o.core.mutate({trans:s,type:"put",values:[d],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(v){return v.numFailures?G.reject(v.failures[0]):!!c})})})},Je.prototype.update=function(e,t){return typeof e!="object"||m(e)?this.where(":id").equals(e).modify(t):(e=ae(e,this.schema.primKey.keyPath))===void 0?lt(new W.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},Je.prototype.put=function(e,t){var o=this,i=this.schema.primKey,s=i.auto,c=i.keyPath,d=e;return c&&s&&(d=Qn(c)(e)),this._trans("readwrite",function(v){return o.core.mutate({trans:v,type:"put",values:[d],keys:t!=null?[t]:null})}).then(function(v){return v.numFailures?G.reject(v.failures[0]):v.lastResult}).then(function(v){if(c)try{ve(e,c,v)}catch{}return v})},Je.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(o){return t.core.mutate({trans:o,type:"delete",keys:[e]}).then(function(i){return Jn(t,[e],i)}).then(function(i){return i.numFailures?G.reject(i.failures[0]):void 0})})},Je.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ui}).then(function(o){return Jn(e,null,o)})}).then(function(t){return t.numFailures?G.reject(t.failures[0]):void 0})},Je.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(o){return t.core.getMany({keys:e,trans:o}).then(function(i){return i.map(function(s){return t.hook.reading.fire(s)})})})},Je.prototype.bulkAdd=function(e,t,o){var i=this,s=Array.isArray(t)?t:void 0,c=(o=o||(s?void 0:t))?o.allKeys:void 0;return this._trans("readwrite",function(d){var v=i.schema.primKey,P=v.auto,v=v.keyPath;if(v&&s)throw new W.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new W.InvalidArgument("Arguments objects and keys must have the same length");var w=e.length,P=v&&P?e.map(Qn(v)):e;return i.core.mutate({trans:d,type:"add",keys:s,values:P,wantResults:c}).then(function(x){var b=x.numFailures,C=x.failures;if(b===0)return c?x.results:x.lastResult;throw new fe("".concat(i.name,".bulkAdd(): ").concat(b," of ").concat(w," operations failed"),C)})})},Je.prototype.bulkPut=function(e,t,o){var i=this,s=Array.isArray(t)?t:void 0,c=(o=o||(s?void 0:t))?o.allKeys:void 0;return this._trans("readwrite",function(d){var v=i.schema.primKey,P=v.auto,v=v.keyPath;if(v&&s)throw new W.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new W.InvalidArgument("Arguments objects and keys must have the same length");var w=e.length,P=v&&P?e.map(Qn(v)):e;return i.core.mutate({trans:d,type:"put",keys:s,values:P,wantResults:c}).then(function(x){var b=x.numFailures,C=x.failures;if(b===0)return c?x.results:x.lastResult;throw new fe("".concat(i.name,".bulkPut(): ").concat(b," of ").concat(w," operations failed"),C)})})},Je.prototype.bulkUpdate=function(e){var t=this,o=this.core,i=e.map(function(d){return d.key}),s=e.map(function(d){return d.changes}),c=[];return this._trans("readwrite",function(d){return o.getMany({trans:d,keys:i,cache:"clone"}).then(function(v){var w=[],P=[],x=(e.forEach(function(b,C){var E=b.key,k=b.changes,_=v[C];if(_){for(var D=0,j=Object.keys(k);D<j.length;D++){var O=j[D],I=k[O];if(O===t.schema.primKey.keyPath){if(je(I,E)!==0)throw new W.Constraint("Cannot update primary key in bulkUpdate()")}else ve(_,O,I)}c.push(C),w.push(E),P.push(_)}}),w.length);return o.mutate({trans:d,type:"put",keys:w,values:P,updates:{keys:i,changeSpecs:s}}).then(function(b){var C=b.numFailures,E=b.failures;if(C===0)return x;for(var k=0,_=Object.keys(E);k<_.length;k++){var D,j=_[k],O=c[Number(j)];O!=null&&(D=E[j],delete E[j],E[O]=D)}throw new fe("".concat(t.name,".bulkUpdate(): ").concat(C," of ").concat(x," operations failed"),E)})})})},Je.prototype.bulkDelete=function(e){var t=this,o=e.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:e}).then(function(s){return Jn(t,e,s)})}).then(function(i){var s=i.numFailures,c=i.failures;if(s===0)return i.lastResult;throw new fe("".concat(t.name,".bulkDelete(): ").concat(s," of ").concat(o," operations failed"),c)})};var Gi=Je;function Je(){}function On(e){function t(d,v){if(v){for(var w=arguments.length,P=new Array(w-1);--w;)P[w-1]=arguments[w];return o[d].subscribe.apply(null,P),e}if(typeof d=="string")return o[d]}var o={};t.addEventType=c;for(var i=1,s=arguments.length;i<s;++i)c(arguments[i]);return t;function c(d,v,w){var P,x;if(typeof d!="object")return v=v||be,x={subscribers:[],fire:w=w||pe,subscribe:function(b){x.subscribers.indexOf(b)===-1&&(x.subscribers.push(b),x.fire=v(x.fire,b))},unsubscribe:function(b){x.subscribers=x.subscribers.filter(function(C){return C!==b}),x.fire=x.subscribers.reduce(v,w)}},o[d]=t[d]=x;h(P=d).forEach(function(b){var C=P[b];if(m(C))c(b,P[b][0],P[b][1]);else{if(C!=="asap")throw new W.InvalidArgument("Invalid event config");var E=c(b,st,function(){for(var k=arguments.length,_=new Array(k);k--;)_[k]=arguments[k];E.subscribers.forEach(function(D){X(function(){D.apply(null,_)})})})}})}}function Pn(e,t){return $(t).from({prototype:e}),t}function Qr(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function qo(e,t){e.filter=Tr(e.filter,t)}function zo(e,t,o){var i=e.replayFilter;e.replayFilter=i?function(){return Tr(i(),t())}:t,e.justLimit=o&&!i}function Zn(e,t){if(e.isPrimKey)return t.primaryKey;var o=t.getIndexByKeyPath(e.index);if(o)return o;throw new W.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed")}function Xi(e,t,o){var i=Zn(e,t.schema);return t.openCursor({trans:o,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function eo(e,t,o,i){var s,c,d=e.replayFilter?Tr(e.filter,e.replayFilter()):e.filter;return e.or?(s={},c=function(v,w,P){var x,b;d&&!d(w,P,function(C){return w.stop(C)},function(C){return w.fail(C)})||((b=""+(x=w.primaryKey))=="[object ArrayBuffer]"&&(b=""+new Uint8Array(x)),S(s,b))||(s[b]=!0,t(v,w,P))},Promise.all([e.or._iterate(c,o),Qi(Xi(e,i,o),e.algorithm,c,!e.keysOnly&&e.valueMapper)])):Qi(Xi(e,i,o),Tr(e.algorithm,d),t,!e.keysOnly&&e.valueMapper)}function Qi(e,t,o,i){var s=et(i?function(c,d,v){return o(i(c),d,v)}:o);return e.then(function(c){if(c)return c.start(function(){var d=function(){return c.continue()};t&&!t(c,function(v){return d=v},function(v){c.stop(v),d=pe},function(v){c.fail(v),d=pe})||s(c.value,c,function(v){return d=v}),d()})})}qe.prototype._read=function(e,t){var o=this._ctx;return o.error?o.table._trans(null,lt.bind(null,o.error)):o.table._trans("readonly",e).then(t)},qe.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,lt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},qe.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Tr(t.algorithm,e)},qe.prototype._iterate=function(e,t){return eo(this._ctx,e,t,this._ctx.table.core)},qe.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return e&&g(o,e),t._ctx=o,t},qe.prototype.raw=function(){return this._ctx.valueMapper=null,this},qe.prototype.each=function(e){var t=this._ctx;return this._read(function(o){return eo(t,e,o,t.table.core)})},qe.prototype.count=function(e){var t=this;return this._read(function(o){var i,s=t._ctx,c=s.table.core;return Qr(s,!0)?c.count({trans:o,query:{index:Zn(s,c.schema),range:s.range}}).then(function(d){return Math.min(d,s.limit)}):(i=0,eo(s,function(){return++i,!1},o,c).then(function(){return i}))}).then(e)},qe.prototype.sortBy=function(e,t){var o=e.split(".").reverse(),i=o[0],s=o.length-1;function c(w,P){return P?c(w[o[P]],P-1):w[i]}var d=this._ctx.dir==="next"?1:-1;function v(w,P){return je(c(w,s),c(P,s))*d}return this.toArray(function(w){return w.sort(v)}).then(t)},qe.prototype.toArray=function(e){var t=this;return this._read(function(o){var i,s,c,d=t._ctx;return d.dir==="next"&&Qr(d,!0)&&0<d.limit?(i=d.valueMapper,s=Zn(d,d.table.core.schema),d.table.core.query({trans:o,limit:d.limit,values:!0,query:{index:s,range:d.range}}).then(function(v){return v=v.result,i?v.map(i):v})):(c=[],eo(d,function(v){return c.push(v)},o,d.table.core).then(function(){return c}))},e)},qe.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Qr(t)?zo(t,function(){var o=e;return function(i,s){return o===0||(o===1?--o:s(function(){i.advance(o),o=0}),!1)}}):zo(t,function(){var o=e;return function(){return--o<0}})),this},qe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),zo(this._ctx,function(){var t=e;return function(o,i,s){return--t<=0&&i(s),0<=t}},!0),this},qe.prototype.until=function(e,t){return qo(this._ctx,function(o,i,s){return!e(o.value)||(i(s),t)}),this},qe.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},qe.prototype.last=function(e){return this.reverse().first(e)},qe.prototype.filter=function(e){var t;return qo(this._ctx,function(o){return e(o.value)}),(t=this._ctx).isMatch=Tr(t.isMatch,e),this},qe.prototype.and=function(e){return this.filter(e)},qe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},qe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},qe.prototype.desc=function(){return this.reverse()},qe.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(o,i){e(i.key,i)})},qe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},qe.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(o,i){e(i.primaryKey,i)})},qe.prototype.keys=function(e){var t=this._ctx,o=(t.keysOnly=!t.isMatch,[]);return this.each(function(i,s){o.push(s.key)}).then(function(){return o}).then(e)},qe.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Qr(t,!0)&&0<t.limit)return this._read(function(i){var s=Zn(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:s,range:t.range}})}).then(function(i){return i.result}).then(e);t.keysOnly=!t.isMatch;var o=[];return this.each(function(i,s){o.push(s.primaryKey)}).then(function(){return o}).then(e)},qe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},qe.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},qe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},qe.prototype.distinct=function(){var e,t=this._ctx,t=t.index&&t.table.schema.idxByName[t.index];return t&&t.multi&&(e={},qo(this._ctx,function(i){var i=i.primaryKey.toString(),s=S(e,i);return e[i]=!0,!s})),this},qe.prototype.modify=function(e){var t=this,o=this._ctx;return this._write(function(i){function s(_,D){var j=D.failures;C+=_-D.numFailures;for(var O=0,I=h(j);O<I.length;O++){var N=I[O];b.push(j[N])}}var c=typeof e=="function"?e:function(_){return Wi(_,e)},d=o.table.core,x=d.schema.primaryKey,v=x.outbound,w=x.extractKey,P=200,x=t.db._options.modifyChunkSize,b=(x&&(P=typeof x=="object"?x[d.name]||x["*"]||200:x),[]),C=0,E=[],k=e===Ji;return t.clone().primaryKeys().then(function(_){function D(O){var I=Math.min(P,_.length-O),N=_.slice(O,O+I);return(k?Promise.resolve([]):d.getMany({trans:i,keys:N,cache:"immutable"})).then(function(H){var Y=[],L=[],te=v?[]:null,Q=k?N:[];if(!k)for(var U=0;U<I;++U){var ne=H[U],Re={value:ee(ne),primKey:_[O+U]};c.call(Re,Re.value,Re)!==!1&&(Re.value==null?Q.push(_[O+U]):v||je(w(ne),w(Re.value))===0?(L.push(Re.value),v&&te.push(_[O+U])):(Q.push(_[O+U]),Y.push(Re.value)))}return Promise.resolve(0<Y.length&&d.mutate({trans:i,type:"add",values:Y}).then(function(ze){for(var ye in ze.failures)Q.splice(parseInt(ye),1);s(Y.length,ze)})).then(function(){return(0<L.length||j&&typeof e=="object")&&d.mutate({trans:i,type:"put",keys:te,values:L,criteria:j,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<O}).then(function(ze){return s(L.length,ze)})}).then(function(){return(0<Q.length||j&&k)&&d.mutate({trans:i,type:"delete",keys:Q,criteria:j,isAdditionalChunk:0<O}).then(function(ze){return Jn(o.table,Q,ze)}).then(function(ze){return s(Q.length,ze)})}).then(function(){return _.length>O+I&&D(O+P)})})}var j=Qr(o)&&o.limit===1/0&&(typeof e!="function"||k)&&{index:o.index,range:o.range};return D(0).then(function(){if(0<b.length)throw new ct("Error modifying one or more objects",b,C,E);return _.length})})})},qe.prototype.delete=function(){var e=this._ctx,t=e.range;return!Qr(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Ji):this._write(function(o){var i=e.table.core.schema.primaryKey,s=t;return e.table.core.count({trans:o,query:{index:i,range:s}}).then(function(c){return e.table.core.mutate({trans:o,type:"deleteRange",range:s}).then(function(w){var v=w.failures,w=w.numFailures;if(w)throw new ct("Could not delete some values",Object.keys(v).map(function(P){return v[P]}),c-w);return c-w})})})};var zs=qe;function qe(){}var Ji=function(e,t){return t.value=null};function Us(e,t){return e<t?-1:e===t?0:1}function Vs(e,t){return t<e?-1:e===t?0:1}function Rt(e,t,o){return e=e instanceof ea?new e.Collection(e):e,e._ctx.error=new(o||TypeError)(t),e}function Jr(e){return new e.Collection(e,function(){return Zi("")}).limit(0)}function to(E,t,o,i){var s,c,d,v,w,P,x,b=o.length;if(!o.every(function(_){return typeof _=="string"}))return Rt(E,zi);function C(_){s=_==="next"?function(j){return j.toUpperCase()}:function(j){return j.toLowerCase()},c=_==="next"?function(j){return j.toLowerCase()}:function(j){return j.toUpperCase()},d=_==="next"?Us:Vs;var D=o.map(function(j){return{lower:c(j),upper:s(j)}}).sort(function(j,O){return d(j.lower,O.lower)});v=D.map(function(j){return j.upper}),w=D.map(function(j){return j.lower}),x=(P=_)==="next"?"":i}C("next");var E=new E.Collection(E,function(){return br(v[0],w[b-1]+i)}),k=(E._ondirectionchange=function(_){C(_)},0);return E._addAlgorithm(function(_,D,j){var O=_.key;if(typeof O=="string"){var I=c(O);if(t(I,w,k))return!0;for(var N=null,H=k;H<b;++H){var Y=((L,te,Q,U,ne,Re)=>{for(var ze=Math.min(L.length,U.length),ye=-1,Ee=0;Ee<ze;++Ee){var tt=te[Ee];if(tt!==U[Ee])return ne(L[Ee],Q[Ee])<0?L.substr(0,Ee)+Q[Ee]+Q.substr(Ee+1):ne(L[Ee],U[Ee])<0?L.substr(0,Ee)+U[Ee]+Q.substr(Ee+1):0<=ye?L.substr(0,ye)+te[ye]+Q.substr(ye+1):null;ne(L[Ee],tt)<0&&(ye=Ee)}return ze<U.length&&Re==="next"?L+Q.substr(L.length):ze<L.length&&Re==="prev"?L.substr(0,Q.length):ye<0?null:L.substr(0,ye)+U[ye]+Q.substr(ye+1)})(O,I,v[H],w[H],d,P);Y===null&&N===null?k=H+1:(N===null||0<d(N,Y))&&(N=Y)}D(N!==null?function(){_.continue(N+x)}:j)}return!1}),E}function br(e,t,o,i){return{type:2,lower:e,upper:t,lowerOpen:o,upperOpen:i}}function Zi(e){return{type:1,lower:e,upper:e}}Object.defineProperty(yt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),yt.prototype.between=function(e,t,o,i){o=o!==!1,i=i===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(o||i)&&(!o||!i)?Jr(this):new this.Collection(this,function(){return br(e,t,!o,!i)})}catch{return Rt(this,ar)}},yt.prototype.equals=function(e){return e==null?Rt(this,ar):new this.Collection(this,function(){return Zi(e)})},yt.prototype.above=function(e){return e==null?Rt(this,ar):new this.Collection(this,function(){return br(e,void 0,!0)})},yt.prototype.aboveOrEqual=function(e){return e==null?Rt(this,ar):new this.Collection(this,function(){return br(e,void 0,!1)})},yt.prototype.below=function(e){return e==null?Rt(this,ar):new this.Collection(this,function(){return br(void 0,e,!1,!0)})},yt.prototype.belowOrEqual=function(e){return e==null?Rt(this,ar):new this.Collection(this,function(){return br(void 0,e)})},yt.prototype.startsWith=function(e){return typeof e!="string"?Rt(this,zi):this.between(e,e+Rr,!0,!0)},yt.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):to(this,function(t,o){return t.indexOf(o[0])===0},[e],Rr)},yt.prototype.equalsIgnoreCase=function(e){return to(this,function(t,o){return t===o[0]},[e],"")},yt.prototype.anyOfIgnoreCase=function(){var e=Ke.apply(ke,arguments);return e.length===0?Jr(this):to(this,function(t,o){return o.indexOf(t)!==-1},e,"")},yt.prototype.startsWithAnyOfIgnoreCase=function(){var e=Ke.apply(ke,arguments);return e.length===0?Jr(this):to(this,function(t,o){return o.some(function(i){return t.indexOf(i)===0})},e,Rr)},yt.prototype.anyOf=function(){var e,t,o=this,i=Ke.apply(ke,arguments),s=this._cmp;try{i.sort(s)}catch{return Rt(this,ar)}return i.length===0?Jr(this):((e=new this.Collection(this,function(){return br(i[0],i[i.length-1])}))._ondirectionchange=function(c){s=c==="next"?o._ascending:o._descending,i.sort(s)},t=0,e._addAlgorithm(function(c,d,v){for(var w=c.key;0<s(w,i[t]);)if(++t===i.length)return d(v),!1;return s(w,i[t])===0||(d(function(){c.continue(i[t])}),!1)}),e)},yt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},yt.prototype.noneOf=function(){var e=Ke.apply(ke,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Rt(this,ar)}var t=e.reduce(function(o,i){return o?o.concat([[o[o.length-1][1],i]]):[[-1/0,i]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},yt.prototype.inAnyRange=function(e,j){var o=this,i=this._cmp,s=this._ascending,c=this._descending,d=this._min,v=this._max;if(e.length===0)return Jr(this);if(!e.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&s(O[0],O[1])<=0}))return Rt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",W.InvalidArgument);var w=!j||j.includeLowers!==!1,P=j&&j.includeUppers===!0,x,b=s;function C(O,I){return b(O[0],I[0])}try{(x=e.reduce(function(O,I){for(var N=0,H=O.length;N<H;++N){var Y=O[N];if(i(I[0],Y[1])<0&&0<i(I[1],Y[0])){Y[0]=d(Y[0],I[0]),Y[1]=v(Y[1],I[1]);break}}return N===H&&O.push(I),O},[])).sort(C)}catch{return Rt(this,ar)}var E=0,k=P?function(O){return 0<s(O,x[E][1])}:function(O){return 0<=s(O,x[E][1])},_=w?function(O){return 0<c(O,x[E][0])}:function(O){return 0<=c(O,x[E][0])},D=k,j=new this.Collection(this,function(){return br(x[0][0],x[x.length-1][1],!w,!P)});return j._ondirectionchange=function(O){b=O==="next"?(D=k,s):(D=_,c),x.sort(C)},j._addAlgorithm(function(O,I,N){for(var H,Y=O.key;D(Y);)if(++E===x.length)return I(N),!1;return!k(H=Y)&&!_(H)||(o._cmp(Y,x[E][1])===0||o._cmp(Y,x[E][0])===0||I(function(){b===s?O.continue(x[E][0]):O.continue(x[E][1])}),!1)}),j},yt.prototype.startsWithAnyOf=function(){var e=Ke.apply(ke,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Jr(this):this.inAnyRange(e.map(function(t){return[t,t+Rr]})):Rt(this,"startsWithAnyOf() only works with strings")};var ea=yt;function yt(){}function er(e){return et(function(t){return Bn(t),e(t.target.error),!1})}function Bn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Dn="storagemutated",Uo="x-storagemutated-1",_r=On(null,Dn),$s=(tr.prototype._lock=function(){return _e(!oe.global),++this._reculock,this._reculock!==1||oe.global||(oe.lockOwnerFor=this),this},tr.prototype._unlock=function(){if(_e(!oe.global),--this._reculock==0)for(oe.global||(oe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{jr(e[1],e[0])}catch{}}return this},tr.prototype._locked=function(){return this._reculock&&oe.lockOwnerFor!==this},tr.prototype.create=function(e){var t=this;if(this.mode){var o=this.db.idbdb,i=this.db._state.dbOpenError;if(_e(!this.idbtrans),!e&&!o)switch(i&&i.name){case"DatabaseClosedError":throw new W.DatabaseClosed(i);case"MissingAPIError":throw new W.MissingAPI(i.message,i);default:throw new W.OpenFailed(i)}if(!this.active)throw new W.TransactionInactive;_e(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||o).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=et(function(s){Bn(s),t._reject(e.error)}),e.onabort=et(function(s){Bn(s),t.active&&t._reject(new W.Abort(e.error)),t.active=!1,t.on("abort").fire(s)}),e.oncomplete=et(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&_r.storagemutated.fire(e.mutatedParts)})}return this},tr.prototype._promise=function(e,t,o){var i,s=this;return e==="readwrite"&&this.mode!=="readwrite"?lt(new W.ReadOnly("Transaction is readonly")):this.active?this._locked()?new G(function(c,d){s._blockedFuncs.push([function(){s._promise(e,t,o).then(c,d)},oe])}):o?mr(function(){var c=new G(function(d,v){s._lock();var w=t(d,v,s);w&&w.then&&w.then(d,v)});return c.finally(function(){return s._unlock()}),c._lib=!0,c}):((i=new G(function(c,d){var v=t(c,d,s);v&&v.then&&v.then(c,d)}))._lib=!0,i):lt(new W.TransactionInactive)},tr.prototype._root=function(){return this.parent?this.parent._root():this},tr.prototype.waitFor=function(e){var t,o=this._root(),i=G.resolve(e),s=(o._waitingFor?o._waitingFor=o._waitingFor.then(function(){return i}):(o._waitingFor=i,o._waitingQueue=[],t=o.idbtrans.objectStore(o.storeNames[0]),(function c(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(t.get(-1/0).onsuccess=c)})()),o._waitingFor);return new G(function(c,d){i.then(function(v){return o._waitingQueue.push(et(c.bind(null,v)))},function(v){return o._waitingQueue.push(et(d.bind(null,v)))}).finally(function(){o._waitingFor===s&&(o._waitingFor=null)})})},tr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new W.Abort))},tr.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(S(t,e))return t[e];var o=this.schema[e];if(o)return(o=new this.db.Table(e,o,this)).core=this.db.core.table(e),t[e]=o;throw new W.NotFound("Table "+e+" not part of transaction")},tr);function tr(){}function Vo(e,t,o,i,s,c,d,v){return{name:e,keyPath:t,unique:o,multi:i,auto:s,compound:c,src:(o&&!d?"&":"")+(i?"*":"")+(s?"++":"")+ta(t),type:v}}function ta(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function $o(e,t,o){return{name:e,primKey:t,indexes:o,mappedClass:null,idxByName:(i=function(s){return[s.name,s]},o.reduce(function(s,c,d){return c=i(c,d),c&&(s[c[0]]=c[1]),s},{}))};var i}var Mn=function(e){try{return e.only([[]]),Mn=function(){return[[]]},[[]]}catch{return Mn=function(){return Rr},Rr}};function Ho(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(o){return o[t]}:function(o){return ae(o,t)}:function(o){return ae(o,e)};var t}function ra(e){return[].slice.call(e)}var Hs=0;function jn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Ys(e,t,w){function i(k){if(k.type===3)return null;if(k.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=k.lower,C=k.upper,E=k.lowerOpen,k=k.upperOpen;return b===void 0?C===void 0?null:t.upperBound(C,!!k):C===void 0?t.lowerBound(b,!!E):t.bound(b,C,!!E,!!k)}function s(x){var b,C=x.name;return{name:C,schema:x,mutate:function(E){var k=E.trans,_=E.type,D=E.keys,j=E.values,O=E.range;return new Promise(function(I,N){I=et(I);var H=k.objectStore(C),Y=H.keyPath==null,L=_==="put"||_==="add";if(!L&&_!=="delete"&&_!=="deleteRange")throw new Error("Invalid operation type: "+_);var te,Q=(D||j||{length:1}).length;if(D&&j&&D.length!==j.length)throw new Error("Given keys array must have same length as given values array.");if(Q===0)return I({numFailures:0,failures:{},results:[],lastResult:void 0});function U(ot){++ze,Bn(ot)}var ne=[],Re=[],ze=0;if(_==="deleteRange"){if(O.type===4)return I({numFailures:ze,failures:Re,results:[],lastResult:void 0});O.type===3?ne.push(te=H.clear()):ne.push(te=H.delete(i(O)))}else{var Y=L?Y?[j,D]:[j,null]:[D,null],ye=Y[0],Ee=Y[1];if(L)for(var tt=0;tt<Q;++tt)ne.push(te=Ee&&Ee[tt]!==void 0?H[_](ye[tt],Ee[tt]):H[_](ye[tt])),te.onerror=U;else for(tt=0;tt<Q;++tt)ne.push(te=H[_](ye[tt])),te.onerror=U}function Lt(ot){ot=ot.target.result,ne.forEach(function(Kr,ci){return Kr.error!=null&&(Re[ci]=Kr.error)}),I({numFailures:ze,failures:Re,results:_==="delete"?D:ne.map(function(Kr){return Kr.result}),lastResult:ot})}te.onerror=function(ot){U(ot),Lt(ot)},te.onsuccess=Lt})},getMany:function(E){var k=E.trans,_=E.keys;return new Promise(function(D,j){D=et(D);for(var O,I=k.objectStore(C),N=_.length,H=new Array(N),Y=0,L=0,te=function(ne){ne=ne.target,H[ne._pos]=ne.result,++L===Y&&D(H)},Q=er(j),U=0;U<N;++U)_[U]!=null&&((O=I.get(_[U]))._pos=U,O.onsuccess=te,O.onerror=Q,++Y);Y===0&&D(H)})},get:function(E){var k=E.trans,_=E.key;return new Promise(function(D,j){D=et(D);var O=k.objectStore(C).get(_);O.onsuccess=function(I){return D(I.target.result)},O.onerror=er(j)})},query:(b=v,function(E){return new Promise(function(k,_){k=et(k);var D,j,O,L=E.trans,I=E.values,N=E.limit,Y=E.query,H=N===1/0?void 0:N,te=Y.index,Y=Y.range,L=L.objectStore(C),L=te.isPrimaryKey?L:L.index(te.name),te=i(Y);if(N===0)return k({result:[]});b?((Y=I?L.getAll(te,H):L.getAllKeys(te,H)).onsuccess=function(Q){return k({result:Q.target.result})},Y.onerror=er(_)):(D=0,j=!I&&"openKeyCursor"in L?L.openKeyCursor(te):L.openCursor(te),O=[],j.onsuccess=function(Q){var U=j.result;return!U||(O.push(I?U.value:U.primaryKey),++D===N)?k({result:O}):void U.continue()},j.onerror=er(_))})}),openCursor:function(E){var k=E.trans,_=E.values,D=E.query,j=E.reverse,O=E.unique;return new Promise(function(I,N){I=et(I);var L=D.index,H=D.range,Y=k.objectStore(C),Y=L.isPrimaryKey?Y:Y.index(L.name),L=j?O?"prevunique":"prev":O?"nextunique":"next",te=!_&&"openKeyCursor"in Y?Y.openKeyCursor(i(H),L):Y.openCursor(i(H),L);te.onerror=er(N),te.onsuccess=et(function(Q){var U,ne,Re,ze,ye=te.result;ye?(ye.___id=++Hs,ye.done=!1,U=ye.continue.bind(ye),ne=(ne=ye.continuePrimaryKey)&&ne.bind(ye),Re=ye.advance.bind(ye),ze=function(){throw new Error("Cursor not stopped")},ye.trans=k,ye.stop=ye.continue=ye.continuePrimaryKey=ye.advance=function(){throw new Error("Cursor not started")},ye.fail=et(N),ye.next=function(){var Ee=this,tt=1;return this.start(function(){return tt--?Ee.continue():Ee.stop()}).then(function(){return Ee})},ye.start=function(Ee){function tt(){if(te.result)try{Ee()}catch(ot){ye.fail(ot)}else ye.done=!0,ye.start=function(){throw new Error("Cursor behind last entry")},ye.stop()}var Lt=new Promise(function(ot,Kr){ot=et(ot),te.onerror=er(Kr),ye.fail=Kr,ye.stop=function(ci){ye.stop=ye.continue=ye.continuePrimaryKey=ye.advance=ze,ot(ci)}});return te.onsuccess=et(function(ot){te.onsuccess=tt,tt()}),ye.continue=U,ye.continuePrimaryKey=ne,ye.advance=Re,tt(),Lt},I(ye)):I(null)},N)})},count:function(E){var k=E.query,_=E.trans,D=k.index,j=k.range;return new Promise(function(O,I){var N=_.objectStore(C),N=D.isPrimaryKey?N:N.index(D.name),H=i(j),H=H?N.count(H):N.count();H.onsuccess=et(function(Y){return O(Y.target.result)}),H.onerror=er(I)})}}}c=w,d=ra((w=e).objectStoreNames);var c,w={schema:{name:w.name,tables:d.map(function(x){return c.objectStore(x)}).map(function(x){var b=x.keyPath,C=x.autoIncrement,k=m(b),E={},k={name:x.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:k,keyPath:b,autoIncrement:C,unique:!0,extractKey:Ho(b)},indexes:ra(x.indexNames).map(function(_){return x.index(_)}).map(function(O){var I=O.name,D=O.unique,j=O.multiEntry,O=O.keyPath,I={name:I,compound:m(O),keyPath:O,unique:D,multiEntry:j,extractKey:Ho(O)};return E[jn(O)]=I}),getIndexByKeyPath:function(_){return E[jn(_)]}};return E[":id"]=k.primaryKey,b!=null&&(E[jn(b)]=k.primaryKey),k})},hasGetAll:0<d.length&&"getAll"in c.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},d=w.schema,v=w.hasGetAll,w=d.tables.map(s),P={};return w.forEach(function(x){return P[x.name]=x}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(x){if(P[x])return P[x];throw new Error("Table '".concat(x,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Mn(t),schema:d}}function Ws(e,t,o,i){return o=o.IDBKeyRange,t=Ys(t,o,i),{dbcore:e.dbcore.reduce(function(s,c){return c=c.create,l(l({},s),c(s))},t)}}function ro(e,t){var o=t.db,o=Ws(e._middlewares,o,e._deps,t);e.core=o.dbcore,e.tables.forEach(function(i){var s=i.name;e.core.schema.tables.some(function(c){return c.name===s})&&(i.core=e.core.table(s),e[s]instanceof e.Table)&&(e[s].core=i.core)})}function no(e,t,o,i){o.forEach(function(s){var c=i[s];t.forEach(function(d){var v=(function w(P,x){return re(P,x)||(P=y(P))&&w(P,x)})(d,s);(!v||"value"in v&&v.value===void 0)&&(d===e.Transaction.prototype||d instanceof e.Transaction?R(d,s,{get:function(){return this.table(s)},set:function(w){F(this,s,{value:w,writable:!0,configurable:!0,enumerable:!0})}}):d[s]=new e.Table(s,c))})})}function Yo(e,t){t.forEach(function(o){for(var i in o)o[i]instanceof e.Table&&delete o[i]})}function Gs(e,t){return e._cfg.version-t._cfg.version}function Xs(e,t,o,i){var s=e._dbSchema,c=(o.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=$o("$meta",oa("")[0],[]),e._storeNames.push("$meta")),e._createTransaction("readwrite",e._storeNames,s)),d=(c.create(o),c._completion.catch(i),c._reject.bind(c)),v=oe.transless||oe;mr(function(){if(oe.trans=c,oe.transless=v,t!==0)return ro(e,o),P=t,((w=c).storeNames.includes("$meta")?w.table("$meta").get("version").then(function(x){return x??P}):G.resolve(P)).then(function(D){var b=e,C=D,E=c,k=o,_=[],D=b._versions,j=b._dbSchema=io(0,b.idbdb,k);return(D=D.filter(function(O){return O._cfg.version>=C})).length===0?G.resolve():(D.forEach(function(O){_.push(function(){var I,N,H,Y=j,L=O._cfg.dbschema,te=(ao(b,Y,k),ao(b,L,k),j=b._dbSchema=L,Wo(Y,L)),Q=(te.add.forEach(function(U){Go(k,U[0],U[1].primKey,U[1].indexes)}),te.change.forEach(function(U){if(U.recreate)throw new W.Upgrade("Not yet support for changing primary key");var ne=k.objectStore(U.name);U.add.forEach(function(Re){return oo(ne,Re)}),U.change.forEach(function(Re){ne.deleteIndex(Re.name),oo(ne,Re)}),U.del.forEach(function(Re){return ne.deleteIndex(Re)})}),O._cfg.contentUpgrade);if(Q&&O._cfg.version>C)return ro(b,k),E._memoizedTables={},I=le(L),te.del.forEach(function(U){I[U]=Y[U]}),Yo(b,[b.Transaction.prototype]),no(b,[b.Transaction.prototype],h(I),I),E.schema=I,(N=at(Q))&&Gr(),L=G.follow(function(){var U;(H=Q(E))&&N&&(U=gr.bind(null,null),H.then(U,U))}),H&&typeof H.then=="function"?G.resolve(H):L.then(function(){return H})}),_.push(function(I){var N,H,Y=O._cfg.dbschema;N=Y,H=I,[].slice.call(H.db.objectStoreNames).forEach(function(L){return N[L]==null&&H.db.deleteObjectStore(L)}),Yo(b,[b.Transaction.prototype]),no(b,[b.Transaction.prototype],b._storeNames,b._dbSchema),E.schema=b._dbSchema}),_.push(function(I){b.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(b.idbdb.version/10)===O._cfg.version?(b.idbdb.deleteObjectStore("$meta"),delete b._dbSchema.$meta,b._storeNames=b._storeNames.filter(function(N){return N!=="$meta"})):I.objectStore("$meta").put(O._cfg.version,"version"))})}),(function O(){return _.length?G.resolve(_.shift()(E.idbtrans)).then(O):G.resolve()})().then(function(){na(j,k)}))}).catch(d);var w,P;h(s).forEach(function(x){Go(o,x,s[x].primKey,s[x].indexes)}),ro(e,o),G.follow(function(){return e.on.populate.fire(c)}).catch(d)})}function Qs(e,t){na(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var o=io(0,e.idbdb,t);ao(e,e._dbSchema,t);for(var i=0,s=Wo(o,e._dbSchema).change;i<s.length;i++){var c=(d=>{if(d.change.length||d.recreate)return console.warn("Unable to patch indexes of table ".concat(d.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=t.objectStore(d.name);d.add.forEach(function(w){Le&&console.debug("Dexie upgrade patch: Creating missing index ".concat(d.name,".").concat(w.src)),oo(v,w)})})(s[i]);if(typeof c=="object")return c.value}}function Wo(e,t){var o,i={del:[],add:[],change:[]};for(o in e)t[o]||i.del.push(o);for(o in t){var s=e[o],c=t[o];if(s){var d={name:o,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||s.primKey.auto!==c.primKey.auto)d.recreate=!0,i.change.push(d);else{var v=s.idxByName,w=c.idxByName,P=void 0;for(P in v)w[P]||d.del.push(P);for(P in w){var x=v[P],b=w[P];x?x.src!==b.src&&d.change.push(b):d.add.push(b)}(0<d.del.length||0<d.add.length||0<d.change.length)&&i.change.push(d)}}else i.add.push([o,c])}return i}function Go(e,t,o,i){var s=e.db.createObjectStore(t,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});i.forEach(function(c){return oo(s,c)})}function na(e,t){h(e).forEach(function(o){t.db.objectStoreNames.contains(o)||(Le&&console.debug("Dexie: Creating missing table",o),Go(t,o,e[o].primKey,e[o].indexes))})}function oo(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function io(e,t,o){var i={};return de(t.objectStoreNames,0).forEach(function(s){for(var c=o.objectStore(s),d=Vo(ta(P=c.keyPath),P||"",!0,!1,!!c.autoIncrement,P&&typeof P!="string",!0),v=[],w=0;w<c.indexNames.length;++w){var x=c.index(c.indexNames[w]),P=x.keyPath,x=Vo(x.name,P,!!x.unique,!!x.multiEntry,!1,P&&typeof P!="string",!1);v.push(x)}i[s]=$o(s,d,v)}),i}function ao(e,t,o){for(var i=o.db.objectStoreNames,s=0;s<i.length;++s){var c=i[s],d=o.objectStore(c);e._hasGetAll="getAll"in d;for(var v=0;v<d.indexNames.length;++v){var w,P=d.indexNames[v],x=d.index(P).keyPath,x=typeof x=="string"?x:"["+de(x).join("+")+"]";t[c]&&(w=t[c].idxByName[x])&&(w.name=P,delete t[c].idxByName[x],t[c].idxByName[P]=w)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function oa(e){return e.split(",").map(function(t,o){var s=t.split(":"),i=(i=s[1])==null?void 0:i.trim(),s=(t=s[0].trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return Vo(s,c||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),m(c),o===0,i)})}Zr.prototype._createTableSchema=$o,Zr.prototype._parseIndexSyntax=oa,Zr.prototype._parseStoresSpec=function(e,t){var o=this;h(e).forEach(function(i){if(e[i]!==null){var s=o._parseIndexSyntax(e[i]),c=s.shift();if(!c)throw new W.Schema("Invalid schema for table "+i+": "+e[i]);if(c.unique=!0,c.multi)throw new W.Schema("Primary key cannot be multiEntry*");s.forEach(function(d){if(d.auto)throw new W.Schema("Only primary key can be marked as autoIncrement (++)");if(!d.keyPath)throw new W.Schema("Index must have a name and cannot be an empty string")}),c=o._createTableSchema(i,c,s),t[i]=c}})},Zr.prototype.stores=function(o){var t=this.db,o=(this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,o):o,t._versions),i={},s={};return o.forEach(function(c){g(i,c._cfg.storesSource),s=c._cfg.dbschema={},c._parseStoresSpec(i,s)}),t._dbSchema=s,Yo(t,[t._allTables,t,t.Transaction.prototype]),no(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],h(s),s),t._storeNames=h(s),this},Zr.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Ne(this._cfg.contentUpgrade||pe,e),this};var Js=Zr;function Zr(){}function Xo(e,t){var o=e._dbNamesDB;return o||(o=e._dbNamesDB=new sr(Xn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),o.table("dbnames")}function Qo(e){return e&&typeof e.databases=="function"}function Jo(e){return mr(function(){return oe.letThrough=!0,e()})}function Zo(e){return!("from"in e)}var Ct=function(e,t){var o;if(!this)return o=new Ct,e&&"d"in e&&g(o,e),o;g(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Rn(e,t,o){var i=je(t,o);if(!isNaN(i)){if(0<i)throw RangeError();if(Zo(e))return g(e,{from:t,to:o,d:1});var i=e.l,s=e.r;if(je(o,e.from)<0)return i?Rn(i,t,o):e.l={from:t,to:o,d:1,l:null,r:null},aa(e);if(0<je(t,e.to))return s?Rn(s,t,o):e.r={from:t,to:o,d:1,l:null,r:null},aa(e);je(t,e.from)<0&&(e.from=t,e.l=null,e.d=s?s.d+1:1),0<je(o,e.to)&&(e.to=o,e.r=null,e.d=e.l?e.l.d+1:1),t=!e.r,i&&!e.l&&Tn(e,i),s&&t&&Tn(e,s)}}function Tn(e,t){Zo(t)||(function o(i,s){var c=s.from,d=s.l,v=s.r;Rn(i,c,s.to),d&&o(i,d),v&&o(i,v)})(e,t)}function ia(e,t){var o=so(t),i=o.next();if(!i.done)for(var s=i.value,c=so(e),d=c.next(s.from),v=d.value;!i.done&&!d.done;){if(je(v.from,s.to)<=0&&0<=je(v.to,s.from))return!0;je(s.from,v.from)<0?s=(i=o.next(v.from)).value:v=(d=c.next(s.from)).value}return!1}function so(e){var t=Zo(e)?null:{s:0,n:e};return{next:function(o){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&je(o,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||je(o,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function aa(e){var t,o,i,s=(((s=e.r)==null?void 0:s.d)||0)-(((s=e.l)==null?void 0:s.d)||0),s=1<s?"r":s<-1?"l":"";s&&(t=s=="r"?"l":"r",o=l({},e),i=e[s],e.from=i.from,e.to=i.to,e[s]=i[s],o[s]=i[t],(e[t]=o).d=sa(o)),e.d=sa(e)}function sa(o){var t=o.r,o=o.l;return(t?o?Math.max(t.d,o.d):t.d:o?o.d:0)+1}function lo(e,t){return h(t).forEach(function(o){e[o]?Tn(e[o],t[o]):e[o]=(function i(s){var c,d,v={};for(c in s)S(s,c)&&(d=s[c],v[c]=!d||typeof d!="object"||Fe.has(d.constructor)?d:i(d));return v})(t[o])}),e}function ei(e,t){return e.all||t.all||Object.keys(e).some(function(o){return t[o]&&ia(t[o],e[o])})}A(Ct.prototype,((rt={add:function(e){return Tn(this,e),this},addKey:function(e){return Rn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(o){return Rn(t,o,o)}),this},hasKey:function(e){var t=so(this).next(e).value;return t&&je(t.from,e)<=0&&0<=je(t.to,e)}})[Oe]=function(){return so(this)},rt));var Ir={},ti={},ri=!1;function uo(e){lo(ti,e),ri||(ri=!0,setTimeout(function(){ri=!1,ni(ti,!(ti={}))},0))}function ni(e,t){t===void 0&&(t=!1);var o=new Set;if(e.all)for(var i=0,s=Object.values(Ir);i<s.length;i++)la(v=s[i],e,o,t);else for(var c in e){var d,v,c=/^idb\:\/\/(.*)\/(.*)\//.exec(c);c&&(d=c[1],c=c[2],v=Ir["idb://".concat(d,"/").concat(c)])&&la(v,e,o,t)}o.forEach(function(w){return w()})}function la(e,t,o,i){for(var s=[],c=0,d=Object.entries(e.queries.query);c<d.length;c++){for(var v=d[c],w=v[0],P=[],x=0,b=v[1];x<b.length;x++){var C=b[x];ei(t,C.obsSet)?C.subscribers.forEach(function(D){return o.add(D)}):i&&P.push(C)}i&&s.push([w,P])}if(i)for(var E=0,k=s;E<k.length;E++){var _=k[E],w=_[0],P=_[1];e.queries.query[w]=P}}function Zs(e){var t=e._state,o=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?lt(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,s=Math.round(10*e.verno),c=!1;function d(){if(t.openCanceller!==i)throw new W.DatabaseClosed("db.open() was cancelled")}function v(){return new G(function(C,E){if(d(),!o)throw new W.MissingAPI;var k=e.name,_=t.autoSchema||!s?o.open(k):o.open(k,s);if(!_)throw new W.MissingAPI;_.onerror=er(E),_.onblocked=et(e._fireOnBlocked),_.onupgradeneeded=et(function(D){var j;x=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=Bn,x.abort(),_.result.close(),(j=o.deleteDatabase(k)).onsuccess=j.onerror=et(function(){E(new W.NoSuchDatabase("Database ".concat(k," doesnt exist")))})):(x.onerror=er(E),j=D.oldVersion>Math.pow(2,62)?0:D.oldVersion,b=j<1,e.idbdb=_.result,c&&Qs(e,x),Xs(e,j/10,x,E))},E),_.onsuccess=et(function(){x=null;var D,j,O,I,N,H,Y=e.idbdb=_.result,L=de(Y.objectStoreNames);if(0<L.length)try{var te=Y.transaction((N=L).length===1?N[0]:N,"readonly");if(t.autoSchema)H=Y,I=te,(O=e).verno=H.version/10,I=O._dbSchema=io(0,H,I),O._storeNames=de(H.objectStoreNames,0),no(O,[O._allTables],h(I),I);else if(ao(e,e._dbSchema,te),j=te,((j=Wo(io(0,(D=e).idbdb,j),D._dbSchema)).add.length||j.change.some(function(Q){return Q.add.length||Q.change.length}))&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Y.close(),s=Y.version+1,c=!0,C(v());ro(e,te)}catch{}Xr.push(e),Y.onversionchange=et(function(Q){t.vcFired=!0,e.on("versionchange").fire(Q)}),Y.onclose=et(function(){e.close({disableAutoOpen:!1})}),b&&(L=e._deps,N=k,Qo(H=L.indexedDB)||N===Xn||Xo(H,L.IDBKeyRange).put({name:N}).catch(pe)),C()},E)}).catch(function(C){switch(C?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<s)return s=0,v()}return G.reject(C)})}var w,P=t.dbReadyResolve,x=null,b=!1;return G.race([i,(typeof navigator>"u"?G.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(C){function E(){return indexedDB.databases().finally(C)}w=setInterval(E,100),E()}).finally(function(){return clearInterval(w)}):Promise.resolve()).then(v)]).then(function(){return d(),t.onReadyBeingFired=[],G.resolve(Jo(function(){return e.on.ready.fire(e.vip)})).then(function C(){var E;if(0<t.onReadyBeingFired.length)return E=t.onReadyBeingFired.reduce(Ne,pe),t.onReadyBeingFired=[],G.resolve(Jo(function(){return E(e.vip)})).then(C)})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(C){t.dbOpenError=C;try{x&&x.abort()}catch{}return i===t.openCanceller&&e._close(),lt(C)}).finally(function(){t.openComplete=!0,P()}).then(function(){var C;return b&&(C={},e.tables.forEach(function(E){E.schema.indexes.forEach(function(k){k.name&&(C["idb://".concat(e.name,"/").concat(E.name,"/").concat(k.name)]=new Ct(-1/0,[[[]]]))}),C["idb://".concat(e.name,"/").concat(E.name,"/")]=C["idb://".concat(e.name,"/").concat(E.name,"/:dels")]=new Ct(-1/0,[[[]]])}),_r(Dn).fire(C),ni(C,!0)),e})}function oi(e){function t(c){return e.next(c)}var o=s(t),i=s(function(c){return e.throw(c)});function s(c){return function(v){var v=c(v),w=v.value;return v.done?w:w&&typeof w.then=="function"?w.then(o,i):m(w)?Promise.all(w).then(o,i):o(w)}}return s(t)()}function co(e,t,o){for(var i=m(e)?e.slice():[e],s=0;s<o;++s)i.push(t);return i}var el={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return l(l({},e),{table:function(i){var o=e.table(i),i=o.schema,s={},c=[];function d(C,E,k){var O=jn(C),_=s[O]=s[O]||[],D=C==null?0:typeof C=="string"?1:C.length,j=0<E,O=l(l({},k),{name:j?"".concat(O,"(virtual-from:").concat(k.name,")"):k.name,lowLevelIndex:k,isVirtual:j,keyTail:E,keyLength:D,extractKey:Ho(C),unique:!j&&k.unique});return _.push(O),O.isPrimaryKey||c.push(O),1<D&&d(D===2?C[0]:C.slice(0,D-1),E+1,k),_.sort(function(I,N){return I.keyTail-N.keyTail}),O}var v=d(i.primaryKey.keyPath,0,i.primaryKey);s[":id"]=[v];for(var w=0,P=i.indexes;w<P.length;w++){var x=P[w];d(x.keyPath,0,x)}function b(C){var E,k=C.query.index;return k.isVirtual?l(l({},C),{query:{index:k.lowLevelIndex,range:(E=C.query.range,k=k.keyTail,{type:E.type===1?2:E.type,lower:co(E.lower,E.lowerOpen?e.MAX_KEY:e.MIN_KEY,k),lowerOpen:!0,upper:co(E.upper,E.upperOpen?e.MIN_KEY:e.MAX_KEY,k),upperOpen:!0})}}):C}return l(l({},o),{schema:l(l({},i),{primaryKey:v,indexes:c,getIndexByKeyPath:function(C){return(C=s[jn(C)])&&C[0]}}),count:function(C){return o.count(b(C))},query:function(C){return o.query(b(C))},openCursor:function(C){var E=C.query.index,k=E.keyTail,_=E.keyLength;return E.isVirtual?o.openCursor(b(C)).then(function(j){return j&&D(j)}):o.openCursor(C);function D(j){return Object.create(j,{continue:{value:function(O){O!=null?j.continue(co(O,C.reverse?e.MAX_KEY:e.MIN_KEY,k)):C.unique?j.continue(j.key.slice(0,_).concat(C.reverse?e.MIN_KEY:e.MAX_KEY,k)):j.continue()}},continuePrimaryKey:{value:function(O,I){j.continuePrimaryKey(co(O,e.MAX_KEY,k),I)}},primaryKey:{get:function(){return j.primaryKey}},key:{get:function(){var O=j.key;return _===1?O[0]:O.slice(0,_)}},value:{get:function(){return j.value}}})}}})}})}};function ii(e,t,o,i){return o=o||{},i=i||"",h(e).forEach(function(s){var c,d,v;S(t,s)?(c=e[s],d=t[s],typeof c=="object"&&typeof d=="object"&&c&&d?(v=De(c))!==De(d)?o[i+s]=t[s]:v==="Object"?ii(c,d,o,i+s+"."):c!==d&&(o[i+s]=t[s]):c!==d&&(o[i+s]=t[s])):o[i+s]=void 0}),h(t).forEach(function(s){S(e,s)||(o[i+s]=t[s])}),o}function ai(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var tl={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return l(l({},e),{table:function(t){var o=e.table(t),i=o.schema.primaryKey;return l(l({},o),{mutate:function(s){var c=oe.trans,d=c.table(t).hook,v=d.deleting,w=d.creating,P=d.updating;switch(s.type){case"add":if(w.fire===pe)break;return c._promise("readwrite",function(){return x(s)},!0);case"put":if(w.fire===pe&&P.fire===pe)break;return c._promise("readwrite",function(){return x(s)},!0);case"delete":if(v.fire===pe)break;return c._promise("readwrite",function(){return x(s)},!0);case"deleteRange":if(v.fire===pe)break;return c._promise("readwrite",function(){return(function b(C,E,k){return o.query({trans:C,values:!1,query:{index:i,range:E},limit:k}).then(function(_){var D=_.result;return x({type:"delete",keys:D,trans:C}).then(function(j){return 0<j.numFailures?Promise.reject(j.failures[0]):D.length<k?{failures:[],numFailures:0,lastResult:void 0}:b(C,l(l({},E),{lower:D[D.length-1],lowerOpen:!0}),k)})})})(s.trans,s.range,1e4)},!0)}return o.mutate(s);function x(b){var C,E,k,_=oe.trans,D=b.keys||ai(i,b);if(D)return(b=b.type==="add"||b.type==="put"?l(l({},b),{keys:D}):l({},b)).type!=="delete"&&(b.values=f([],b.values)),b.keys&&(b.keys=f([],b.keys)),C=o,k=D,((E=b).type==="add"?Promise.resolve([]):C.getMany({trans:E.trans,keys:k,cache:"immutable"})).then(function(j){var O=D.map(function(I,N){var H,Y,L,te=j[N],Q={onerror:null,onsuccess:null};return b.type==="delete"?v.fire.call(Q,I,te,_):b.type==="add"||te===void 0?(H=w.fire.call(Q,I,b.values[N],_),I==null&&H!=null&&(b.keys[N]=I=H,i.outbound||ve(b.values[N],i.keyPath,I))):(H=ii(te,b.values[N]),(Y=P.fire.call(Q,H,I,te,_))&&(L=b.values[N],Object.keys(Y).forEach(function(U){S(L,U)?L[U]=Y[U]:ve(L,U,Y[U])}))),Q});return o.mutate(b).then(function(I){for(var N=I.failures,H=I.results,Y=I.numFailures,I=I.lastResult,L=0;L<D.length;++L){var te=(H||D)[L],Q=O[L];te==null?Q.onerror&&Q.onerror(N[L]):Q.onsuccess&&Q.onsuccess(b.type==="put"&&j[L]?b.values[L]:te)}return{failures:N,results:H,numFailures:Y,lastResult:I}}).catch(function(I){return O.forEach(function(N){return N.onerror&&N.onerror(I)}),Promise.reject(I)})});throw new Error("Keys missing")}}})}})}};function ua(e,t,o){try{if(!t||t.keys.length<e.length)return null;for(var i=[],s=0,c=0;s<t.keys.length&&c<e.length;++s)je(t.keys[s],e[c])===0&&(i.push(o?ee(t.values[s]):t.values[s]),++c);return i.length===e.length?i:null}catch{return null}}var rl={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var o=e.table(t);return l(l({},o),{getMany:function(i){var s;return i.cache?(s=ua(i.keys,i.trans._cache,i.cache==="clone"))?G.resolve(s):o.getMany(i).then(function(c){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?ee(c):c},c}):o.getMany(i)},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),o.mutate(i)}})}}}};function ca(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function fa(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var nl={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,o=new Ct(e.MIN_KEY,e.MAX_KEY);return l(l({},e),{transaction:function(i,s,c){if(oe.subscr&&s!=="readonly")throw new W.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(oe.querier));return e.transaction(i,s,c)},table:function(i){function s(D){var _,D=D.query;return[_=D.index,new Ct((_=(D=D.range).lower)!=null?_:e.MIN_KEY,(_=D.upper)!=null?_:e.MAX_KEY)]}var c=e.table(i),d=c.schema,v=d.primaryKey,w=d.indexes,P=v.extractKey,x=v.outbound,b=v.autoIncrement&&w.filter(function(k){return k.compound&&k.keyPath.includes(v.keyPath)}),C=l(l({},c),{mutate:function(k){function _(ne){return ne="idb://".concat(t,"/").concat(i,"/").concat(ne),N[ne]||(N[ne]=new Ct)}var D,j,O,I=k.trans,N=k.mutatedParts||(k.mutatedParts={}),H=_(""),Y=_(":dels"),L=k.type,Q=k.type==="deleteRange"?[k.range]:k.type==="delete"?[k.keys]:k.values.length<50?[ai(v,k).filter(function(ne){return ne}),k.values]:[],te=Q[0],Q=Q[1],U=k.trans._cache;return m(te)?(H.addKeys(te),(L=L==="delete"||te.length===Q.length?ua(te,U):null)||Y.addKeys(te),(L||Q)&&(D=_,j=L,O=Q,d.indexes.forEach(function(ne){var Re=D(ne.name||"");function ze(Ee){return Ee!=null?ne.extractKey(Ee):null}function ye(Ee){ne.multiEntry&&m(Ee)?Ee.forEach(function(tt){return Re.addKey(tt)}):Re.addKey(Ee)}(j||O).forEach(function(Ee,ot){var Lt=j&&ze(j[ot]),ot=O&&ze(O[ot]);je(Lt,ot)!==0&&(Lt!=null&&ye(Lt),ot!=null)&&ye(ot)})}))):te?(Q={from:(U=te.lower)!=null?U:e.MIN_KEY,to:(L=te.upper)!=null?L:e.MAX_KEY},Y.add(Q),H.add(Q)):(H.add(o),Y.add(o),d.indexes.forEach(function(ne){return _(ne.name).add(o)})),c.mutate(k).then(function(ne){return!te||k.type!=="add"&&k.type!=="put"||(H.addKeys(ne.results),b&&b.forEach(function(Re){for(var ze=k.values.map(function(Lt){return Re.extractKey(Lt)}),ye=Re.keyPath.findIndex(function(Lt){return Lt===v.keyPath}),Ee=0,tt=ne.results.length;Ee<tt;++Ee)ze[Ee][ye]=ne.results[Ee];_(Re.name).addKeys(ze)})),I.mutatedParts=lo(I.mutatedParts||{},N),ne})}}),E={get:function(k){return[v,new Ct(k.key)]},getMany:function(k){return[v,new Ct().addKeys(k.keys)]},count:s,query:s,openCursor:s};return h(E).forEach(function(k){C[k]=function(_){var D=oe.subscr,j=!!D,O=ca(oe,c)&&fa(k,_)?_.obsSet={}:D;if(j){var I,D=function(Q){return Q="idb://".concat(t,"/").concat(i,"/").concat(Q),O[Q]||(O[Q]=new Ct)},N=D(""),H=D(":dels"),j=E[k](_),Y=j[0],j=j[1];if((k==="query"&&Y.isPrimaryKey&&!_.values?H:D(Y.name||"")).add(j),!Y.isPrimaryKey){if(k!=="count")return I=k==="query"&&x&&_.values&&c.query(l(l({},_),{values:!1})),c[k].apply(this,arguments).then(function(Q){if(k==="query"){if(x&&_.values)return I.then(function(ze){return ze=ze.result,N.addKeys(ze),Q});var U=_.values?Q.result.map(P):Q.result;(_.values?N:H).addKeys(U)}else{var ne,Re;if(k==="openCursor")return Re=_.values,(ne=Q)&&Object.create(ne,{key:{get:function(){return H.addKey(ne.primaryKey),ne.key}},primaryKey:{get:function(){var ze=ne.primaryKey;return H.addKey(ze),ze}},value:{get:function(){return Re&&N.addKey(ne.primaryKey),ne.value}}})}return Q});H.add(o)}}return c[k].apply(this,arguments)}}),C}})}};function da(e,t,o){var i;return o.numFailures===0?t:t.type==="deleteRange"||(i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1,o.numFailures===i)?null:(i=l({},t),m(i.keys)&&(i.keys=i.keys.filter(function(s,c){return!(c in o.failures)})),"values"in i&&m(i.values)&&(i.values=i.values.filter(function(s,c){return!(c in o.failures)})),i)}function si(e,t){return o=e,((i=t).lower===void 0||(i.lowerOpen?0<je(o,i.lower):0<=je(o,i.lower)))&&(o=e,(i=t).upper===void 0||(i.upperOpen?je(o,i.upper)<0:je(o,i.upper)<=0));var o,i}function va(e,t,o,i,s,c){var d,v,w,P,x,b;return!o||o.length===0||(d=t.query.index,v=d.multiEntry,w=t.query.range,P=i.schema.primaryKey.extractKey,x=d.extractKey,b=(d.lowLevelIndex||d).extractKey,(i=o.reduce(function(C,E){var k=C,_=[];if(E.type==="add"||E.type==="put")for(var D=new Ct,j=E.values.length-1;0<=j;--j){var O,I=E.values[j],N=P(I);!D.hasKey(N)&&(O=x(I),v&&m(O)?O.some(function(Q){return si(Q,w)}):si(O,w))&&(D.addKey(N),_.push(I))}switch(E.type){case"add":var H=new Ct().addKeys(t.values?C.map(function(U){return P(U)}):C),k=C.concat(t.values?_.filter(function(U){return U=P(U),!H.hasKey(U)&&(H.addKey(U),!0)}):_.map(function(U){return P(U)}).filter(function(U){return!H.hasKey(U)&&(H.addKey(U),!0)}));break;case"put":var Y=new Ct().addKeys(E.values.map(function(U){return P(U)}));k=C.filter(function(U){return!Y.hasKey(t.values?P(U):U)}).concat(t.values?_:_.map(function(U){return P(U)}));break;case"delete":var L=new Ct().addKeys(E.keys);k=C.filter(function(U){return!L.hasKey(t.values?P(U):U)});break;case"deleteRange":var te=E.range;k=C.filter(function(U){return!si(P(U),te)})}return k},e))===e)?e:(i.sort(function(C,E){return je(b(C),b(E))||je(P(C),P(E))}),t.limit&&t.limit<1/0&&(i.length>t.limit?i.length=t.limit:e.length===t.limit&&i.length<t.limit&&(s.dirty=!0)),c?Object.freeze(i):i)}function ha(e,t){return je(e.lower,t.lower)===0&&je(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function ol(e,t){return((o,i,s,c)=>{if(o===void 0)return i!==void 0?-1:0;if(i===void 0)return 1;if((o=je(o,i))===0){if(s&&c)return 0;if(s)return 1;if(c)return-1}return o})(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=((o,i,s,c)=>{if(o===void 0)return i!==void 0?1:0;if(i===void 0)return-1;if((o=je(o,i))===0){if(s&&c)return 0;if(s)return-1;if(c)return 1}return o})(e.upper,t.upper,e.upperOpen,t.upperOpen)}function il(e,t,o,i){e.subscribers.add(o),i.addEventListener("abort",function(){var s,c;e.subscribers.delete(o),e.subscribers.size===0&&(s=e,c=t,setTimeout(function(){s.subscribers.size===0&&Ve(c,s)},3e3))})}var al={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return l(l({},e),{transaction:function(o,i,s){var c,d,v=e.transaction(o,i,s);return i==="readwrite"&&(s=(c=new AbortController).signal,v.addEventListener("abort",(d=function(w){return function(){if(c.abort(),i==="readwrite"){for(var P=new Set,x=0,b=o;x<b.length;x++){var C=b[x],E=Ir["idb://".concat(t,"/").concat(C)];if(E){var k=e.table(C),_=E.optimisticOps.filter(function(ne){return ne.trans===v});if(v._explicit&&w&&v.mutatedParts)for(var D=0,j=Object.values(E.queries.query);D<j.length;D++)for(var O=0,I=(Y=j[D]).slice();O<I.length;O++)ei((L=I[O]).obsSet,v.mutatedParts)&&(Ve(Y,L),L.subscribers.forEach(function(ne){return P.add(ne)}));else if(0<_.length){E.optimisticOps=E.optimisticOps.filter(function(ne){return ne.trans!==v});for(var N=0,H=Object.values(E.queries.query);N<H.length;N++)for(var Y,L,te,Q=0,U=(Y=H[N]).slice();Q<U.length;Q++)(L=U[Q]).res!=null&&v.mutatedParts&&(w&&!L.dirty?(te=Object.isFrozen(L.res),te=va(L.res,L.req,_,k,L,te),L.dirty?(Ve(Y,L),L.subscribers.forEach(function(ne){return P.add(ne)})):te!==L.res&&(L.res=te,L.promise=G.resolve({result:te}))):(L.dirty&&Ve(Y,L),L.subscribers.forEach(function(ne){return P.add(ne)})))}}}P.forEach(function(ne){return ne()})}}})(!1),{signal:s}),v.addEventListener("error",d(!1),{signal:s}),v.addEventListener("complete",d(!0),{signal:s})),v},table:function(o){var i=e.table(o),s=i.schema.primaryKey;return l(l({},i),{mutate:function(c){var d,v=oe.trans;return!s.outbound&&v.db._options.cache!=="disabled"&&!v.explicit&&v.idbtrans.mode==="readwrite"&&(d=Ir["idb://".concat(t,"/").concat(o)])?(v=i.mutate(c),c.type!=="add"&&c.type!=="put"||!(50<=c.values.length||ai(s,c).some(function(w){return w==null}))?(d.optimisticOps.push(c),c.mutatedParts&&uo(c.mutatedParts),v.then(function(w){0<w.numFailures&&(Ve(d.optimisticOps,c),(w=da(0,c,w))&&d.optimisticOps.push(w),c.mutatedParts)&&uo(c.mutatedParts)}),v.catch(function(){Ve(d.optimisticOps,c),c.mutatedParts&&uo(c.mutatedParts)})):v.then(function(w){var P=da(0,l(l({},c),{values:c.values.map(function(x,b){var C;return w.failures[b]?x:(ve(C=(C=s.keyPath)!=null&&C.includes(".")?ee(x):l({},x),s.keyPath,w.results[b]),C)})}),w);d.optimisticOps.push(P),queueMicrotask(function(){return c.mutatedParts&&uo(c.mutatedParts)})}),v):i.mutate(c)},query:function(c){var d,v,w,P,x,b,C;return ca(oe,i)&&fa("query",c)?(d=((w=oe.trans)==null?void 0:w.db._options.cache)==="immutable",v=(w=oe).requery,w=w.signal,b=((E,k,_,D)=>{var j=Ir["idb://".concat(E,"/").concat(k)];if(!j)return[];if(!(E=j.queries[_]))return[null,!1,j,null];var O=E[(D.query?D.query.index.name:null)||""];if(!O)return[null,!1,j,null];switch(_){case"query":var I=O.find(function(N){return N.req.limit===D.limit&&N.req.values===D.values&&ha(N.req.query.range,D.query.range)});return I?[I,!0,j,O]:[O.find(function(N){return("limit"in N.req?N.req.limit:1/0)>=D.limit&&(!D.values||N.req.values)&&ol(N.req.query.range,D.query.range)}),!1,j,O];case"count":return I=O.find(function(N){return ha(N.req.query.range,D.query.range)}),[I,!!I,j,O]}})(t,o,"query",c),C=b[0],P=b[2],x=b[3],C&&b[1]?C.obsSet=c.obsSet:(b=i.query(c).then(function(E){var k=E.result;if(C&&(C.res=k),d){for(var _=0,D=k.length;_<D;++_)Object.freeze(k[_]);Object.freeze(k)}else E.result=ee(k);return E}).catch(function(E){return x&&C&&Ve(x,C),Promise.reject(E)}),C={obsSet:c.obsSet,promise:b,subscribers:new Set,type:"query",req:c,dirty:!1},x?x.push(C):(x=[C],(P=P||(Ir["idb://".concat(t,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[c.query.index.name||""]=x)),il(C,x,v,w),C.promise.then(function(E){return{result:va(E.result,c,P?.optimisticOps,i,C,d)}})):i.query(c)}})}})}};function fo(e,t){return new Proxy(e,{get:function(o,i,s){return i==="db"?t:Reflect.get(o,i,s)}})}ut.prototype.version=function(e){if(isNaN(e)||e<.1)throw new W.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new W.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,o=t.filter(function(i){return i._cfg.version===e})[0];return o||(o=new this.Version(e),t.push(o),t.sort(Gs),o.stores({}),this._state.autoSchema=!1),o},ut.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||oe.letThrough||this._vip)?e():new G(function(o,i){if(t._state.openComplete)return i(new W.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new W.DatabaseClosed);t.open().catch(pe)}t._state.dbReadyPromise.then(o,i)}).then(e)},ut.prototype.use=function(s){var t=s.stack,o=s.create,i=s.level,s=s.name,c=(s&&this.unuse({stack:t,name:s}),this._middlewares[t]||(this._middlewares[t]=[]));return c.push({stack:t,create:o,level:i??10,name:s}),c.sort(function(d,v){return d.level-v.level}),this},ut.prototype.unuse=function(e){var t=e.stack,o=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(s){return i?s.create!==i:!!o&&s.name!==o})),this},ut.prototype.open=function(){var e=this;return jr(Zt,function(){return Zs(e)})},ut.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=Xr.indexOf(this);if(0<=t&&Xr.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new G(function(o){e.dbReadyResolve=o}),e.openCanceller=new G(function(o,i){e.cancelOpen=i}))},ut.prototype.close=function(t){var t=(t===void 0?{disableAutoOpen:!0}:t).disableAutoOpen,o=this._state;t?(o.isBeingOpened&&o.cancelOpen(new W.DatabaseClosed),this._close(),o.autoOpen=!1,o.dbOpenError=new W.DatabaseClosed):(this._close(),o.autoOpen=this._options.autoOpen||o.isBeingOpened,o.openComplete=!1,o.dbOpenError=null)},ut.prototype.delete=function(e){var t=this,o=(e===void 0&&(e={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),i=this._state;return new G(function(s,c){function d(){t.close(e);var v=t._deps.indexedDB.deleteDatabase(t.name);v.onsuccess=et(function(){var w,P,x;w=t._deps,P=t.name,Qo(x=w.indexedDB)||P===Xn||Xo(x,w.IDBKeyRange).delete(P).catch(pe),s()}),v.onerror=er(c),v.onblocked=t._fireOnBlocked}if(o)throw new W.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(d):d()})},ut.prototype.backendDB=function(){return this.idbdb},ut.prototype.isOpen=function(){return this.idbdb!==null},ut.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ut.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ut.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ut.prototype,"tables",{get:function(){var e=this;return h(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ut.prototype.transaction=function(){var e=(function(t,o,i){var s=arguments.length;if(s<2)throw new W.InvalidArgument("Too few arguments");for(var c=new Array(s-1);--s;)c[s-1]=arguments[s];return i=c.pop(),[t,Ie(c),i]}).apply(this,arguments);return this._transaction.apply(this,e)},ut.prototype._transaction=function(e,t,o){var i,s,c=this,d=oe.trans,v=(d&&d.db===this&&e.indexOf("!")===-1||(d=null),e.indexOf("?")!==-1);e=e.replace("!","").replace("?","");try{if(s=t.map(function(P){if(P=P instanceof c.Table?P.name:P,typeof P!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return P}),e=="r"||e===No)i=No;else{if(e!="rw"&&e!=Lo)throw new W.InvalidArgument("Invalid transaction mode: "+e);i=Lo}if(d){if(d.mode===No&&i===Lo){if(!v)throw new W.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");d=null}d&&s.forEach(function(P){if(d&&d.storeNames.indexOf(P)===-1){if(!v)throw new W.SubTransaction("Table "+P+" not included in parent transaction.");d=null}}),v&&d&&!d.active&&(d=null)}}catch(P){return d?d._promise(null,function(x,b){b(P)}):lt(P)}var w=(function P(x,b,C,E,k){return G.resolve().then(function(){var O=oe.transless||oe,_=x._createTransaction(b,C,x._dbSchema,E),O=(_.explicit=!0,{trans:_,transless:O});if(E)_.idbtrans=E.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,x._state.PR1398_maxLoop=3}catch(I){return I.name===Me.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return P(x,b,C,null,k)})):lt(I)}var D,j=at(k),O=(j&&Gr(),G.follow(function(){var I;(D=k.call(_,_))&&(j?(I=gr.bind(null,null),D.then(I,I)):typeof D.next=="function"&&typeof D.throw=="function"&&(D=oi(D)))},O));return(D&&typeof D.then=="function"?G.resolve(D).then(function(I){return _.active?I:lt(new W.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):O.then(function(){return D})).then(function(I){return E&&_._resolve(),_._completion.then(function(){return I})}).catch(function(I){return _._reject(I),lt(I)})})}).bind(null,this,i,s,d,o);return d?d._promise(i,w,"lock"):oe.trans?jr(oe.transless,function(){return c._whenReady(w)}):this._whenReady(w)},ut.prototype.table=function(e){if(S(this._allTables,e))return this._allTables[e];throw new W.InvalidTable("Table ".concat(e," does not exist"))};var sr=ut;function ut(e,t){var o,i,s,c,d,v=this,w=(this._middlewares={},this.verno=0,ut.dependencies),w=(this._options=t=l({addons:ut.addons,autoOpen:!0,indexedDB:w.indexedDB,IDBKeyRange:w.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},t.addons),P=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:pe,dbReadyPromise:null,cancelOpen:pe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen}),x=(P.dbReadyPromise=new G(function(b){P.dbReadyResolve=b}),P.openCanceller=new G(function(b,C){P.cancelOpen=C}),this._state=P,this.name=e,this.on=On(this,"populate","blocked","versionchange","close",{ready:[Ne,pe]}),this.once=function(b,C){var E=function(){for(var k=[],_=0;_<arguments.length;_++)k[_]=arguments[_];v.on(b).unsubscribe(E),C.apply(v,k)};return v.on(b,E)},this.on.ready.subscribe=ge(this.on.ready.subscribe,function(b){return function(C,E){ut.vip(function(){var k,_=v._state;_.openComplete?(_.dbOpenError||G.resolve().then(C),E&&b(C)):_.onReadyBeingFired?(_.onReadyBeingFired.push(C),E&&b(C)):(b(C),k=v,E||b(function D(){k.on.ready.unsubscribe(C),k.on.ready.unsubscribe(D)}))})}}),this.Collection=(o=this,Pn(zs.prototype,function(D,_){this.db=o;var E=Ui,k=null;if(_)try{E=_()}catch(O){k=O}var _=D._ctx,D=_.table,j=D.hook.reading.fire;this._ctx={table:D,index:_.index,isPrimKey:!_.index||D.schema.primKey.keyPath&&_.index===D.schema.primKey.name,range:E,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:k,or:_.or,valueMapper:j!==st?j:null}})),this.Table=(i=this,Pn(Gi.prototype,function(b,C,E){this.db=i,this._tx=E,this.name=b,this.schema=C,this.hook=i._allTables[b]?i._allTables[b].hook:On(null,{creating:[V,pe],reading:[St,st],updating:[we,pe],deleting:[Z,pe]})})),this.Transaction=(s=this,Pn($s.prototype,function(b,C,E,k,_){var D=this;b!=="readonly"&&C.forEach(function(j){j=(j=E[j])==null?void 0:j.yProps,j&&(C=C.concat(j.map(function(O){return O.updatesTable})))}),this.db=s,this.mode=b,this.storeNames=C,this.schema=E,this.chromeTransactionDurability=k,this.idbtrans=null,this.on=On(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new G(function(j,O){D._resolve=j,D._reject=O}),this._completion.then(function(){D.active=!1,D.on.complete.fire()},function(j){var O=D.active;return D.active=!1,D.on.error.fire(j),D.parent?D.parent._reject(j):O&&D.idbtrans&&D.idbtrans.abort(),lt(j)})})),this.Version=(c=this,Pn(Js.prototype,function(b){this.db=c,this._cfg={version:b,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(d=this,Pn(ea.prototype,function(b,C,E){if(this.db=d,this._ctx={table:b,index:C===":id"?null:C,or:E},this._cmp=this._ascending=je,this._descending=function(k,_){return je(_,k)},this._max=function(k,_){return 0<je(k,_)?k:_},this._min=function(k,_){return je(k,_)<0?k:_},this._IDBKeyRange=d._deps.IDBKeyRange,!this._IDBKeyRange)throw new W.MissingAPI})),this.on("versionchange",function(b){0<b.newVersion?console.warn("Another connection wants to upgrade database '".concat(v.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(v.name,"'. Closing db now to resume the delete request.")),v.close({disableAutoOpen:!1})}),this.on("blocked",function(b){!b.newVersion||b.newVersion<b.oldVersion?console.warn("Dexie.delete('".concat(v.name,"') was blocked")):console.warn("Upgrade '".concat(v.name,"' blocked by other connection holding version ").concat(b.oldVersion/10))}),this._maxKey=Mn(t.IDBKeyRange),this._createTransaction=function(b,C,E,k){return new v.Transaction(b,C,E,v._options.chromeTransactionDurability,k)},this._fireOnBlocked=function(b){v.on("blocked").fire(b),Xr.filter(function(C){return C.name===v.name&&C!==v&&!C._state.vcFired}).map(function(C){return C.on("versionchange").fire(b)})},this.use(rl),this.use(al),this.use(nl),this.use(el),this.use(tl),new Proxy(this,{get:function(b,C,E){var k;return C==="_vip"||(C==="table"?function(_){return fo(v.table(_),x)}:(k=Reflect.get(b,C,E))instanceof Gi?fo(k,x):C==="tables"?k.map(function(_){return fo(_,x)}):C==="_createTransaction"?function(){return fo(k.apply(this,arguments),x)}:k)}}));this.vip=x,w.forEach(function(b){return b(v)})}var vo,en=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",sl=(li.prototype.subscribe=function(e,t,o){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:o})},li.prototype[en]=function(){return this},li);function li(e){this._subscribe=e}try{vo={indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch{vo={indexedDB:null,IDBKeyRange:null}}function pa(e){var t,o=!1,i=new sl(function(s){var c=at(e),d,v=!1,w={},P={},x={get closed(){return v},unsubscribe:function(){v||(v=!0,d&&d.abort(),b&&_r.storagemutated.unsubscribe(E))}},b=(s.start&&s.start(x),!1),C=function(){return Ko(k)},E=function(_){lo(w,_),ei(P,w)&&C()},k=function(){var _,D,j;!v&&vo.indexedDB&&(w={},_={},d&&d.abort(),d=new AbortController,j=(O=>{var I=Yr();try{c&&Gr();var N=mr(e,O);return N=c?N.finally(gr):N}finally{I&&Wr()}})(D={subscr:_,signal:d.signal,requery:C,querier:e,trans:null}),Promise.resolve(j).then(function(O){o=!0,t=O,v||D.signal.aborted||(w={},(I=>{for(var N in I)if(S(I,N))return;return 1})(P=_)||b||(_r(Dn,E),b=!0),Ko(function(){return!v&&s.next&&s.next(O)}))},function(O){o=!1,["DatabaseClosedError","AbortError"].includes(O?.name)||v||Ko(function(){v||s.error&&s.error(O)})}))};return setTimeout(C,0),x});return i.hasValue=function(){return o},i.getValue=function(){return t},i}var Fr=sr;function ui(e){var t=wr;try{wr=!0,_r.storagemutated.fire(e),ni(e,!0)}finally{wr=t}}A(Fr,l(l({},q),{delete:function(e){return new Fr(e,{addons:[]}).delete()},exists:function(e){return new Fr(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Fr.dependencies,o=t.indexedDB,t=t.IDBKeyRange,(Qo(o)?Promise.resolve(o.databases()).then(function(i){return i.map(function(s){return s.name}).filter(function(s){return s!==Xn})}):Xo(o,t).toCollection().primaryKeys()).then(e)}catch{return lt(new W.MissingAPI)}var t,o},defineClass:function(){return function(e){g(this,e)}},ignoreTransaction:function(e){return oe.trans?jr(oe.transless,e):e()},vip:Jo,async:function(e){return function(){try{var t=oi(e.apply(this,arguments));return t&&typeof t.then=="function"?t:G.resolve(t)}catch(o){return lt(o)}}},spawn:function(e,t,o){try{var i=oi(e.apply(o,t||[]));return i&&typeof i.then=="function"?i:G.resolve(i)}catch(s){return lt(s)}},currentTransaction:{get:function(){return oe.trans||null}},waitFor:function(e,t){return e=G.resolve(typeof e=="function"?Fr.ignoreTransaction(e):e).timeout(t||6e4),oe.trans?oe.trans.waitFor(e):e},Promise:G,debug:{get:function(){return Le},set:function(e){xt(e)}},derive:$,extend:g,props:A,override:ge,Events:On,on:_r,liveQuery:pa,extendObservabilitySet:lo,getByKeyPath:ae,setByKeyPath:ve,delByKeyPath:function(e,t){typeof t=="string"?ve(e,t,void 0):"length"in t&&[].map.call(t,function(o){ve(e,o,void 0)})},shallowClone:le,deepClone:ee,getObjectDiff:ii,cmp:je,asap:X,minKey:-1/0,addons:[],connections:Xr,errnames:Me,dependencies:vo,cache:Ir,semVer:"4.3.0",version:"4.3.0".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,o){return e+t/Math.pow(10,2*o)})})),Fr.maxKey=Mn(Fr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(_r(Dn,function(e){wr||(e=new CustomEvent(Uo,{detail:e}),wr=!0,dispatchEvent(e),wr=!1)}),addEventListener(Uo,function(e){e=e.detail,wr||ui(e)}));var tn,wr=!1,ma=function(){};return typeof BroadcastChannel<"u"&&((ma=function(){(tn=new BroadcastChannel(Uo)).onmessage=function(e){return e.data&&ui(e.data)}})(),typeof tn.unref=="function"&&tn.unref(),_r(Dn,function(e){wr||tn.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!sr.disableBfCache&&e.persisted){Le&&console.debug("Dexie: handling persisted pagehide"),tn?.close();for(var t=0,o=Xr;t<o.length;t++)o[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!sr.disableBfCache&&e.persisted&&(Le&&console.debug("Dexie: handling persisted pageshow"),ma(),ui({all:new Ct(-1/0,[[]])}))})),G.rejectionMapper=function(e,t){return!e||e instanceof Ce||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Xe[e.name]?e:(t=new Xe[e.name](t||e.message,e),"stack"in e&&R(t,"stack",{get:function(){return this.inner.stack}}),t)},xt(Le),l(sr,Object.freeze({__proto__:null,Dexie:sr,Entity:Vi,PropModification:An,RangeSet:Ct,add:function(e){return new An({add:e})},cmp:je,default:sr,liveQuery:pa,mergeRanges:Tn,rangesOverlap:ia,remove:function(e){return new An({remove:e})},replacePrefix:function(e,t){return new An({replacePrefix:[e,t]})}}),{default:sr}),sr})})(go)),go.exports}var qu=Lu();const Si=Ku(qu),Ra=Symbol.for("Dexie"),_o=globalThis[Ra]||(globalThis[Ra]=Si);if(Si.semVer!==_o.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Si.semVer} and ${_o.semVer}`);const{liveQuery:Zf,mergeRanges:ed,rangesOverlap:td,RangeSet:rd,cmp:nd,Entity:od,PropModification:id,replacePrefix:ad,add:sd,remove:ld,DexieYProvider:ud}=_o,Ge=new _o("MemoriaDB");Ge.version(1).stores({collections:"id, name, createdAt, updatedAt",cards:"id, collectionId, createdAt, lastReviewedAt"});class zu{constructor(n={}){this.id=n.id||crypto.randomUUID(),this.name=n.name||"",this.description=n.description||"",this.createdAt=n.createdAt||Date.now(),this.updatedAt=n.updatedAt||Date.now(),this.cardCount=n.cardCount||0}}class Uu{constructor(n={}){this.id=n.id||crypto.randomUUID(),this.collectionId=n.collectionId||"",this.text=n.text||"",this.imageBlob=n.imageBlob||null,this.audioBlob=n.audioBlob||null,this.createdAt=n.createdAt||Date.now(),this.lastReviewedAt=n.lastReviewedAt||null,this.reviewCount=n.reviewCount||0,this.difficulty=n.difficulty||0}}async function Vu(){try{return await Ge.open(),console.log("â Memoria database initialized successfully"),console.log("ð Database version:",Ge.verno),!0}catch(r){return console.error("â Failed to initialize database:",r),window.indexedDB||console.error("â ï¸ Your browser does not support IndexedDB. Please upgrade to a modern browser."),!1}}function gn(r){if(!r)return"Never";const n=new Date(r),l=new Date-n,f=Math.floor(l/1e3),u=Math.floor(f/60),h=Math.floor(u/60),m=Math.floor(h/24),g=Math.floor(m/7),y=Math.floor(m/30),B=Math.floor(m/365);return f<60?"Just now":u<60?`${u} minute${u!==1?"s":""} ago`:h<24?`${h} hour${h!==1?"s":""} ago`:m<7?`${m} day${m!==1?"s":""} ago`:g<4?`${g} week${g!==1?"s":""} ago`:y<12?`${y} month${y!==1?"s":""} ago`:`${B} year${B!==1?"s":""} ago`}function $u(r,n=100){return!r||r.length<=n?r:r.substring(0,n)+"..."}function Hu(){return{indexedDB:!!window.indexedDB,serviceWorker:"serviceWorker"in navigator,mediaDevices:!!navigator.mediaDevices,getUserMedia:!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),mediaRecorder:typeof MediaRecorder<"u",crypto:!!window.crypto&&!!window.crypto.randomUUID,canvas:(()=>{try{const r=document.createElement("canvas");return!!(r.getContext&&r.getContext("2d"))}catch{return!1}})()}}function Yu(){const r=Hu();console.log("ð Browser Support Check:"),console.table(r);const n=Object.keys(r).filter(a=>!r[a]);n.length>0?console.warn("â ï¸ Unsupported features:",n.join(", ")):console.log("â All features supported!")}function Wu(){const{subscribe:r,set:n,update:a}=Ms([]);return{subscribe:r,async load(){try{const l=await Ge.collections.orderBy("updatedAt").reverse().toArray();return n(l),console.log("ð Loaded",l.length,"collections"),l}catch(l){throw console.error("Failed to load collections:",l),n([]),l}},async create(l){try{const f=new zu({name:l.name,description:l.description||""});return await Ge.collections.add(f),a(u=>[f,...u]),console.log("â Created collection:",f.name),f}catch(f){throw console.error("Failed to create collection:",f),f}},async update(l,f){try{const u={...f,updatedAt:Date.now()};await Ge.collections.update(l,u),a(h=>h.map(m=>m.id===l?{...m,...u}:m)),console.log("â Updated collection:",l)}catch(u){throw console.error("Failed to update collection:",u),u}},async delete(l){try{await Ge.collections.delete(l),await Ge.cards.where("collectionId").equals(l).delete(),a(f=>f.filter(u=>u.id!==l)),console.log("ðï¸ Deleted collection:",l)}catch(f){throw console.error("Failed to delete collection:",f),f}},async getById(l){try{return await Ge.collections.get(l)}catch(f){throw console.error("Failed to get collection:",f),f}},async updateCardCount(l,f){try{await Ge.collections.update(l,{cardCount:f,updatedAt:Date.now()}),a(u=>u.map(h=>h.id===l?{...h,cardCount:f,updatedAt:Date.now()}:h))}catch(u){throw console.error("Failed to update card count:",u),u}},async clear(){await Ge.collections.clear(),await Ge.cards.clear(),n([]),console.log("ðï¸ Cleared all collections")}}}const cr=Wu();var Gu=J('<div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10"><button class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit</button> <button class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> Delete</button></div>'),Xu=J('<p class="text-gray-600 text-sm mb-4 line-clamp-2 svelte-17y57sb"> </p>'),Qu=J('<p class="text-gray-400 text-sm italic mb-4">No description</p>'),Ju=J('<div><div class="absolute top-4 right-4 menu-container"><button class="text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-100" aria-label="Collection options"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path></svg></button> <!></div> <div class="pr-8"><h3 class="text-xl font-semibold text-gray-900 mb-2"> </h3> <!> <div class="flex items-center justify-between mt-4 pt-4 border-t border-gray-100"><div class="flex items-center text-sm text-gray-500"><svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg> <span class="font-medium"> </span> <span class="ml-1">cards</span></div> <div class="text-xs text-gray-400"> </div></div></div></div>');function Zu(r,n){Bt(n,!1);let a=Pe(n,"collection",8),l=Pe(n,"onEdit",8,null),f=Pe(n,"onDelete",8,null),u=Pe(n,"onClick",8,null),h=ie(!1);function m(){T(h,!p(h))}function g(){T(h,!1),l()&&l()(a())}function y(){T(h,!1),f()&&f()(a())}function B(ee){p(h)&&!ee.target.closest(".menu-container")&&T(h,!1)}Kt();var S=Ju();he("click",zn,B);let A;var F=M(S),R=M(F),$=K(R,2);{var re=ee=>{var xe=Gu(),De=M(xe),Oe=K(De,2);he("click",De,g),he("click",Oe,y),z(ee,xe)};me($,ee=>{p(h)&&ee(re)})}var ue=K(F,2),de=M(ue),ge=M(de),_e=K(de,2);{var X=ee=>{var xe=Xu(),De=M(xe);Ae(()=>Se(De,(We(a()),ce(()=>a().description)))),z(ee,xe)},ae=ee=>{var xe=Qu();z(ee,xe)};me(_e,ee=>{We(a()),ce(()=>a().description)?ee(X):ee(ae,!1)})}var ve=K(_e,2),le=M(ve),Be=K(M(le),2),Ie=M(Be),Fe=K(le,2),Ue=M(Fe);Ae(ee=>{A=Dr(S,1,"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow p-6 relative",null,A,{"cursor-pointer":u()}),$r(S,"role",u()?"button":null),$r(S,"tabindex",u()?0:null),Se(ge,(We(a()),ce(()=>a().name))),Se(Ie,(We(a()),ce(()=>a().cardCount||0))),Se(Ue,`Updated ${ee??""}`)},[()=>(We(gn),We(a()),ce(()=>gn(a().updatedAt)))]),he("click",R,Fi(m)),he("click",S,()=>u()&&u()(a())),he("keydown",S,ee=>(ee.key==="Enter"||ee.key===" ")&&u()&&u()(a())),z(r,S),Dt()}var ec=J('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>'),tc=J('<button class="inline-flex items-center px-6 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Create Your First Collection</button>'),rc=J('<div class="text-center py-16"><div class="inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4"><svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div> <h3 class="text-xl font-semibold text-gray-900 mb-2">No collections yet</h3> <p class="text-gray-600 mb-6 max-w-sm mx-auto">Get started by creating your first collection to organize your flashcards.</p> <!></div>'),nc=J("<div><!></div>");function oc(r,n){Bt(n,!1);let a=Pe(n,"collections",24,()=>[]),l=Pe(n,"onEdit",8,null),f=Pe(n,"onDelete",8,null),u=Pe(n,"onCreate",8,null),h=Pe(n,"onClick",8,null);Kt();var m=nc(),g=M(m);{var y=S=>{var A=ec();Ps(A,5,a,F=>F.id,(F,R)=>{Zu(F,{get collection(){return p(R)},get onEdit(){return l()},get onDelete(){return f()},get onClick(){return h()}})}),z(S,A)},B=S=>{var A=rc(),F=K(M(A),6);{var R=$=>{var re=tc();he("click",re,function(...ue){u()?.apply(this,ue)}),z($,re)};me(F,$=>{u()&&$(R)})}z(S,A)};me(g,S=>{We(a()),ce(()=>a().length>0)?S(y):S(B,!1)})}z(r,m),Dt()}var ic=J('<div class="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"> </div>'),ac=J('<p class="text-sm text-red-600"> </p>'),sc=J('<p class="text-xs text-gray-500">Required</p>'),lc=J('<p class="text-sm text-red-600"> </p>'),uc=J("<div></div>"),cc=Et('<svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Saving...',1),fc=J('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center p-4 z-50 overflow-y-auto" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white rounded-lg shadow-xl max-w-md w-full max-h-[85dvh] overflow-y-auto my-auto"><div class="flex items-center justify-between p-6 border-b border-gray-200"><h2 id="modal-title" class="text-2xl font-semibold text-gray-900"> </h2> <button class="p-2 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors" aria-label="Close"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6"><!> <div class="mb-4"><label for="collection-name" class="block text-sm font-medium text-gray-700 mb-2">Collection Name <span class="text-red-500">*</span></label> <input id="collection-name" type="text" placeholder="e.g., Spanish Vocabulary" maxlength="100"/> <div class="flex items-center justify-between mt-1"><!> <p class="text-xs text-gray-400"> </p></div></div> <div class="mb-6"><label for="collection-description" class="block text-sm font-medium text-gray-700 mb-2">Description <span class="text-gray-400 text-xs">(optional)</span></label> <textarea id="collection-description" placeholder="Add a description to help you remember what this collection is for..." maxlength="500" rows="4"></textarea> <div class="flex items-center justify-between mt-1"><!> <p class="text-xs text-gray-400"> </p></div></div> <div class="flex gap-3"><button type="button" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Cancel</button> <button type="submit" class="flex-1 px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"><!></button></div></form></div></div>');function dc(r,n){Bt(n,!1);const a=ie(),l=ie(),f=ie();let u=Pe(n,"collection",8,null),h=Pe(n,"isOpen",8,!1);const m=Cn();let g=ie(u()?.name||""),y=ie(u()?.description||""),B=ie(!1),S=ie({});function A(){u()||(T(g,""),T(y,"")),T(S,{}),T(B,!1)}function F(){return T(S,{}),p(g).trim()?p(g).trim().length>100&&It(S,p(S).name="Collection name must be 100 characters or less"):It(S,p(S).name="Collection name is required"),p(y).length>500&&It(S,p(S).description="Description must be 500 characters or less"),Object.keys(p(S)).length===0}async function R(){if(F()){T(B,!0);try{const X={name:p(g).trim(),description:p(y).trim()};p(a)?m("update",{id:u().id,...X}):m("create",X),$()}catch(X){console.error("Failed to submit:",X),It(S,p(S).general="Failed to save collection. Please try again.")}finally{T(B,!1)}}}function $(){m("close"),A()}function re(X){X.target===X.currentTarget&&$()}function ue(X){X.key==="Escape"&&$()}ht(()=>We(u()),()=>{u()&&(T(g,u().name||""),T(y,u().description||""))}),ht(()=>We(h()),()=>{h()||A()}),ht(()=>We(u()),()=>{T(a,u()!==null)}),ht(()=>p(a),()=>{T(l,p(a)?"Edit Collection":"New Collection")}),ht(()=>p(a),()=>{T(f,p(a)?"Save Changes":"Create Collection")}),wn(),Kt();var de=Bo(),ge=Pr(de);{var _e=X=>{var ae=fc(),ve=M(ae),le=M(ve),Be=M(le),Ie=M(Be),Fe=K(Be,2),Ue=K(le,2),ee=M(Ue);{var xe=be=>{var Ne=ic(),Le=M(Ne);Ae(()=>Se(Le,(p(S),ce(()=>p(S).general)))),z(be,Ne)};me(ee,be=>{p(S),ce(()=>p(S).general)&&be(xe)})}var De=K(ee,2),Oe=K(M(De),2);let He;var Ve=K(Oe,2),ke=M(Ve);{var Ke=be=>{var Ne=ac(),Le=M(Ne);Ae(()=>Se(Le,(p(S),ce(()=>p(S).name)))),z(be,Ne)},at=be=>{var Ne=sc();z(be,Ne)};me(ke,be=>{p(S),ce(()=>p(S).name)?be(Ke):be(at,!1)})}var q=K(ke,2),se=M(q),Ce=K(De,2),Qe=K(M(Ce),2);let ct;var fe=K(Qe,2),Me=M(fe);{var ft=be=>{var Ne=lc(),Le=M(Ne);Ae(()=>Se(Le,(p(S),ce(()=>p(S).description)))),z(be,Ne)},W=be=>{var Ne=uc();z(be,Ne)};me(Me,be=>{p(S),ce(()=>p(S).description)?be(ft):be(W,!1)})}var Xe=K(Me,2),pe=M(Xe),st=K(Ce,2),St=M(st),vt=K(St,2),V=M(vt);{var Z=be=>{var Ne=cc();z(be,Ne)},we=be=>{var Ne=As();Ae(()=>Se(Ne,p(f))),z(be,Ne)};me(V,be=>{p(B)?be(Z):be(we,!1)})}Ae(()=>{Se(Ie,p(l)),He=Dr(Oe,1,"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-colors text-base",null,He,{"border-red-500":p(S).name}),Oe.disabled=p(B),Se(se,`${p(g),ce(()=>p(g).length)??""}/100`),ct=Dr(Qe,1,"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-colors resize-none text-base",null,ct,{"border-red-500":p(S).description}),Qe.disabled=p(B),Se(pe,`${p(y),ce(()=>p(y).length)??""}/500`),St.disabled=p(B),vt.disabled=p(B)}),he("click",Fe,$),Ci(Oe,()=>p(g),be=>T(g,be)),Ci(Qe,()=>p(y),be=>T(y,be)),he("click",St,$),he("submit",Ue,Bs(R)),he("click",ae,re),he("keydown",ae,ue),z(X,ae)};me(ge,X=>{h()&&X(_e)})}z(r,de),Dt()}function vc(){const{subscribe:r,set:n,update:a}=Ms([]);return{subscribe:r,async load(l){try{const f=await Ge.cards.where("collectionId").equals(l).sortBy("createdAt");return f.reverse(),n(f),console.log("ð Loaded",f.length,"cards for collection",l),f}catch(f){throw console.error("Failed to load cards:",f),n([]),f}},async create(l,f){try{const u=new Uu({collectionId:l,text:f.text,imageBlob:f.imageBlob||null,audioBlob:f.audioBlob||null});return await Ge.cards.add(u),a(h=>[u,...h]),await Ta(l),console.log("â Created card:",u.id),u}catch(u){throw console.error("Failed to create card:",u),u}},async update(l,f){try{await Ge.cards.update(l,f),a(u=>u.map(h=>h.id===l?{...h,...f}:h)),console.log("â Updated card:",l)}catch(u){throw console.error("Failed to update card:",u),u}},async delete(l,f){try{await Ge.cards.delete(l),a(u=>u.filter(h=>h.id!==l)),await Ta(f),console.log("ðï¸ Deleted card:",l)}catch(u){throw console.error("Failed to delete card:",u),u}},async getById(l){try{return await Ge.cards.get(l)}catch(f){throw console.error("Failed to get card:",f),f}},async markAsReviewed(l){try{const f=await Ge.cards.get(l);if(!f)return;await Ge.cards.update(l,{lastReviewedAt:Date.now(),reviewCount:(f.reviewCount||0)+1}),a(u=>u.map(h=>h.id===l?{...h,lastReviewedAt:Date.now(),reviewCount:(h.reviewCount||0)+1}:h)),console.log("ð Marked card as reviewed:",l)}catch(f){throw console.error("Failed to mark card as reviewed:",f),f}},clear(){n([])}}}async function Ta(r){try{const n=await Ge.cards.where("collectionId").equals(r).count();await cr.updateCardCount(r,n)}catch(n){console.error("Failed to update collection card count:",n)}}const Cr=vc();var hc=J('<div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10"><button class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit</button> <button class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> Delete</button></div>'),pc=J('<img alt="Card thumbnail" class="flex-shrink-0 w-16 h-16 object-cover rounded mr-3"/>'),mc=J('<div class="flex-shrink-0 w-8 h-8 bg-indigo-100 rounded flex items-center justify-center mr-3"><svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg></div>'),gc=J('<span class="inline-flex items-center mt-1 text-xs text-indigo-600"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg> Multi-line</span>'),yc=J('<span class="inline-flex items-center px-2 py-1 bg-green-100 text-green-700 text-xs rounded"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path></svg> Photo</span>'),bc=J('<span class="inline-flex items-center px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"></path></svg> Audio</span>'),_c=J('<span class="flex items-center"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path></svg> </span>'),wc=J('<div class="bg-white rounded-lg border border-gray-200 hover:border-indigo-300 hover:shadow-md transition-all p-4 relative group"><div class="absolute top-3 right-3 menu-container"><button class="text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-100 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Card options"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path></svg></button> <!></div> <div class="pr-8"><div class="flex items-start mb-2"><!> <div class="flex-1 min-w-0"><p class="text-sm text-gray-900 whitespace-pre-wrap break-words"> </p> <!></div></div> <div class="flex items-center gap-2 mt-3"><!> <!></div> <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-100"><div class="flex items-center gap-3 text-xs text-gray-500"><!> <span> </span></div></div></div></div>');function xc(r,n){Bt(n,!1);const a=ie();let l=Pe(n,"card",8),f=Pe(n,"onEdit",8,null),u=Pe(n,"onDelete",8,null),h=ie(!1);function m(){T(h,!p(h))}function g(){T(h,!1),f()&&f()(l())}function y(){T(h,!1),u()&&u()(l())}function B(q){p(h)&&!q.target.closest(".menu-container")&&T(h,!1)}function S(q){const se=q.split(`
`).filter(Qe=>Qe.trim());if(se.length===0)return"Empty card";const Ce=se.slice(0,2).join(`
`);return $u(Ce,150)}ht(()=>We(l()),()=>{T(a,l().text.split(`
`).filter(q=>q.trim()).length>1)}),wn(),Kt();var A=wc();he("click",zn,B);var F=M(A),R=M(F),$=K(R,2);{var re=q=>{var se=hc(),Ce=M(se),Qe=K(Ce,2);he("click",Ce,g),he("click",Qe,y),z(q,se)};me($,q=>{p(h)&&q(re)})}var ue=K(F,2),de=M(ue),ge=M(de);{var _e=q=>{var se=pc();Ae(Ce=>$r(se,"src",Ce),[()=>(We(l()),ce(()=>URL.createObjectURL(l().imageBlob)))]),z(q,se)},X=q=>{var se=mc();z(q,se)};me(ge,q=>{We(l()),ce(()=>l().imageBlob)?q(_e):q(X,!1)})}var ae=K(ge,2),ve=M(ae),le=M(ve),Be=K(ve,2);{var Ie=q=>{var se=gc();z(q,se)};me(Be,q=>{p(a)&&q(Ie)})}var Fe=K(de,2),Ue=M(Fe);{var ee=q=>{var se=yc();z(q,se)};me(Ue,q=>{We(l()),ce(()=>l().imageBlob)&&q(ee)})}var xe=K(Ue,2);{var De=q=>{var se=bc();z(q,se)};me(xe,q=>{We(l()),ce(()=>l().audioBlob)&&q(De)})}var Oe=K(Fe,2),He=M(Oe),Ve=M(He);{var ke=q=>{var se=_c(),Ce=K(M(se));Ae(()=>Se(Ce,` Reviewed ${We(l()),ce(()=>l().reviewCount)??""}x`)),z(q,se)};me(Ve,q=>{We(l()),ce(()=>l().reviewCount>0)&&q(ke)})}var Ke=K(Ve,2),at=M(Ke);Ae((q,se)=>{Se(le,q),Se(at,`Created ${se??""}`)},[()=>(We(l()),ce(()=>S(l().text))),()=>(We(gn),We(l()),ce(()=>gn(l().createdAt)))]),he("click",R,Fi(m)),z(r,A),Dt()}var kc=J('<div class="space-y-3"></div>'),Cc=J('<button class="inline-flex items-center px-6 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors shadow-sm"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add Your First Card</button>'),Ec=J('<div class="text-center py-16 bg-white rounded-lg border-2 border-dashed border-gray-300"><div class="inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4"><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg></div> <h3 class="text-xl font-semibold text-gray-900 mb-2">No cards yet</h3> <p class="text-gray-600 mb-6 max-w-sm mx-auto">Start building your collection by adding your first flashcard.</p> <!></div>'),Sc=J("<div><!></div>");function Ac(r,n){Bt(n,!1);let a=Pe(n,"cards",24,()=>[]),l=Pe(n,"onEdit",8,null),f=Pe(n,"onDelete",8,null),u=Pe(n,"onCreate",8,null);Kt();var h=Sc(),m=M(h);{var g=B=>{var S=kc();Ps(S,5,a,A=>A.id,(A,F)=>{xc(A,{get card(){return p(F)},get onEdit(){return l()},get onDelete(){return f()}})}),z(B,S)},y=B=>{var S=Ec(),A=K(M(S),6);{var F=R=>{var $=Cc();he("click",$,function(...re){u()?.apply(this,re)}),z(R,$)};me(A,R=>{u()&&R(F)})}z(B,S)};me(m,B=>{We(a()),ce(()=>a().length>0)?B(g):B(y,!1)})}z(r,h),Dt()}async function Oc(r,n=800,a=800,l=.8){return new Promise((f,u)=>{const h=new FileReader;h.onload=m=>{const g=new Image;g.onload=()=>{try{const y=document.createElement("canvas"),B=y.getContext("2d");let{width:S,height:A}=g;S>A?S>n&&(A=A*n/S,S=n):A>a&&(S=S*a/A,A=a),y.width=S,y.height=A,B.drawImage(g,0,0,S,A),y.toBlob(F=>{F?(console.log(`â Image compressed: ${(r.size/1024).toFixed(1)}KB â ${(F.size/1024).toFixed(1)}KB`),f(F)):y.toBlob(R=>{R?(console.log(`â Image compressed (JPEG): ${(r.size/1024).toFixed(1)}KB â ${(R.size/1024).toFixed(1)}KB`),f(R)):u(new Error("Failed to compress image"))},"image/jpeg",l)},"image/webp",l)}catch(y){u(y)}},g.onerror=()=>{u(new Error("Failed to load image"))},g.src=m.target.result},h.onerror=()=>{u(new Error("Failed to read file"))},h.readAsDataURL(r)})}function Pc(r){return r&&["image/jpeg","image/png","image/gif","image/webp"].includes(r.type)}function Bc(r){return new Promise((n,a)=>{const l=new FileReader;l.onload=()=>{n(l.result)},l.onerror=()=>{a(new Error("Failed to read blob"))},l.readAsDataURL(r)})}var Dc=J('<div class="absolute inset-0 bg-black bg-opacity-50 rounded-lg flex items-center justify-center"><div class="text-white text-center"><svg class="animate-spin h-8 w-8 mx-auto mb-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-sm">Compressing...</p></div></div>'),Mc=J('<div class="relative"><img alt="Selected" class="w-full h-48 object-cover rounded-lg border border-gray-300"/> <button type="button" class="absolute top-2 right-2 p-2 bg-red-600 hover:bg-red-700 text-white rounded-lg shadow-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed" title="Remove photo"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button> <!></div>'),jc=J('<svg class="animate-spin h-8 w-8 text-indigo-600 mb-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-sm text-gray-600">Compressing image...</p>',1),Rc=J('<svg class="w-12 h-12 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <p class="text-sm font-medium text-gray-700 mb-1">Add a photo</p> <p class="text-xs text-gray-500">Click to upload or take a photo</p> <p class="text-xs text-gray-400 mt-1">JPEG, PNG, GIF, or WebP (max 10MB)</p>',1),Tc=J('<button type="button" class="w-full flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button>'),Ic=J('<div class="p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm flex items-start"><svg class="w-5 h-5 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg> <span> </span></div>'),Fc=J('<div class="space-y-3"><input type="file" accept="image/jpeg,image/png,image/gif,image/webp" capture="environment" class="hidden"/> <!> <!></div>');function Kc(r,n){Bt(n,!1);let a=Pe(n,"imageBlob",8,null),l=Pe(n,"disabled",8,!1);const f=Cn();let u=ie(),h=ie(!1),m=ie(null),g=ie(null);async function y(){if(a())try{T(m,await Bc(a()))}catch(X){console.error("Failed to create preview:",X)}}async function B(X){const ae=X.target.files?.[0];ae&&(await S(ae),p(u)&&It(u,p(u).value=""))}async function S(X){if(T(g,null),!Pc(X)){T(g,"Please select a valid image file (JPEG, PNG, GIF, or WebP)");return}if(X.size>10*1024*1024){T(g,"Image is too large (max 10MB)");return}T(h,!0);try{const ae=await Oc(X);ae.size>500*1024&&console.warn("Compressed image is larger than 500KB:",(ae.size/1024).toFixed(1)+"KB"),f("change",ae)}catch(ae){console.error("Failed to compress image:",ae),T(g,"Failed to compress image. Please try another image.")}finally{T(h,!1)}}function A(){f("change",null),T(g,null)}function F(){p(u)&&!l()&&p(u).click()}ht(()=>We(a()),()=>{a()?y():T(m,null)}),wn(),Kt();var R=Fc(),$=M(R);Ii($,X=>T(u,X),()=>p(u));var re=K($,2);{var ue=X=>{var ae=Mc(),ve=M(ae),le=K(ve,2),Be=K(le,2);{var Ie=Fe=>{var Ue=Dc();z(Fe,Ue)};me(Be,Fe=>{p(h)&&Fe(Ie)})}Ae(()=>{$r(ve,"src",p(m)),le.disabled=l()||p(h)}),he("click",le,A),z(X,ae)},de=X=>{var ae=Tc(),ve=M(ae);{var le=Ie=>{var Fe=jc();z(Ie,Fe)},Be=Ie=>{var Fe=Rc();z(Ie,Fe)};me(ve,Ie=>{p(h)?Ie(le):Ie(Be,!1)})}Ae(()=>ae.disabled=l()||p(h)),he("click",ae,F),z(X,ae)};me(re,X=>{p(m)?X(ue):X(de,!1)})}var ge=K(re,2);{var _e=X=>{var ae=Ic(),ve=K(M(ae),2),le=M(ve);Ae(()=>Se(le,p(g))),z(X,ae)};me(ge,X=>{p(g)&&X(_e)})}Ae(()=>$.disabled=l()),he("change",$,B),z(r,R),Dt()}let Nc=class{constructor(){this.mediaRecorder=null,this.audioChunks=[],this.stream=null,this.startTime=null,this.duration=0}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:24e3,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});const n=this.getSupportedMimeType();if(!n)throw new Error("No supported audio format found");this.mediaRecorder=new MediaRecorder(this.stream,{mimeType:n,audioBitsPerSecond:32e3}),this.audioChunks=[],this.mediaRecorder.ondataavailable=a=>{a.data.size>0&&this.audioChunks.push(a.data)},this.mediaRecorder.start(),this.startTime=Date.now(),console.log("â Recording started:",n)}catch(n){throw console.error("Failed to start recording:",n),this.cleanup(),n}}async stop(){return new Promise((n,a)=>{if(!this.mediaRecorder||this.mediaRecorder.state==="inactive"){a(new Error("No active recording"));return}this.mediaRecorder.onstop=()=>{try{this.duration=Date.now()-this.startTime;const l=this.mediaRecorder.mimeType,f=new Blob(this.audioChunks,{type:l});console.log(`â Recording stopped: ${(f.size/1024).toFixed(1)}KB, ${(this.duration/1e3).toFixed(1)}s`),this.cleanup(),n(f)}catch(l){a(l)}},this.mediaRecorder.onerror=l=>{console.error("MediaRecorder error:",l),this.cleanup(),a(l)},this.mediaRecorder.stop()})}getSupportedMimeType(){const n=["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/mp4","audio/mpeg"];for(const a of n)if(MediaRecorder.isTypeSupported(a))return a;return null}isRecording(){return this.mediaRecorder&&this.mediaRecorder.state==="recording"}getDuration(){return this.isRecording()?Date.now()-this.startTime:this.duration}cleanup(){this.stream&&(this.stream.getTracks().forEach(n=>n.stop()),this.stream=null),this.mediaRecorder=null,this.audioChunks=[]}};function Lc(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&typeof MediaRecorder<"u")}function Ia(r){const n=Math.floor(r/1e3),a=Math.floor(n/60),l=n%60;return`${a}:${l.toString().padStart(2,"0")}`}function Fa(r){return URL.createObjectURL(r)}var qc=J(`<div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-800 text-sm"><p class="font-medium mb-1">Audio recording not supported</p> <p>Your browser doesn't support audio recording. Please use a modern browser like Chrome, Firefox, or Safari.</p></div>`),zc=Et('<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>'),Uc=Et('<svg class="w-5 h-5 ml-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>'),Vc=J('<div class="p-4 bg-gray-50 rounded-lg border border-gray-300"><div class="flex items-center justify-between mb-3"><div class="flex items-center text-sm text-gray-700"><svg class="w-5 h-5 text-purple-600 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"></path></svg> <span class="font-medium">Audio recorded</span></div> <button type="button" class="text-red-600 hover:text-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed">Remove</button></div> <audio class="hidden"></audio> <div class="flex items-center gap-3"><button type="button" class="flex-shrink-0 w-10 h-10 bg-purple-600 hover:bg-purple-700 text-white rounded-full flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed transition-colors"><!></button> <div class="flex-1 text-sm text-gray-600"><p>Click play to preview your recording</p></div></div></div>'),$c=J('<div class="p-6 bg-red-50 border-2 border-red-300 rounded-lg"><div class="flex flex-col items-center"><div class="relative mb-4"><div class="w-16 h-16 bg-red-600 rounded-full animate-pulse flex items-center justify-center"><svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z" clip-rule="evenodd"></path></svg></div></div> <div class="text-3xl font-bold text-red-900 mb-2 font-mono"> </div> <p class="text-sm text-red-700 mb-4">Recording...</p> <button type="button" class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors">Stop Recording</button></div></div>'),Hc=J('<button type="button" class="w-full flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><svg class="w-12 h-12 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg> <p class="text-sm font-medium text-gray-700 mb-1">Record audio</p> <p class="text-xs text-gray-500">Click to start recording</p></button>'),Yc=J('<div class="p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm flex items-start"><svg class="w-5 h-5 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg> <span> </span></div>'),Wc=J('<div class="space-y-3"><!> <!></div>');function Gc(r,n){Bt(n,!1);let a=Pe(n,"audioBlob",8,null),l=Pe(n,"disabled",8,!1);const f=Cn();let u=null,h=ie(!1),m=ie(0),g=null,y=ie(null),B=ie(null),S=ie(),A=ie(!1);const F=Lc();js(()=>{$(),p(y)&&URL.revokeObjectURL(p(y))});async function R(){if(T(B,null),!F){T(B,"Audio recording is not supported in this browser");return}try{u=new Nc,await u.start(),T(h,!0),T(m,0),g=setInterval(()=>{u&&T(m,u.getDuration())},100)}catch(ee){console.error("Failed to start recording:",ee),ee.name==="NotAllowedError"||ee.name==="PermissionDeniedError"?T(B,"Microphone permission denied. Please allow microphone access and try again."):ee.name==="NotFoundError"?T(B,"No microphone found. Please connect a microphone and try again."):T(B,"Failed to start recording. Please try again."),T(h,!1),u&&(u.cleanup(),u=null)}}async function $(){if(u){try{const ee=await u.stop();g&&(clearInterval(g),g=null),T(h,!1),f("change",ee)}catch(ee){console.error("Failed to stop recording:",ee),T(B,"Failed to save recording. Please try again."),T(h,!1)}u=null}}function re(){p(y)&&(URL.revokeObjectURL(p(y)),T(y,null)),f("change",null),T(B,null),T(A,!1)}function ue(){p(S)&&(p(A)?p(S).pause():p(S).play())}function de(){T(A,!0)}function ge(){T(A,!1)}function _e(){T(A,!1)}ht(()=>(We(a()),p(y),Fa),()=>{a()&&(p(y)&&URL.revokeObjectURL(p(y)),T(y,Fa(a())))}),wn(),Kt();var X=Wc(),ae=M(X);{var ve=ee=>{var xe=qc();z(ee,xe)},le=ee=>{var xe=Vc(),De=M(xe),Oe=K(M(De),2),He=K(De,2);Ii(He,se=>T(S,se),()=>p(S));var Ve=K(He,2),ke=M(Ve),Ke=M(ke);{var at=se=>{var Ce=zc();z(se,Ce)},q=se=>{var Ce=Uc();z(se,Ce)};me(Ke,se=>{p(A)?se(at):se(q,!1)})}Ae(()=>{Oe.disabled=l(),$r(He,"src",p(y)),ke.disabled=l()}),he("click",Oe,re),he("play",He,de),he("pause",He,ge),he("ended",He,_e),he("click",ke,ue),z(ee,xe)},Be=ee=>{var xe=$c(),De=M(xe),Oe=K(M(De),2),He=M(Oe),Ve=K(Oe,4);Ae(ke=>Se(He,ke),[()=>(We(Ia),p(m),ce(()=>Ia(p(m))))]),he("click",Ve,$),z(ee,xe)},Ie=ee=>{var xe=Hc();Ae(()=>xe.disabled=l()),he("click",xe,R),z(ee,xe)};me(ae,ee=>{F?p(y)?ee(le,1):p(h)?ee(Be,2):ee(Ie,!1):ee(ve)})}var Fe=K(ae,2);{var Ue=ee=>{var xe=Yc(),De=K(M(xe),2),Oe=M(De);Ae(()=>Se(Oe,p(B))),z(ee,xe)};me(Fe,ee=>{p(B)&&ee(Ue)})}z(r,X),Dt()}var Xc=J('<div class="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"> </div>'),Qc=J('<p class="text-sm text-red-600"> </p>'),Jc=J('<p class="text-xs text-gray-500">ð¡ Tip: You can use multiple lines to separate question and answer</p>'),Zc=Et('<svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Saving...',1),ef=J('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center p-4 z-50 overflow-y-auto" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[85dvh] overflow-y-auto my-auto"><div class="flex items-center justify-between p-6 border-b border-gray-200"><h2 id="modal-title" class="text-2xl font-semibold text-gray-900"> </h2> <button class="p-2 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors" aria-label="Close"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6"><!> <div class="mb-6"><label for="card-text" class="block text-sm font-medium text-gray-700 mb-2">Card Content <span class="text-red-500">*</span></label> <textarea id="card-text" placeholder="Enter the card content (e.g., question on one line, answer on another)  Example: What is the capital of France? Paris" maxlength="5000" rows="10"></textarea> <div class="flex items-center justify-between mt-1"><!> <p class="text-xs text-gray-400"> </p></div></div> <div class="mb-6"><label class="block text-sm font-medium text-gray-700 mb-2">Photo <span class="text-gray-400 text-xs">(optional)</span></label> <!></div> <div class="mb-6"><label class="block text-sm font-medium text-gray-700 mb-2">Audio <span class="text-gray-400 text-xs">(optional)</span></label> <!></div> <div class="flex gap-3"><button type="button" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Cancel</button> <button type="submit" class="flex-1 px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"><!></button></div></form></div></div>');function tf(r,n){Bt(n,!1);const a=ie(),l=ie(),f=ie();let u=Pe(n,"card",8,null),h=Pe(n,"isOpen",8,!1);const m=Cn();let g=ie(u()?.text||""),y=ie(u()?.imageBlob||null),B=ie(u()?.audioBlob||null),S=ie(!1),A=ie({});function F(){u()||(T(g,""),T(y,null),T(B,null)),T(A,{}),T(S,!1)}function R(le){T(y,le.detail)}function $(le){T(B,le.detail)}function re(){return T(A,{}),p(g).trim()?p(g).trim().length>5e3&&It(A,p(A).text="Card text must be 5000 characters or less"):It(A,p(A).text="Card text is required"),Object.keys(p(A)).length===0}async function ue(){if(re()){T(S,!0);try{const le={text:p(g).trim(),imageBlob:p(y),audioBlob:p(B)};p(a)?m("update",{id:u().id,...le}):m("create",le),de()}catch(le){console.error("Failed to submit:",le),It(A,p(A).general="Failed to save card. Please try again.")}finally{T(S,!1)}}}function de(){m("close"),F()}function ge(le){le.target===le.currentTarget&&de()}function _e(le){le.key==="Escape"&&de()}ht(()=>We(u()),()=>{u()&&(T(g,u().text||""),T(y,u().imageBlob||null),T(B,u().audioBlob||null))}),ht(()=>We(h()),()=>{h()||F()}),ht(()=>We(u()),()=>{T(a,u()!==null)}),ht(()=>p(a),()=>{T(l,p(a)?"Edit Card":"New Card")}),ht(()=>p(a),()=>{T(f,p(a)?"Save Changes":"Add Card")}),wn(),Kt();var X=Bo(),ae=Pr(X);{var ve=le=>{var Be=ef(),Ie=M(Be),Fe=M(Ie),Ue=M(Fe),ee=M(Ue),xe=K(Ue,2),De=K(Fe,2),Oe=M(De);{var He=Z=>{var we=Xc(),be=M(we);Ae(()=>Se(be,(p(A),ce(()=>p(A).general)))),z(Z,we)};me(Oe,Z=>{p(A),ce(()=>p(A).general)&&Z(He)})}var Ve=K(Oe,2),ke=K(M(Ve),2);let Ke;var at=K(ke,2),q=M(at);{var se=Z=>{var we=Qc(),be=M(we);Ae(()=>Se(be,(p(A),ce(()=>p(A).text)))),z(Z,we)},Ce=Z=>{var we=Jc();z(Z,we)};me(q,Z=>{p(A),ce(()=>p(A).text)?Z(se):Z(Ce,!1)})}var Qe=K(q,2),ct=M(Qe),fe=K(Ve,2),Me=K(M(fe),2);Kc(Me,{get imageBlob(){return p(y)},get disabled(){return p(S)},$$events:{change:R}});var ft=K(fe,2),W=K(M(ft),2);Gc(W,{get audioBlob(){return p(B)},get disabled(){return p(S)},$$events:{change:$}});var Xe=K(ft,2),pe=M(Xe),st=K(pe,2),St=M(st);{var vt=Z=>{var we=Zc();z(Z,we)},V=Z=>{var we=As();Ae(()=>Se(we,p(f))),z(Z,we)};me(St,Z=>{p(S)?Z(vt):Z(V,!1)})}Ae(()=>{Se(ee,p(l)),Ke=Dr(ke,1,"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-colors resize-y font-mono text-base",null,Ke,{"border-red-500":p(A).text}),ke.disabled=p(S),Se(ct,`${p(g),ce(()=>p(g).length)??""}/5000`),pe.disabled=p(S),st.disabled=p(S)}),he("click",xe,de),Ci(ke,()=>p(g),Z=>T(g,Z)),he("click",pe,de),he("submit",De,Bs(ue)),he("click",Be,ge),he("keydown",Be,_e),z(le,Be)};me(ae,le=>{h()&&le(ve)})}z(r,X),Dt()}var rf=J('<div class="flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3"><svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div>'),nf=J('<div class="flex-shrink-0 w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center mr-3"><svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>'),of=J('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" role="dialog" aria-modal="true" aria-labelledby="dialog-title" tabindex="-1"><div class="bg-white rounded-lg shadow-xl max-w-md w-full"><div class="p-6 border-b border-gray-200"><div class="flex items-center"><!> <h2 id="dialog-title" class="text-xl font-semibold text-gray-900"> </h2></div></div> <div class="p-6"><p class="text-gray-600"> </p></div> <div class="p-6 pt-0 flex gap-3"><button type="button" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors"> </button> <button type="button"> </button></div></div></div>');function Rs(r,n){Bt(n,!1);let a=Pe(n,"isOpen",8,!1),l=Pe(n,"title",8,"Confirm"),f=Pe(n,"message",8,"Are you sure?"),u=Pe(n,"confirmLabel",8,"Confirm"),h=Pe(n,"cancelLabel",8,"Cancel"),m=Pe(n,"isDanger",8,!1);const g=Cn();function y(){g("confirm"),B()}function B(){g("cancel")}function S(re){re.target===re.currentTarget&&B()}function A(re){re.key==="Escape"&&B()}Kt();var F=Bo(),R=Pr(F);{var $=re=>{var ue=of(),de=M(ue),ge=M(de),_e=M(ge),X=M(_e);{var ae=ke=>{var Ke=rf();z(ke,Ke)},ve=ke=>{var Ke=nf();z(ke,Ke)};me(X,ke=>{m()?ke(ae):ke(ve,!1)})}var le=K(X,2),Be=M(le),Ie=K(ge,2),Fe=M(Ie),Ue=M(Fe),ee=K(Ie,2),xe=M(ee),De=M(xe),Oe=K(xe,2);let He;var Ve=M(Oe);Ae(()=>{Se(Be,l()),Se(Ue,f()),Se(De,h()),He=Dr(Oe,1,"flex-1 px-4 py-2 font-medium rounded-lg transition-colors",null,He,{"bg-red-600":m(),"hover:bg-red-700":m(),"bg-indigo-600":!m(),"hover:bg-indigo-700":!m(),"text-white":!0}),Se(Ve,u())}),he("click",xe,B),he("click",Oe,y),he("click",ue,S),he("keydown",ue,A),z(re,ue)};me(R,re=>{a()&&re($)})}z(r,F),Dt()}let Fn=null;function Ts(){if(typeof window>"u"||!window.visualViewport||window.visualViewport.scale===1)return;const r=document.querySelector('meta[name="viewport"]');if(!r)return;Fn!==null&&(cancelAnimationFrame(Fn),Fn=null);const n=r.getAttribute("content");r.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0"),window.scrollTo(0,0),Fn=requestAnimationFrame(()=>{r.setAttribute("content",n),Fn=null})}var af=J('<div class="mb-6"><img alt="" class="max-w-full max-h-64 mx-auto rounded-lg shadow-lg object-contain"/></div>'),sf=J('<div class="mb-6 w-full max-w-md mx-auto" role="none"><audio controls="" class="w-full"></audio></div>'),lf=J('<div class="text-gray-500 text-sm mb-4 uppercase tracking-wide">Question</div> <p class="text-xl sm:text-3xl text-gray-900 whitespace-pre-wrap leading-relaxed"> </p> <div class="mt-8 text-indigo-600 text-sm"><svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path></svg> Click or press Space to reveal answer</div>',1),uf=J('<div class="text-gray-500 text-sm mb-4 uppercase tracking-wide">Answer</div> <p class="text-xl sm:text-3xl text-gray-900 whitespace-pre-wrap leading-relaxed"> </p> <div class="mt-8 text-green-600 text-sm"><svg class="w-5 h-5 inline-block mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> Click or press Space to see question again</div>',1),cf=J('<div class="text-center w-full"><!></div>'),ff=J('<div class="text-center w-full"><p class="text-xl sm:text-3xl text-gray-900 whitespace-pre-wrap leading-relaxed"> </p></div>'),df=J('<div class="relative"><div class="bg-white rounded-2xl shadow-2xl p-6 sm:p-12 min-h-[200px] sm:min-h-[400px] flex flex-col items-center justify-center cursor-pointer active:scale-[0.98] transition-transform touch-pan-y" role="button" tabindex="0"><!> <!> <!></div> <div class="absolute -top-4 left-1/2 -translate-x-1/2 bg-indigo-600 text-white px-4 py-2 rounded-full text-sm font-medium shadow-lg"> </div></div>'),vf=J('<div class="text-center text-white"><p class="text-xl">No cards to study</p></div>'),hf=J('<div class="fixed inset-0 bg-gradient-to-br from-indigo-900 to-purple-900 z-50 flex flex-col"><header class="bg-black bg-opacity-30 backdrop-blur-sm border-b border-white border-opacity-10"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex items-center justify-between"><div class="flex items-center gap-4"><button class="p-2 text-white hover:bg-white hover:bg-opacity-10 rounded-lg transition-colors" aria-label="Exit study mode"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <div class="text-white"><h1 class="text-lg font-semibold"> </h1> <p class="text-sm text-indigo-200">Study Mode</p></div></div> <div class="text-white text-right"><div class="text-2xl font-bold"> </div> <div class="text-sm text-indigo-200">Cards</div></div></div></div></header> <div class="flex-1 flex items-center justify-center p-8"><div class="max-w-4xl w-full"><!></div></div> <div class="bg-black bg-opacity-30 backdrop-blur-sm border-t border-white border-opacity-10 p-6"><div class="max-w-4xl mx-auto flex items-center justify-between"><button class="flex items-center gap-2 px-6 py-3 bg-white bg-opacity-10 hover:bg-opacity-20 disabled:bg-opacity-5 text-white rounded-lg transition-colors disabled:cursor-not-allowed disabled:text-opacity-30"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg> <span class="font-medium">Previous</span></button> <div class="text-center text-white text-sm space-y-1"><div class="keyboard-hints svelte-q1k6k"><div class="text-indigo-200 text-xs mb-1">Keyboard Shortcuts</div> <div class="flex gap-4 text-xs text-white opacity-70"><span>â â Navigate</span> <span>Space/Enter Flip</span> <span>Esc Exit</span></div></div> <div class="touch-hints text-xs text-indigo-200 opacity-80 svelte-q1k6k">Swipe left/right to navigate Â· Tap to flip</div></div> <button class="flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 disabled:bg-opacity-30 text-white rounded-lg transition-colors disabled:cursor-not-allowed font-medium"><span>Next</span> <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button></div></div></div>');function pf(r,n){Bt(n,!1);const a=()=>Do(Cr,"$cards",l),[l,f]=Mo(),u=ie(),h=ie(),m=ie(),g=ie(),y=ie(),B=ie();Pe(n,"collectionId",8);let S=Pe(n,"collectionName",8,""),A=Pe(n,"onExit",8),F=ie(0),R=ie([]),$=new Set,re=ie(!0),ue=ie(null),de=ie(null);const ge=new Map;function _e(V){if(!V){T(ue,null),T(de,null);return}ge.has(V.id)||ge.set(V.id,{imageUrl:V.imageBlob?URL.createObjectURL(V.imageBlob):null,audioUrl:V.audioBlob?URL.createObjectURL(V.audioBlob):null});const Z=ge.get(V.id);T(ue,Z.imageUrl),T(de,Z.audioUrl)}jo(async()=>{if(T(R,[...a()]),p(R).length===0){A()();return}_e(p(R)[0]),X()}),js(()=>{for(const{imageUrl:V,audioUrl:Z}of ge.values())V&&URL.revokeObjectURL(V),Z&&URL.revokeObjectURL(Z);ge.clear(),Ts()});function X(){!p(u)||$.has(p(u).id)||($.add(p(u).id),Cr.markAsReviewed(p(u).id))}function ae(){p(m)&&(_a(F,-1),T(re,!0),_e(p(R)[p(F)]),X())}function ve(){p(g)&&(_a(F),T(re,!0),_e(p(R)[p(F)]),X())}function le(){T(re,!p(re))}function Be(V){switch(V.key){case"ArrowLeft":V.preventDefault(),ae();break;case"ArrowRight":V.preventDefault(),ve();break;case" ":case"Enter":V.preventDefault(),le();break;case"Escape":V.preventDefault(),A()();break}}function Ie(){A()()}function Fe(V){const Z=V.split(`
`).filter(be=>be.trim());if(Z.length<=1)return{front:V,back:null};const we=Math.ceil(Z.length/2);return{front:Z.slice(0,we).join(`
`),back:Z.slice(we).join(`
`)}}let Ue=0;function ee(V){Ue=V.changedTouches[0].clientX}function xe(V){const Z=V.changedTouches[0].clientX-Ue,we=50;Z>we?ae():Z<-we?ve():le()}ht(()=>(p(R),p(F)),()=>{T(u,p(R)[p(F)])}),ht(()=>(p(R),p(F)),()=>{T(h,p(R).length>0?`${p(F)+1} / ${p(R).length}`:"0 / 0")}),ht(()=>p(F),()=>{T(m,p(F)>0)}),ht(()=>(p(F),p(R)),()=>{T(g,p(F)<p(R).length-1)}),ht(()=>p(u),()=>{T(y,p(u)&&p(u).text.split(`
`).filter(V=>V.trim()).length>1)}),ht(()=>p(u),()=>{T(B,p(u)?Fe(p(u).text):{front:"",back:null})}),wn(),Kt();var De=hf();he("keydown",zn,Be);var Oe=M(De),He=M(Oe),Ve=M(He),ke=M(Ve),Ke=M(ke),at=K(Ke,2),q=M(at),se=M(q),Ce=K(ke,2),Qe=M(Ce),ct=M(Qe),fe=K(Oe,2),Me=M(fe),ft=M(Me);{var W=V=>{var Z=Bo(),we=Pr(Z);wu(we,()=>(p(u),ce(()=>p(u).id)),be=>{var Ne=df(),Le=M(Ne),xt=M(Le);{var kt=nt=>{var dt=af(),Nt=M(dt);Ae(()=>$r(Nt,"src",p(ue))),z(nt,dt)};me(xt,nt=>{p(ue)&&nt(kt)})}var mt=K(xt,2);{var Mt=nt=>{var dt=sf(),Nt=M(dt);Ae(()=>$r(Nt,"src",p(de))),he("click",dt,Fi(function(ir){Du.call(this,n,ir)})),z(nt,dt)};me(mt,nt=>{p(de)&&nt(Mt)})}var rt=K(mt,2);{var jt=nt=>{var dt=cf(),Nt=M(dt);{var ir=oe=>{var Yt=lf(),Wt=K(Pr(Yt),2),pr=M(Wt);Ae(()=>Se(pr,(p(B),ce(()=>p(B).front)))),z(oe,Yt)},Zt=oe=>{var Yt=uf(),Wt=K(Pr(Yt),2),pr=M(Wt);Ae(()=>Se(pr,(p(B),ce(()=>p(B).back)))),z(oe,Yt)};me(Nt,oe=>{p(re)?oe(ir):oe(Zt,!1)})}z(nt,dt)},En=nt=>{var dt=ff(),Nt=M(dt),ir=M(Nt);Ae(()=>Se(ir,(p(u),ce(()=>p(u).text)))),z(nt,dt)};me(rt,nt=>{p(y),p(B),ce(()=>p(y)&&p(B).back)?nt(jt):nt(En,!1)})}var Mr=K(Le,2),Sn=M(Mr);Ae(()=>Se(Sn,`Card ${p(F)+1}`)),he("click",Le,le),he("touchstart",Le,ee),he("touchend",Le,xe),he("keydown",Le,nt=>(nt.key==="Enter"||nt.key===" ")&&le()),z(be,Ne)}),z(V,Z)},Xe=V=>{var Z=vf();z(V,Z)};me(ft,V=>{p(u)?V(W):V(Xe,!1)})}var pe=K(fe,2),st=M(pe),St=M(st),vt=K(St,4);Ae(()=>{Se(se,S()),Se(ct,p(h)),St.disabled=!p(m),vt.disabled=!p(g)}),he("click",Ke,Ie),he("click",St,ae),he("click",vt,ve),z(r,De),Dt(),f()}const wo="1.0";async function xo(r){return new Promise((n,a)=>{const l=new FileReader;l.onloadend=()=>{n({type:r.type,data:l.result})},l.onerror=()=>{a(new Error("Failed to read blob"))},l.readAsDataURL(r)})}function Ka(r){if(!r||!r.data)return null;try{const{type:n,data:a}=r,l=atob(a.split(",")[1]),f=new ArrayBuffer(l.length),u=new Uint8Array(f);for(let h=0;h<l.length;h++)u[h]=l.charCodeAt(h);return new Blob([f],{type:n})}catch(n){return console.error("Failed to convert base64 to blob:",n),null}}async function mf(r){try{const n=await Ge.collections.get(r);if(!n)throw new Error("Collection not found");const a=await Ge.cards.where("collectionId").equals(r).toArray();console.log(`ð¦ Exporting collection "${n.name}" with ${a.length} cards...`);const l=await Promise.all(a.map(async m=>({...m,imageBlob:m.imageBlob?await xo(m.imageBlob):null,audioBlob:m.audioBlob?await xo(m.audioBlob):null}))),f={version:wo,exportDate:new Date().toISOString(),collections:[{...n,cards:l}]},u=new Date().toISOString().split("T")[0],h=`${n.name.replace(/[^a-z0-9]/gi,"_")}_${u}.json`;Is(f,h),console.log("â Export completed")}catch(n){throw console.error("Failed to export collection:",n),n}}async function gf(){try{const r=await Ge.collections.toArray();if(r.length===0)throw new Error("No collections to export");console.log(`ð¦ Exporting all ${r.length} collections...`);const n=await Promise.all(r.map(async u=>{const h=await Ge.cards.where("collectionId").equals(u.id).toArray(),m=await Promise.all(h.map(async g=>({...g,imageBlob:g.imageBlob?await xo(g.imageBlob):null,audioBlob:g.audioBlob?await xo(g.audioBlob):null})));return{...u,cards:m}})),a={version:wo,exportDate:new Date().toISOString(),collections:n},f=`memoria_backup_${new Date().toISOString().split("T")[0]}.json`;Is(a,f),console.log("â Export completed")}catch(r){throw console.error("Failed to export all collections:",r),r}}async function yf(r,n="merge"){try{const a=await r.text(),l=JSON.parse(a);if(!l.version||!l.collections||!Array.isArray(l.collections))throw new Error("Invalid export file format");l.version!==wo&&console.warn(`Export version mismatch: ${l.version} vs ${wo}`),console.log(`ð¥ Importing ${l.collections.length} collection(s) with strategy: ${n}`);let f=0,u=0,h=0;for(const g of l.collections){const{cards:y,...B}=g;if(await Ge.collections.get(g.id))if(n==="merge"){u++,console.log(`â­ï¸ Skipped existing collection: ${g.name}`);continue}else n==="replace"&&(await Ge.cards.where("collectionId").equals(g.id).delete(),h++,console.log(`ð Replaced collection: ${g.name}`));else f++;if(await Ge.collections.put(B),y&&Array.isArray(y))for(const A of y){const F={...A,imageBlob:A.imageBlob?Ka(A.imageBlob):null,audioBlob:A.audioBlob?Ka(A.audioBlob):null};await Ge.cards.put(F)}}const m={imported:f,skipped:u,updated:h,total:l.collections.length};return console.log("â Import completed:",m),m}catch(a){throw console.error("Failed to import collections:",a),a}}function Is(r,n){const a=JSON.stringify(r,null,2),l=new Blob([a],{type:"application/json"}),f=URL.createObjectURL(l),u=document.createElement("a");u.href=f,u.download=n,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(f)}async function bf(r){try{const n=await r.text(),a=JSON.parse(n);return a.version?!a.collections||!Array.isArray(a.collections)?{valid:!1,error:"Missing or invalid collections field"}:a.collections.length===0?{valid:!1,error:"No collections in file"}:{valid:!0,version:a.version,collectionsCount:a.collections.length,exportDate:a.exportDate}:{valid:!1,error:"Missing version field"}}catch(n){return{valid:!1,error:n.message||"Invalid JSON file"}}}var _f=J('<p class="text-sm text-gray-600 mt-1 line-clamp-1"> </p>'),wf=J('<div class="min-w-0"><h1 class="text-2xl font-bold text-gray-900 truncate"> </h1> <!></div>'),xf=Et('<svg class="animate-spin h-5 w-5 sm:mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),kf=Et('<svg class="w-5 h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>'),Cf=J('<div class="flex flex-wrap gap-2"><button class="inline-flex items-center min-h-[44px] px-3 py-2 text-gray-700 hover:bg-gray-100 font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed" aria-label="Export collection"><!> <span class="hidden sm:inline">Export</span></button> <button class="inline-flex items-center min-h-[44px] px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors shadow-sm" aria-label="Study cards"><svg class="w-5 h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg> <span class="hidden sm:inline">Study</span></button> <button class="inline-flex items-center min-h-[44px] px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors shadow-sm" aria-label="Add card"><svg class="w-5 h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> <span class="hidden sm:inline">Add Card</span></button></div>'),Ef=J('<div class="flex flex-wrap items-center gap-4 sm:gap-6 mt-4 pt-4 border-t border-gray-100 text-sm text-gray-600"><div class="flex items-center"><svg class="w-4 h-4 mr-2 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg> <span class="font-medium"> </span> <span class="ml-1">cards</span></div> <div class="flex items-center"><svg class="w-4 h-4 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div></div>'),Sf=Et('<svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'),Af=Et('<svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>'),Of=J('<div class="fixed top-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-md z-50 animate-slide-in svelte-1e2lypv"><div><div class="flex items-center"><!> <p class="text-gray-900 font-medium"> </p></div></div></div>'),Pf=J('<div class="flex items-center justify-center py-16"><svg class="animate-spin h-8 w-8 text-indigo-600" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div>'),Bf=J('<div class="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50"><header class="bg-white shadow-sm border-b border-gray-200"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex flex-col gap-3"><div class="flex items-center gap-4"><button class="p-3 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0" aria-label="Back to collections"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></button> <!></div> <!></div> <!></div></header> <!> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!></div></div> <!> <!> <!>',1);function Df(r,n){Bt(n,!1);const a=()=>Do(Cr,"$cards",l),[l,f]=Mo();let u=Pe(n,"collectionId",8),h=Pe(n,"onBack",8),m=ie(null),g=ie(!0),y=ie(!1),B=ie(null),S=ie(!1),A=ie(null),F=ie(!1),R=ie(!1),$=ie({show:!1,message:"",type:"success"});jo(async()=>{await re()});async function re(){T(g,!0);try{if(T(m,await cr.getById(u())),!p(m)){console.error("Collection not found:",u()),h()();return}await Cr.load(u())}catch(V){console.error("Failed to load collection:",V),ue("Failed to load collection","error")}finally{T(g,!1)}}function ue(V,Z="success"){T($,{show:!0,message:V,type:Z}),setTimeout(()=>{It($,p($).show=!1)},3e3)}function de(){T(B,null),T(y,!0)}function ge(V){T(B,V),T(y,!0)}function _e(V){T(A,V),T(S,!0)}async function X(V){try{await Cr.create(u(),V.detail),ue("Card added successfully!")}catch{ue("Failed to add card","error")}}async function ae(V){try{const{id:Z,...we}=V.detail;await Cr.update(Z,we),ue("Card updated successfully!")}catch{ue("Failed to update card","error")}}async function ve(){if(p(A))try{await Cr.delete(p(A).id,u()),ue("Card deleted successfully!"),T(A,null)}catch{ue("Failed to delete card","error")}}function le(){T(y,!1),T(B,null)}function Be(){T(S,!1),T(A,null)}function Ie(){if(a().length===0){ue("Add some cards first before studying!","error");return}T(F,!0)}function Fe(){Ts(),T(F,!1),Cr.load(u())}async function Ue(){if(a().length===0){ue("No cards to export","error");return}T(R,!0);try{await mf(u()),ue("Collection exported successfully!")}catch(V){console.error("Export failed:",V),ue("Failed to export collection","error")}finally{T(R,!1)}}Kt();var ee=Bf(),xe=Pr(ee),De=M(xe),Oe=M(De),He=M(Oe),Ve=M(He),ke=M(Ve),Ke=K(ke,2);{var at=V=>{var Z=wf(),we=M(Z),be=M(we),Ne=K(we,2);{var Le=xt=>{var kt=_f(),mt=M(kt);Ae(()=>Se(mt,(p(m),ce(()=>p(m).description)))),z(xt,kt)};me(Ne,xt=>{p(m),ce(()=>p(m).description)&&xt(Le)})}Ae(()=>Se(be,(p(m),ce(()=>p(m).name)))),z(V,Z)};me(Ke,V=>{p(m)&&V(at)})}var q=K(Ve,2);{var se=V=>{var Z=Cf(),we=M(Z),be=M(we);{var Ne=mt=>{var Mt=xf();z(mt,Mt)},Le=mt=>{var Mt=kf();z(mt,Mt)};me(be,mt=>{p(R)?mt(Ne):mt(Le,!1)})}var xt=K(we,2),kt=K(xt,2);Ae(()=>we.disabled=p(R)),he("click",we,Ue),he("click",xt,Ie),he("click",kt,de),z(V,Z)};me(q,V=>{p(g),a(),ce(()=>!p(g)&&a().length>0)&&V(se)})}var Ce=K(He,2);{var Qe=V=>{var Z=Ef(),we=M(Z),be=K(M(we),2),Ne=M(be),Le=K(we,2),xt=K(M(Le),2),kt=M(xt);Ae(mt=>{Se(Ne,(a(),ce(()=>a().length))),Se(kt,`Updated ${mt??""}`)},[()=>(We(gn),p(m),ce(()=>gn(p(m).updatedAt)))]),z(V,Z)};me(Ce,V=>{p(m)&&V(Qe)})}var ct=K(De,2);{var fe=V=>{var Z=Of(),we=M(Z);let be;var Ne=M(we),Le=M(Ne);{var xt=rt=>{var jt=Sf();z(rt,jt)},kt=rt=>{var jt=Af();z(rt,jt)};me(Le,rt=>{p($),ce(()=>p($).type==="success")?rt(xt):rt(kt,!1)})}var mt=K(Le,2),Mt=M(mt);Ae(()=>{be=Dr(we,1,"bg-white rounded-lg shadow-lg border-l-4 p-4",null,be,{"border-green-500":p($).type==="success","border-red-500":p($).type==="error"}),Se(Mt,(p($),ce(()=>p($).message)))}),z(V,Z)};me(ct,V=>{p($),ce(()=>p($).show)&&V(fe)})}var Me=K(ct,2),ft=M(Me);{var W=V=>{var Z=Pf();z(V,Z)},Xe=V=>{Ac(V,{get cards(){return a()},onCreate:de,onEdit:ge,onDelete:_e})};me(ft,V=>{p(g)?V(W):V(Xe,!1)})}var pe=K(xe,2);tf(pe,{get isOpen(){return p(y)},get card(){return p(B)},$$events:{create:X,update:ae,close:le}});var st=K(pe,2);{let V=vn(()=>p(A)?"Are you sure you want to delete this card? This action cannot be undone.":"");Rs(st,{get isOpen(){return p(S)},title:"Delete Card",get message(){return p(V)},confirmLabel:"Delete",cancelLabel:"Cancel",isDanger:!0,$$events:{confirm:ve,cancel:Be}})}var St=K(st,2);{var vt=V=>{{let Z=vn(()=>(p(m),ce(()=>p(m)?.name||"")));pf(V,{get collectionId(){return u()},get collectionName(){return p(Z)},onExit:Fe})}};me(St,V=>{p(F)&&V(vt)})}he("click",ke,function(...V){h()?.apply(this,V)}),z(r,ee),Dt(),f()}var Mf=Et('<svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'),jf=Et('<svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>'),Rf=J('<div class="fixed top-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-md z-50 animate-slide-in svelte-anx9w7"><div><div class="flex items-center"><!> <p class="text-gray-900 font-medium"> </p></div></div></div>'),Tf=Et('<svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Exporting...',1),If=Et('<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> Export All Collections',1),Ff=J('<p class="text-sm text-gray-500 mt-2">No collections to export</p>'),Kf=Et('<svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Importing...',1),Nf=Et('<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg> Import from File',1),Lf=J('<div class="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50"><header class="bg-white shadow-sm border-b border-gray-200"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex items-center gap-4"><button class="p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors" aria-label="Back to home"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></button> <div><h1 class="text-2xl font-bold text-gray-900">Settings</h1> <p class="text-sm text-gray-600">Manage your data and preferences</p></div></div></div></header> <!> <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="bg-white rounded-lg shadow-md p-6 mb-6"><h2 class="text-xl font-semibold text-gray-900 mb-4">Export Data</h2> <p class="text-gray-600 mb-4">Download all your collections, cards, and media as a JSON file. Use this for backup or to transfer your data to another device.</p> <button class="inline-flex items-center px-6 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"><!></button> <!></div> <div class="bg-white rounded-lg shadow-md p-6"><h2 class="text-xl font-semibold text-gray-900 mb-4">Import Data</h2> <p class="text-gray-600 mb-4">Import collections from a previously exported JSON file. Choose how to handle existing collections.</p> <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Import Strategy</label> <div class="space-y-2"><label class="flex items-center"><input type="radio" class="w-4 h-4 text-indigo-600 focus:ring-indigo-500"/> <span class="ml-2 text-sm"><span class="font-medium text-gray-900">Merge</span> <span class="text-gray-600">- Skip collections that already exist</span></span></label> <label class="flex items-center"><input type="radio" class="w-4 h-4 text-indigo-600 focus:ring-indigo-500"/> <span class="ml-2 text-sm"><span class="font-medium text-gray-900">Replace</span> <span class="text-gray-600">- Overwrite collections with matching IDs</span></span></label></div></div> <input type="file" accept=".json,application/json" class="hidden"/> <button class="inline-flex items-center px-6 py-3 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"><!></button> <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"><p class="text-sm text-yellow-800"><strong>Warning:</strong> Using "Replace" strategy will overwrite existing collections with the same ID. Make sure to export your current data first!</p></div></div> <div class="mt-8 text-center text-sm text-gray-500"><p>Memoria v1.0</p> <p class="mt-1">All data is stored locally on your device</p></div></div></div>');function qf(r,n){Bt(n,!1);const a=()=>Do(cr,"$collections",l),[l,f]=Mo(),u=[];let h=Pe(n,"onBack",8);Cn();let m=ie("merge"),g=ie(!1),y=ie(!1),B=ie(),S=ie({show:!1,message:"",type:"success"});function A(fe,Me="success"){T(S,{show:!0,message:fe,type:Me}),setTimeout(()=>{It(S,p(S).show=!1)},4e3)}async function F(){if(a().length===0){A("No collections to export","error");return}T(y,!0);try{await gf(),A(`Exported ${a().length} collection(s) successfully!`)}catch(fe){console.error("Export failed:",fe),A("Failed to export collections","error")}finally{T(y,!1)}}function R(){p(B)&&p(B).click()}async function $(fe){const Me=fe.target.files?.[0];if(!Me)return;const ft=await bf(Me);if(!ft.valid){A(`Invalid file: ${ft.error}`,"error"),p(B)&&It(B,p(B).value="");return}T(g,!0);try{const W=await yf(Me,p(m));await cr.load();const Xe=[];W.imported>0&&Xe.push(`${W.imported} imported`),W.updated>0&&Xe.push(`${W.updated} updated`),W.skipped>0&&Xe.push(`${W.skipped} skipped`),A(`Import successful: ${Xe.join(", ")}`)}catch(W){console.error("Import failed:",W),A(`Failed to import: ${W.message}`,"error")}finally{T(g,!1),p(B)&&It(B,p(B).value="")}}Kt();var re=Lf(),ue=M(re),de=M(ue),ge=M(de),_e=M(ge),X=K(ue,2);{var ae=fe=>{var Me=Rf(),ft=M(Me);let W;var Xe=M(ft),pe=M(Xe);{var st=Z=>{var we=Mf();z(Z,we)},St=Z=>{var we=jf();z(Z,we)};me(pe,Z=>{p(S),ce(()=>p(S).type==="success")?Z(st):Z(St,!1)})}var vt=K(pe,2),V=M(vt);Ae(()=>{W=Dr(ft,1,"bg-white rounded-lg shadow-lg border-l-4 p-4",null,W,{"border-green-500":p(S).type==="success","border-red-500":p(S).type==="error"}),Se(V,(p(S),ce(()=>p(S).message)))}),z(fe,Me)};me(X,fe=>{p(S),ce(()=>p(S).show)&&fe(ae)})}var ve=K(X,2),le=M(ve),Be=K(M(le),4),Ie=M(Be);{var Fe=fe=>{var Me=Tf();z(fe,Me)},Ue=fe=>{var Me=If();z(fe,Me)};me(Ie,fe=>{p(y)?fe(Fe):fe(Ue,!1)})}var ee=K(Be,2);{var xe=fe=>{var Me=Ff();z(fe,Me)};me(ee,fe=>{a(),ce(()=>a().length===0)&&fe(xe)})}var De=K(le,2),Oe=K(M(De),4),He=K(M(Oe),2),Ve=M(He),ke=M(Ve);ke.value=ke.__value="merge";var Ke=K(Ve,2),at=M(Ke);at.value=at.__value="replace";var q=K(Oe,2);Ii(q,fe=>T(B,fe),()=>p(B));var se=K(q,2),Ce=M(se);{var Qe=fe=>{var Me=Kf();z(fe,Me)},ct=fe=>{var Me=Nf();z(fe,Me)};me(Ce,fe=>{p(g)?fe(Qe):fe(ct,!1)})}Ae(()=>{Be.disabled=(p(y),a(),ce(()=>p(y)||a().length===0)),se.disabled=p(g)}),he("click",_e,function(...fe){h()?.apply(this,fe)}),he("click",Be,F),Ba(u,[],ke,()=>p(m),fe=>T(m,fe)),Ba(u,[],at,()=>p(m),fe=>T(m,fe)),he("change",q,$),he("click",se,R),z(r,re),Dt(),f()}var zf=J('<button class="inline-flex items-center min-h-[44px] px-3 py-2 text-gray-700 hover:bg-gray-100 font-medium rounded-lg transition-colors" aria-label="Settings"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> Settings</button>'),Uf=J('<button class="inline-flex items-center min-h-[44px] px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors shadow-sm"><svg class="w-5 h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> <span class="hidden sm:inline">New Collection</span></button>'),Vf=J('<header class="bg-white shadow-sm border-b border-gray-200"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex items-center justify-between"><div class="min-w-0"><h1 class="text-2xl font-bold text-gray-900 truncate">Memoria</h1> <p class="text-sm text-gray-600">Your multimedia flashcard companion</p></div> <div class="flex items-center gap-2 flex-shrink-0"><!> <!></div></div></div></header>'),$f=Et('<svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'),Hf=Et('<svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>'),Yf=J('<div class="fixed top-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-md z-50 animate-slide-in svelte-1n46o8q"><div><div class="flex items-center"><!> <p class="text-gray-900 font-medium"> </p></div></div></div>'),Wf=J('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="bg-white rounded-lg shadow-md p-8 text-center"><div class="inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4"><svg class="w-8 h-8 text-red-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg></div> <h2 class="text-xl font-semibold text-gray-900 mb-2">Database Error</h2> <p class="text-gray-600 mb-4">Failed to initialize the database. Please refresh the page or check browser compatibility.</p> <button class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">Reload Page</button></div></div>'),Gf=J('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!> <div class="mt-8 text-center"><span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">â Phase 7: Export/Import Functionality</span></div></div>'),Xf=J('<main class="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50"><!> <!> <!></main> <!> <!>',1);function Qf(r,n){Bt(n,!1);const a=()=>Do(cr,"$collections",l),[l,f]=Mo();let u=ie(!1),h=ie(!1),m=ie(null),g=ie(!1),y=ie(null),B=ie({show:!1,message:"",type:"success"}),S=ie("home"),A=ie(null);jo(async()=>{Yu(),T(u,await Vu()),p(u)&&await cr.load()});function F(q,se="success"){T(B,{show:!0,message:q,type:se}),setTimeout(()=>{It(B,p(B).show=!1)},3e3)}function R(){T(m,null),T(h,!0)}function $(q){T(m,q),T(h,!0)}function re(q){T(y,q),T(g,!0)}async function ue(q){try{await cr.create(q.detail),F("Collection created successfully!")}catch{F("Failed to create collection","error")}}async function de(q){try{const{id:se,...Ce}=q.detail;await cr.update(se,Ce),F("Collection updated successfully!")}catch{F("Failed to update collection","error")}}async function ge(){if(p(y))try{await cr.delete(p(y).id),F("Collection deleted successfully!"),T(y,null)}catch{F("Failed to delete collection","error")}}function _e(){T(h,!1),T(m,null)}function X(){T(g,!1),T(y,null)}function ae(q){T(A,q.id),T(S,"collection-detail")}function ve(){T(A,null),T(S,"home")}function le(){T(S,"settings")}Kt();var Be=Xf(),Ie=Pr(Be),Fe=M(Ie);{var Ue=q=>{var se=Vf(),Ce=M(se),Qe=M(Ce),ct=K(M(Qe),2),fe=M(ct);{var Me=Xe=>{var pe=zf();he("click",pe,le),z(Xe,pe)};me(fe,Xe=>{p(u)&&Xe(Me)})}var ft=K(fe,2);{var W=Xe=>{var pe=Uf();he("click",pe,R),z(Xe,pe)};me(ft,Xe=>{p(u)&&a().length>0&&Xe(W)})}z(q,se)};me(Fe,q=>{p(S)==="home"&&q(Ue)})}var ee=K(Fe,2);{var xe=q=>{var se=Yf(),Ce=M(se);let Qe;var ct=M(Ce),fe=M(ct);{var Me=pe=>{var st=$f();z(pe,st)},ft=pe=>{var st=Hf();z(pe,st)};me(fe,pe=>{p(B).type==="success"?pe(Me):pe(ft,!1)})}var W=K(fe,2),Xe=M(W);Ae(()=>{Qe=Dr(Ce,1,"bg-white rounded-lg shadow-lg border-l-4 p-4",null,Qe,{"border-green-500":p(B).type==="success","border-red-500":p(B).type==="error"}),Se(Xe,p(B).message)}),z(q,se)};me(ee,q=>{p(B).show&&q(xe)})}var De=K(ee,2);{var Oe=q=>{var se=Wf(),Ce=M(se),Qe=K(M(Ce),6);he("click",Qe,()=>window.location.reload()),z(q,se)},He=q=>{var se=Gf(),Ce=M(se);oc(Ce,{get collections(){return a()},onCreate:R,onEdit:$,onDelete:re,onClick:ae}),z(q,se)},Ve=q=>{Df(q,{get collectionId(){return p(A)},onBack:ve})},ke=q=>{qf(q,{onBack:ve})};me(De,q=>{p(u)?p(S)==="home"?q(He,1):p(S)==="collection-detail"?q(Ve,2):p(S)==="settings"&&q(ke,3):q(Oe)})}var Ke=K(Ie,2);dc(Ke,{get isOpen(){return p(h)},get collection(){return p(m)},$$events:{create:ue,update:de,close:_e}});var at=K(Ke,2);{let q=vn(()=>p(y)?`Are you sure you want to delete "${p(y).name}"? This will also delete all ${p(y).cardCount||0} cards in this collection. This action cannot be undone.`:"");Rs(at,{get isOpen(){return p(g)},title:"Delete Collection",get message(){return p(q)},confirmLabel:"Delete",cancelLabel:"Cancel",isDanger:!0,$$events:{confirm:ge,cancel:X}})}z(r,Be),Dt(),f()}gu(Qf,{target:document.getElementById("app")});
