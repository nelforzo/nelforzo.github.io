(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function i(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(c){if(c.ep)return;c.ep=!0;const u=i(c);fetch(c.href,u)}})();const hi=!1;var xo=Array.isArray,ul=Array.prototype.indexOf,sn=Array.prototype.includes,ko=Array.from,La=Object.defineProperty,on=Object.getOwnPropertyDescriptor,qa=Object.getOwnPropertyDescriptors,cl=Object.prototype,fl=Array.prototype,Ai=Object.getPrototypeOf,ga=Object.isExtensible;const an=()=>{};function dl(r){return r()}function pi(r){for(var n=0;n<r.length;n++)r[n]()}function za(){var r,n,i=new Promise((s,c)=>{r=s,n=c});return{promise:i,resolve:r,reject:n}}const xt=2,go=4,qn=8,Ua=1<<24,vr=16,Jt=32,Vr=64,Oi=128,Vt=512,pt=1024,kt=2048,Ht=4096,Nt=8192,cr=16384,Pi=32768,ln=65536,ya=1<<17,Va=1<<18,gn=1<<19,$a=1<<20,Cr=1<<25,zr=32768,mi=1<<21,Bi=1<<22,Er=1<<23,fr=Symbol("$state"),vl=Symbol("legacy props"),hl=Symbol(""),rn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Di(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function pl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function ml(r,n,i){throw new Error("https://svelte.dev/e/each_key_duplicate")}function gl(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function yl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function bl(r){throw new Error("https://svelte.dev/e/effect_orphan")}function _l(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function wl(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function xl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function kl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Cl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function El(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Sl=1,Al=2,Ol=16,Pl=1,Bl=2,Dl=4,Ml=8,jl=16,Ha=1,Rl=2,wt=Symbol(),Tl="http://www.w3.org/1999/xhtml";function Il(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Ya(r){return r===this.v}function Wa(r,n){return r!=r?n==n:r!==n||r!==null&&typeof r=="object"||typeof r=="function"}function Ga(r){return!Wa(r,this.v)}let yn=!1,Fl=!1;function Kl(){yn=!0}let tt=null;function un(r){tt=r}function Dt(r,n=!1,i){tt={p:tt,i:!1,c:null,e:null,s:r,x:null,l:yn&&!n?{s:null,u:null,$:[]}:null}}function Mt(r){var n=tt,i=n.e;if(i!==null){n.e=null;for(var s of i)hs(s)}return n.i=!0,tt=n.p,{}}function bn(){return!yn||tt!==null&&tt.l===null}let Kr=[];function Xa(){var r=Kr;Kr=[],pi(r)}function tr(r){if(Kr.length===0&&!Kn){var n=Kr;queueMicrotask(()=>{n===Kr&&Xa()})}Kr.push(r)}function Nl(){for(;Kr.length>0;)Xa()}function Qa(r){var n=Ye;if(n===null)return Ne.f|=Er,r;if((n.f&Pi)===0){if((n.f&Oi)===0)throw r;n.b.error(r)}else cn(r,n)}function cn(r,n){for(;n!==null;){if((n.f&Oi)!==0)try{n.b.error(r);return}catch(i){r=i}n=n.parent}throw r}const Ll=-7169;function st(r,n){r.f=r.f&Ll|n}function Mi(r){(r.f&Vt)!==0||r.deps===null?st(r,pt):st(r,Ht)}function Ja(r){if(r!==null)for(const n of r)(n.f&xt)===0||(n.f&zr)===0||(n.f^=zr,Ja(n.deps))}function Za(r,n,i){(r.f&kt)!==0?n.add(r):(r.f&Ht)!==0&&i.add(r),Ja(r.deps),st(r,pt)}const vo=new Set;let We=null,gi=null,Gt=null,At=[],Co=null,yi=!1,Kn=!1;class Sr{committed=!1;current=new Map;previous=new Map;#t=new Set;#s=new Set;#e=0;#i=0;#a=null;#n=new Set;#r=new Set;#o=new Map;is_fork=!1;#l=!1;is_deferred(){return this.is_fork||this.#i>0}skip_effect(n){this.#o.has(n)||this.#o.set(n,{d:[],m:[]})}unskip_effect(n){var i=this.#o.get(n);if(i){this.#o.delete(n);for(var s of i.d)st(s,kt),Xt(s);for(s of i.m)st(s,Ht),Xt(s)}}process(n){At=[],this.apply();var i=[],s=[];for(const c of n)this.#u(c,i,s);if(this.is_deferred()){this.#c(s),this.#c(i);for(const[c,u]of this.#o)ns(c,u)}else{for(const c of this.#t)c();this.#t.clear(),this.#e===0&&this.#f(),gi=this,We=null,ba(s),ba(i),gi=null,this.#a?.resolve()}Gt=null}#u(n,i,s){n.f^=pt;for(var c=n.first,u=null;c!==null;){var p=c.f,m=(p&(Jt|Vr))!==0,g=m&&(p&pt)!==0,y=g||(p&Nt)!==0||this.#o.has(c);if(!y&&c.fn!==null){m?c.f^=pt:u!==null&&(p&(go|qn|Ua))!==0?u.b.defer_effect(c):(p&go)!==0?i.push(c):xn(c)&&((p&vr)!==0&&this.#r.add(c),vn(c));var B=c.first;if(B!==null){c=B;continue}}var S=c.parent;for(c=c.next;c===null&&S!==null;)S===u&&(u=null),c=S.next,S=S.parent}}#c(n){for(var i=0;i<n.length;i+=1)Za(n[i],this.#n,this.#r)}capture(n,i){i!==wt&&!this.previous.has(n)&&this.previous.set(n,i),(n.f&Er)===0&&(this.current.set(n,n.v),Gt?.set(n,n.v))}activate(){We=this,this.apply()}deactivate(){We===this&&(We=null,Gt=null)}flush(){if(this.activate(),At.length>0){if(es(),We!==null&&We!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const n of this.#s)n(this);this.#s.clear()}#f(){if(vo.size>1){this.previous.clear();var n=Gt,i=!0;for(const c of vo){if(c===this){i=!1;continue}const u=[];for(const[m,g]of this.current){if(c.current.has(m))if(i&&g!==c.current.get(m))c.current.set(m,g);else continue;u.push(m)}if(u.length===0)continue;const p=[...c.current.keys()].filter(m=>!this.current.has(m));if(p.length>0){var s=At;At=[];const m=new Set,g=new Map;for(const y of u)ts(y,p,m,g);if(At.length>0){We=c,c.apply();for(const y of At)c.#u(y,[],[]);c.deactivate()}At=s}}We=null,Gt=n}this.committed=!0,vo.delete(this)}increment(n){this.#e+=1,n&&(this.#i+=1)}decrement(n){this.#e-=1,n&&(this.#i-=1),!this.#l&&(this.#l=!0,tr(()=>{this.#l=!1,this.is_deferred()?At.length>0&&this.flush():this.revive()}))}revive(){for(const n of this.#n)this.#r.delete(n),st(n,kt),Xt(n);for(const n of this.#r)st(n,Ht),Xt(n);this.flush()}oncommit(n){this.#t.add(n)}ondiscard(n){this.#s.add(n)}settled(){return(this.#a??=za()).promise}static ensure(){if(We===null){const n=We=new Sr;vo.add(We),Kn||tr(()=>{We===n&&n.flush()})}return We}apply(){}}function ql(r){var n=Kn;Kn=!0;try{for(var i;;){if(Nl(),At.length===0&&(We?.flush(),At.length===0))return Co=null,i;es()}}finally{Kn=n}}function es(){yi=!0;var r=null;try{for(var n=0;At.length>0;){var i=Sr.ensure();if(n++>1e3){var s,c;zl()}i.process(At),Ar.clear()}}finally{At=[],yi=!1,Co=null}}function zl(){try{_l()}catch(r){cn(r,Co)}}let sr=null;function ba(r){var n=r.length;if(n!==0){for(var i=0;i<n;){var s=r[i++];if((s.f&(cr|Nt))===0&&xn(s)&&(sr=new Set,vn(s),s.deps===null&&s.first===null&&s.nodes===null&&(s.teardown===null&&s.ac===null?gs(s):s.fn=null),sr?.size>0)){Ar.clear();for(const c of sr){if((c.f&(cr|Nt))!==0)continue;const u=[c];let p=c.parent;for(;p!==null;)sr.has(p)&&(sr.delete(p),u.push(p)),p=p.parent;for(let m=u.length-1;m>=0;m--){const g=u[m];(g.f&(cr|Nt))===0&&vn(g)}}sr.clear()}}sr=null}}function ts(r,n,i,s){if(!i.has(r)&&(i.add(r),r.reactions!==null))for(const c of r.reactions){const u=c.f;(u&xt)!==0?ts(c,n,i,s):(u&(Bi|vr))!==0&&(u&kt)===0&&rs(c,n,s)&&(st(c,kt),Xt(c))}}function rs(r,n,i){const s=i.get(r);if(s!==void 0)return s;if(r.deps!==null)for(const c of r.deps){if(sn.call(n,c))return!0;if((c.f&xt)!==0&&rs(c,n,i))return i.set(c,!0),!0}return i.set(r,!1),!1}function Xt(r){for(var n=Co=r;n.parent!==null;){n=n.parent;var i=n.f;if(yi&&n===Ye&&(i&vr)!==0&&(i&Va)===0)return;if((i&(Vr|Jt))!==0){if((i&pt)===0)return;n.f^=pt}}At.push(n)}function ns(r,n){if(!((r.f&Jt)!==0&&(r.f&pt)!==0)){(r.f&kt)!==0?n.d.push(r):(r.f&Ht)!==0&&n.m.push(r),st(r,pt);for(var i=r.first;i!==null;)ns(i,n),i=i.next}}function Ul(r){let n=0,i=Ur(0),s;return()=>{Ri()&&(h(i),wn(()=>(n===0&&(s=ue(()=>r(()=>Nn(i)))),n+=1,()=>{tr(()=>{n-=1,n===0&&(s?.(),s=void 0,Nn(i))})})))}}var Vl=ln|gn|Oi;function $l(r,n,i){new Hl(r,n,i)}class Hl{parent;is_pending=!1;#t;#s=null;#e;#i;#a;#n=null;#r=null;#o=null;#l=null;#u=null;#c=0;#f=0;#h=!1;#v=!1;#p=new Set;#m=new Set;#d=null;#w=Ul(()=>(this.#d=Ur(this.#c),()=>{this.#d=null}));constructor(n,i,s){this.#t=n,this.#e=i,this.#i=s,this.parent=Ye.b,this.is_pending=!!this.#e.pending,this.#a=Oo(()=>{Ye.b=this;{var c=this.#b();try{this.#n=Ut(()=>s(c))}catch(u){this.error(u)}this.#f>0?this.#y():this.is_pending=!1}return()=>{this.#u?.remove()}},Vl)}#x(){try{this.#n=Ut(()=>this.#i(this.#t))}catch(n){this.error(n)}}#k(){const n=this.#e.pending;n&&(this.#r=Ut(()=>n(this.#t)),tr(()=>{var i=this.#b();this.#n=this.#g(()=>(Sr.ensure(),Ut(()=>this.#i(i)))),this.#f>0?this.#y():(Lr(this.#r,()=>{this.#r=null}),this.is_pending=!1)}))}#b(){var n=this.#t;return this.is_pending&&(this.#u=dr(),this.#t.before(this.#u),n=this.#u),n}defer_effect(n){Za(n,this.#p,this.#m)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#g(n){var i=Ye,s=Ne,c=tt;rr(this.#a),Yt(this.#a),un(this.#a.ctx);try{return n()}catch(u){return Qa(u),null}finally{rr(i),Yt(s),un(c)}}#y(){const n=this.#e.pending;this.#n!==null&&(this.#l=document.createDocumentFragment(),this.#l.append(this.#u),_s(this.#n,this.#l)),this.#r===null&&(this.#r=Ut(()=>n(this.#t)))}#_(n){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(n);return}if(this.#f+=n,this.#f===0){this.is_pending=!1;for(const i of this.#p)st(i,kt),Xt(i);for(const i of this.#m)st(i,Ht),Xt(i);this.#p.clear(),this.#m.clear(),this.#r&&Lr(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null)}}update_pending_count(n){this.#_(n),this.#c+=n,!(!this.#d||this.#h)&&(this.#h=!0,tr(()=>{this.#h=!1,this.#d&&dn(this.#d,this.#c)}))}get_effect_pending(){return this.#w(),h(this.#d)}error(n){var i=this.#e.onerror;let s=this.#e.failed;if(this.#v||!i&&!s)throw n;this.#n&&(Bt(this.#n),this.#n=null),this.#r&&(Bt(this.#r),this.#r=null),this.#o&&(Bt(this.#o),this.#o=null);var c=!1,u=!1;const p=()=>{if(c){Il();return}c=!0,u&&El(),Sr.ensure(),this.#c=0,this.#o!==null&&Lr(this.#o,()=>{this.#o=null}),this.is_pending=this.has_pending_snippet(),this.#n=this.#g(()=>(this.#v=!1,Ut(()=>this.#i(this.#t)))),this.#f>0?this.#y():this.is_pending=!1};tr(()=>{try{u=!0,i?.(n,p),u=!1}catch(m){cn(m,this.#a&&this.#a.parent)}s&&(this.#o=this.#g(()=>{Sr.ensure(),this.#v=!0;try{return Ut(()=>{s(this.#t,()=>n,()=>p)})}catch(m){return cn(m,this.#a.parent),null}finally{this.#v=!1}}))})}}function Yl(r,n,i,s){const c=bn()?Eo:fn;var u=r.filter(A=>!A.settled);if(i.length===0&&u.length===0){s(n.map(c));return}var p=We,m=Ye,g=Wl(),y=u.length===1?u[0].promise:u.length>1?Promise.all(u.map(A=>A.promise)):null;function B(A){g();try{s(A)}catch(F){(m.f&cr)===0&&cn(F,m)}p?.deactivate(),bi()}if(i.length===0){y.then(()=>B(n.map(c)));return}function S(){g(),Promise.all(i.map(A=>Gl(A))).then(A=>B([...n.map(c),...A])).catch(A=>cn(A,m))}y?y.then(S):S()}function Wl(){var r=Ye,n=Ne,i=tt,s=We;return function(u=!0){rr(r),Yt(n),un(i),u&&s?.activate()}}function bi(){rr(null),Yt(null),un(null)}function Eo(r){var n=xt|kt,i=Ne!==null&&(Ne.f&xt)!==0?Ne:null;return Ye!==null&&(Ye.f|=gn),{ctx:tt,deps:null,effects:null,equals:Ya,f:n,fn:r,reactions:null,rv:0,v:wt,wv:0,parent:i??Ye,ac:null}}function Gl(r,n,i){let s=Ye;s===null&&pl();var c=s.b,u=void 0,p=Ur(wt),m=!Ne,g=new Map;return au(()=>{var y=za();u=y.promise;try{Promise.resolve(r()).then(y.resolve,y.reject).then(()=>{B===We&&B.committed&&B.deactivate(),bi()})}catch(F){y.reject(F),bi()}var B=We;if(m){var S=c.is_rendered();c.update_pending_count(1),B.increment(S),g.get(B)?.reject(rn),g.delete(B),g.set(B,y)}const A=(F,T=void 0)=>{if(B.activate(),T)T!==rn&&(p.f|=Er,dn(p,T));else{(p.f&Er)!==0&&(p.f^=Er),dn(p,F);for(const[V,ee]of g){if(g.delete(V),V===B)break;ee.reject(rn)}}m&&(c.update_pending_count(-1),B.decrement(S))};y.promise.then(A,F=>A(null,F||"unknown"))}),Ao(()=>{for(const y of g.values())y.reject(rn)}),new Promise(y=>{function B(S){function A(){S===u?y(p):B(u)}S.then(A,A)}B(u)})}function fn(r){const n=Eo(r);return n.equals=Ga,n}function os(r){var n=r.effects;if(n!==null){r.effects=null;for(var i=0;i<n.length;i+=1)Bt(n[i])}}function Xl(r){for(var n=r.parent;n!==null;){if((n.f&xt)===0)return(n.f&cr)===0?n:null;n=n.parent}return null}function ji(r){var n,i=Ye;rr(Xl(r));try{r.f&=~zr,os(r),n=Cs(r)}finally{rr(i)}return n}function is(r){var n=ji(r);if(!r.equals(n)&&(r.wv=xs(),(!We?.is_fork||r.deps===null)&&(r.v=n,r.deps===null))){st(r,pt);return}Pr||(Gt!==null?(Ri()||We?.is_fork)&&Gt.set(r,n):Mi(r))}let _i=new Set;const Ar=new Map;let as=!1;function Ur(r,n){var i={f:0,v:r,reactions:null,equals:Ya,rv:0,wv:0};return i}function wr(r,n){const i=Ur(r);return uu(i),i}function oe(r,n=!1,i=!0){const s=Ur(r);return n||(s.equals=Ga),yn&&i&&tt!==null&&tt.l!==null&&(tt.l.s??=[]).push(s),s}function Pt(r,n){return R(r,ue(()=>h(r))),n}function R(r,n,i=!1){Ne!==null&&(!Qt||(Ne.f&ya)!==0)&&bn()&&(Ne.f&(xt|vr|Bi|ya))!==0&&($t===null||!sn.call($t,r))&&Cl();let s=i?nn(n):n;return dn(r,s)}function dn(r,n){if(!r.equals(n)){var i=r.v;Pr?Ar.set(r,n):Ar.set(r,i),r.v=n;var s=Sr.ensure();if(s.capture(r,i),(r.f&xt)!==0){const c=r;(r.f&kt)!==0&&ji(c),Mi(c)}r.wv=xs(),ss(r,kt),bn()&&Ye!==null&&(Ye.f&pt)!==0&&(Ye.f&(Jt|Vr))===0&&(zt===null?cu([r]):zt.push(r)),!s.is_fork&&_i.size>0&&!as&&Ql()}return n}function Ql(){as=!1;for(const r of _i)(r.f&pt)!==0&&st(r,Ht),xn(r)&&vn(r);_i.clear()}function _a(r,n=1){var i=h(r),s=n===1?i++:i--;return R(r,i),s}function Nn(r){R(r,r.v+1)}function ss(r,n){var i=r.reactions;if(i!==null)for(var s=bn(),c=i.length,u=0;u<c;u++){var p=i[u],m=p.f;if(!(!s&&p===Ye)){var g=(m&kt)===0;if(g&&st(p,n),(m&xt)!==0){var y=p;Gt?.delete(y),(m&zr)===0&&(m&Vt&&(p.f|=zr),ss(y,Ht))}else g&&((m&vr)!==0&&sr!==null&&sr.add(p),Xt(p))}}}function nn(r){if(typeof r!="object"||r===null||fr in r)return r;const n=Ai(r);if(n!==cl&&n!==fl)return r;var i=new Map,s=xo(r),c=wr(0),u=qr,p=m=>{if(qr===u)return m();var g=Ne,y=qr;Yt(null),Ca(u);var B=m();return Yt(g),Ca(y),B};return s&&i.set("length",wr(r.length)),new Proxy(r,{defineProperty(m,g,y){(!("value"in y)||y.configurable===!1||y.enumerable===!1||y.writable===!1)&&xl();var B=i.get(g);return B===void 0?p(()=>{var S=wr(y.value);return i.set(g,S),S}):R(B,y.value,!0),!0},deleteProperty(m,g){var y=i.get(g);if(y===void 0){if(g in m){const B=p(()=>wr(wt));i.set(g,B),Nn(c)}}else R(y,wt),Nn(c);return!0},get(m,g,y){if(g===fr)return r;var B=i.get(g),S=g in m;if(B===void 0&&(!S||on(m,g)?.writable)&&(B=p(()=>{var F=nn(S?m[g]:wt),T=wr(F);return T}),i.set(g,B)),B!==void 0){var A=h(B);return A===wt?void 0:A}return Reflect.get(m,g,y)},getOwnPropertyDescriptor(m,g){var y=Reflect.getOwnPropertyDescriptor(m,g);if(y&&"value"in y){var B=i.get(g);B&&(y.value=h(B))}else if(y===void 0){var S=i.get(g),A=S?.v;if(S!==void 0&&A!==wt)return{enumerable:!0,configurable:!0,value:A,writable:!0}}return y},has(m,g){if(g===fr)return!0;var y=i.get(g),B=y!==void 0&&y.v!==wt||Reflect.has(m,g);if(y!==void 0||Ye!==null&&(!B||on(m,g)?.writable)){y===void 0&&(y=p(()=>{var A=B?nn(m[g]):wt,F=wr(A);return F}),i.set(g,y));var S=h(y);if(S===wt)return!1}return B},set(m,g,y,B){var S=i.get(g),A=g in m;if(s&&g==="length")for(var F=y;F<S.v;F+=1){var T=i.get(F+"");T!==void 0?R(T,wt):F in m&&(T=p(()=>wr(wt)),i.set(F+"",T))}if(S===void 0)(!A||on(m,g)?.writable)&&(S=p(()=>wr(void 0)),R(S,nn(y)),i.set(g,S));else{A=S.v!==wt;var V=p(()=>nn(y));R(S,V)}var ee=Reflect.getOwnPropertyDescriptor(m,g);if(ee?.set&&ee.set.call(B,y),!A){if(s&&typeof g=="string"){var se=i.get("length"),ve=Number(g);Number.isInteger(ve)&&ve>=se.v&&R(se,ve+1)}Nn(c)}return!0},ownKeys(m){h(c);var g=Reflect.ownKeys(m).filter(S=>{var A=i.get(S);return A===void 0||A.v!==wt});for(var[y,B]of i)B.v!==wt&&!(y in m)&&g.push(y);return g},setPrototypeOf(){kl()}})}function wa(r){try{if(r!==null&&typeof r=="object"&&fr in r)return r[fr]}catch{}return r}function Jl(r,n){return Object.is(wa(r),wa(n))}var Ln,ls,us,cs;function Zl(){if(Ln===void 0){Ln=window,ls=/Firefox/.test(navigator.userAgent);var r=Element.prototype,n=Node.prototype,i=Text.prototype;us=on(n,"firstChild").get,cs=on(n,"nextSibling").get,ga(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),ga(i)&&(i.__t=void 0)}}function dr(r=""){return document.createTextNode(r)}function lr(r){return us.call(r)}function zn(r){return cs.call(r)}function j(r,n){return lr(r)}function Or(r,n=!1){{var i=lr(r);return i instanceof Comment&&i.data===""?zn(i):i}}function K(r,n=1,i=!1){let s=r;for(;n--;)s=zn(s);return s}function eu(r){r.textContent=""}function fs(){return!1}let xa=!1;function tu(){xa||(xa=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{if(!r.defaultPrevented)for(const n of r.target.elements)n.__on_r?.()})},{capture:!0}))}function So(r){var n=Ne,i=Ye;Yt(null),rr(null);try{return r()}finally{Yt(n),rr(i)}}function ds(r,n,i,s=i){r.addEventListener(n,()=>So(i));const c=r.__on_r;c?r.__on_r=()=>{c(),s(!0)}:r.__on_r=()=>s(!0),tu()}function vs(r){Ye===null&&(Ne===null&&bl(),yl()),Pr&&gl()}function ru(r,n){var i=n.last;i===null?n.last=n.first=r:(i.next=r,r.prev=i,n.last=r)}function nr(r,n,i){var s=Ye;s!==null&&(s.f&Nt)!==0&&(r|=Nt);var c={ctx:tt,deps:null,nodes:null,f:r|kt|Vt,first:null,fn:n,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,wv:0,ac:null};if(i)try{vn(c),c.f|=Pi}catch(m){throw Bt(c),m}else n!==null&&Xt(c);var u=c;if(i&&u.deps===null&&u.teardown===null&&u.nodes===null&&u.first===u.last&&(u.f&gn)===0&&(u=u.first,(r&vr)!==0&&(r&ln)!==0&&u!==null&&(u.f|=ln)),u!==null&&(u.parent=s,s!==null&&ru(u,s),Ne!==null&&(Ne.f&xt)!==0&&(r&Vr)===0)){var p=Ne;(p.effects??=[]).push(u)}return c}function Ri(){return Ne!==null&&!Qt}function Ao(r){const n=nr(qn,null,!1);return st(n,pt),n.teardown=r,n}function wi(r){vs();var n=Ye.f,i=!Ne&&(n&Jt)!==0&&(n&Pi)===0;if(i){var s=tt;(s.e??=[]).push(r)}else return hs(r)}function hs(r){return nr(go|$a,r,!1)}function nu(r){return vs(),nr(qn|$a,r,!0)}function ou(r){Sr.ensure();const n=nr(Vr|gn,r,!0);return(i={})=>new Promise(s=>{i.outro?Lr(n,()=>{Bt(n),s(void 0)}):(Bt(n),s(void 0))})}function iu(r){return nr(go,r,!1)}function ht(r,n){var i=tt,s={effect:null,ran:!1,deps:r};i.l.$.push(s),s.effect=wn(()=>{r(),!s.ran&&(s.ran=!0,ue(n))})}function _n(){var r=tt;wn(()=>{for(var n of r.l.$){n.deps();var i=n.effect;(i.f&pt)!==0&&i.deps!==null&&st(i,Ht),xn(i)&&vn(i),n.ran=!1}})}function au(r){return nr(Bi|gn,r,!0)}function wn(r,n=0){return nr(qn|n,r,!0)}function Oe(r,n=[],i=[],s=[]){Yl(s,n,i,c=>{nr(qn,()=>r(...c.map(h)),!0)})}function Oo(r,n=0){var i=nr(vr|n,r,!0);return i}function Ut(r){return nr(Jt|gn,r,!0)}function ps(r){var n=r.teardown;if(n!==null){const i=Pr,s=Ne;ka(!0),Yt(null);try{n.call(null)}finally{ka(i),Yt(s)}}}function ms(r,n=!1){var i=r.first;for(r.first=r.last=null;i!==null;){const c=i.ac;c!==null&&So(()=>{c.abort(rn)});var s=i.next;(i.f&Vr)!==0?i.parent=null:Bt(i,n),i=s}}function su(r){for(var n=r.first;n!==null;){var i=n.next;(n.f&Jt)===0&&Bt(n),n=i}}function Bt(r,n=!0){var i=!1;(n||(r.f&Va)!==0)&&r.nodes!==null&&r.nodes.end!==null&&(lu(r.nodes.start,r.nodes.end),i=!0),ms(r,n&&!i),yo(r,0),st(r,cr);var s=r.nodes&&r.nodes.t;if(s!==null)for(const u of s)u.stop();ps(r);var c=r.parent;c!==null&&c.first!==null&&gs(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes=r.ac=null}function lu(r,n){for(;r!==null;){var i=r===n?null:zn(r);r.remove(),r=i}}function gs(r){var n=r.parent,i=r.prev,s=r.next;i!==null&&(i.next=s),s!==null&&(s.prev=i),n!==null&&(n.first===r&&(n.first=s),n.last===r&&(n.last=i))}function Lr(r,n,i=!0){var s=[];ys(r,s,!0);var c=()=>{i&&Bt(r),n&&n()},u=s.length;if(u>0){var p=()=>--u||c();for(var m of s)m.out(p)}else c()}function ys(r,n,i){if((r.f&Nt)===0){r.f^=Nt;var s=r.nodes&&r.nodes.t;if(s!==null)for(const m of s)(m.is_global||i)&&n.push(m);for(var c=r.first;c!==null;){var u=c.next,p=(c.f&ln)!==0||(c.f&Jt)!==0&&(r.f&vr)!==0;ys(c,n,p?i:!1),c=u}}}function Ti(r){bs(r,!0)}function bs(r,n){if((r.f&Nt)!==0){r.f^=Nt,(r.f&pt)===0&&(st(r,kt),Xt(r));for(var i=r.first;i!==null;){var s=i.next,c=(i.f&ln)!==0||(i.f&Jt)!==0;bs(i,c?n:!1),i=s}var u=r.nodes&&r.nodes.t;if(u!==null)for(const p of u)(p.is_global||n)&&p.in()}}function _s(r,n){if(r.nodes)for(var i=r.nodes.start,s=r.nodes.end;i!==null;){var c=i===s?null:zn(i);n.append(i),i=c}}let po=!1,Pr=!1;function ka(r){Pr=r}let Ne=null,Qt=!1;function Yt(r){Ne=r}let Ye=null;function rr(r){Ye=r}let $t=null;function uu(r){Ne!==null&&($t===null?$t=[r]:$t.push(r))}let Ot=null,Kt=0,zt=null;function cu(r){zt=r}let ws=1,Nr=0,qr=Nr;function Ca(r){qr=r}function xs(){return++ws}function xn(r){var n=r.f;if((n&kt)!==0)return!0;if(n&xt&&(r.f&=~zr),(n&Ht)!==0){for(var i=r.deps,s=i.length,c=0;c<s;c++){var u=i[c];if(xn(u)&&is(u),u.wv>r.wv)return!0}(n&Vt)!==0&&Gt===null&&st(r,pt)}return!1}function ks(r,n,i=!0){var s=r.reactions;if(s!==null&&!($t!==null&&sn.call($t,r)))for(var c=0;c<s.length;c++){var u=s[c];(u.f&xt)!==0?ks(u,n,!1):n===u&&(i?st(u,kt):(u.f&pt)!==0&&st(u,Ht),Xt(u))}}function Cs(r){var n=Ot,i=Kt,s=zt,c=Ne,u=$t,p=tt,m=Qt,g=qr,y=r.f;Ot=null,Kt=0,zt=null,Ne=(y&(Jt|Vr))===0?r:null,$t=null,un(r.ctx),Qt=!1,qr=++Nr,r.ac!==null&&(So(()=>{r.ac.abort(rn)}),r.ac=null);try{r.f|=mi;var B=r.fn,S=B(),A=r.deps,F=We?.is_fork;if(Ot!==null){var T;if(F||yo(r,Kt),A!==null&&Kt>0)for(A.length=Kt+Ot.length,T=0;T<Ot.length;T++)A[Kt+T]=Ot[T];else r.deps=A=Ot;if(Ri()&&(r.f&Vt)!==0)for(T=Kt;T<A.length;T++)(A[T].reactions??=[]).push(r)}else!F&&A!==null&&Kt<A.length&&(yo(r,Kt),A.length=Kt);if(bn()&&zt!==null&&!Qt&&A!==null&&(r.f&(xt|Ht|kt))===0)for(T=0;T<zt.length;T++)ks(zt[T],r);if(c!==null&&c!==r){if(Nr++,c.deps!==null)for(let V=0;V<i;V+=1)c.deps[V].rv=Nr;if(n!==null)for(const V of n)V.rv=Nr;zt!==null&&(s===null?s=zt:s.push(...zt))}return(r.f&Er)!==0&&(r.f^=Er),S}catch(V){return Qa(V)}finally{r.f^=mi,Ot=n,Kt=i,zt=s,Ne=c,$t=u,un(p),Qt=m,qr=g}}function fu(r,n){let i=n.reactions;if(i!==null){var s=ul.call(i,r);if(s!==-1){var c=i.length-1;c===0?i=n.reactions=null:(i[s]=i[c],i.pop())}}if(i===null&&(n.f&xt)!==0&&(Ot===null||!sn.call(Ot,n))){var u=n;(u.f&Vt)!==0&&(u.f^=Vt,u.f&=~zr),Mi(u),os(u),yo(u,0)}}function yo(r,n){var i=r.deps;if(i!==null)for(var s=n;s<i.length;s++)fu(r,i[s])}function vn(r){var n=r.f;if((n&cr)===0){st(r,pt);var i=Ye,s=po;Ye=r,po=!0;try{(n&(vr|Ua))!==0?su(r):ms(r),ps(r);var c=Cs(r);r.teardown=typeof c=="function"?c:null,r.wv=ws;var u;hi&&Fl&&(r.f&kt)!==0&&r.deps}finally{po=s,Ye=i}}}async function du(){await Promise.resolve(),ql()}function h(r){var n=r.f,i=(n&xt)!==0;if(Ne!==null&&!Qt){var s=Ye!==null&&(Ye.f&cr)!==0;if(!s&&($t===null||!sn.call($t,r))){var c=Ne.deps;if((Ne.f&mi)!==0)r.rv<Nr&&(r.rv=Nr,Ot===null&&c!==null&&c[Kt]===r?Kt++:Ot===null?Ot=[r]:Ot.push(r));else{(Ne.deps??=[]).push(r);var u=r.reactions;u===null?r.reactions=[Ne]:sn.call(u,Ne)||u.push(Ne)}}}if(Pr&&Ar.has(r))return Ar.get(r);if(i){var p=r;if(Pr){var m=p.v;return((p.f&pt)===0&&p.reactions!==null||Ss(p))&&(m=ji(p)),Ar.set(p,m),m}var g=(p.f&Vt)===0&&!Qt&&Ne!==null&&(po||(Ne.f&Vt)!==0),y=p.deps===null;xn(p)&&(g&&(p.f|=Vt),is(p)),g&&!y&&Es(p)}if(Gt?.has(r))return Gt.get(r);if((r.f&Er)!==0)throw r.v;return r.v}function Es(r){if(r.deps!==null){r.f|=Vt;for(const n of r.deps)(n.reactions??=[]).push(r),(n.f&xt)!==0&&(n.f&Vt)===0&&Es(n)}}function Ss(r){if(r.v===wt)return!0;if(r.deps===null)return!1;for(const n of r.deps)if(Ar.has(n)||(n.f&xt)!==0&&Ss(n))return!0;return!1}function ue(r){var n=Qt;try{return Qt=!0,r()}finally{Qt=n}}function Ge(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(fr in r)xi(r);else if(!Array.isArray(r))for(let n in r){const i=r[n];typeof i=="object"&&i&&fr in i&&xi(i)}}}function xi(r,n=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!n.has(r)){n.add(r),r instanceof Date&&r.getTime();for(let s in r)try{xi(r[s],n)}catch{}const i=Ai(r);if(i!==Object.prototype&&i!==Array.prototype&&i!==Map.prototype&&i!==Set.prototype&&i!==Date.prototype){const s=qa(i);for(let c in s){const u=s[c].get;if(u)try{u.call(r)}catch{}}}}}const vu=["touchstart","touchmove"];function hu(r){return vu.includes(r)}const pu=new Set,Ea=new Set;function mu(r,n,i,s={}){function c(u){if(s.capture||In.call(n,u),!u.cancelBubble)return So(()=>i?.call(this,u))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?tr(()=>{n.addEventListener(r,c,s)}):n.addEventListener(r,c,s),c}function me(r,n,i,s,c){var u={capture:s,passive:c},p=mu(r,n,i,u);(n===document.body||n===window||n===document||n instanceof HTMLMediaElement)&&Ao(()=>{n.removeEventListener(r,p,u)})}let Sa=null;function In(r){var n=this,i=n.ownerDocument,s=r.type,c=r.composedPath?.()||[],u=c[0]||r.target;Sa=r;var p=0,m=Sa===r&&r.__root;if(m){var g=c.indexOf(m);if(g!==-1&&(n===document||n===window)){r.__root=n;return}var y=c.indexOf(n);if(y===-1)return;g<=y&&(p=g)}if(u=c[p]||r.target,u!==n){La(r,"currentTarget",{configurable:!0,get(){return u||i}});var B=Ne,S=Ye;Yt(null),rr(null);try{for(var A,F=[];u!==null;){var T=u.assignedSlot||u.parentNode||u.host||null;try{var V=u["__"+s];V!=null&&(!u.disabled||r.target===u)&&V.call(u,r)}catch(ee){A?F.push(ee):A=ee}if(r.cancelBubble||T===n||T===null)break;u=T}if(A){for(let ee of F)queueMicrotask(()=>{throw ee});throw A}}finally{r.__root=n,delete r.currentTarget,Yt(B),rr(S)}}}function As(r){var n=document.createElement("template");return n.innerHTML=r.replaceAll("<!>","<!---->"),n.content}function hn(r,n){var i=Ye;i.nodes===null&&(i.nodes={start:r,end:n,a:null,t:null})}function Q(r,n){var i=(n&Ha)!==0,s=(n&Rl)!==0,c,u=!r.startsWith("<!>");return()=>{c===void 0&&(c=As(u?r:"<!>"+r),i||(c=lr(c)));var p=s||ls?document.importNode(c,!0):c.cloneNode(!0);if(i){var m=lr(p),g=p.lastChild;hn(m,g)}else hn(p,p);return p}}function gu(r,n,i="svg"){var s=!r.startsWith("<!>"),c=(n&Ha)!==0,u=`<${i}>${s?r:"<!>"+r}</${i}>`,p;return()=>{if(!p){var m=As(u),g=lr(m);if(c)for(p=document.createDocumentFragment();lr(g);)p.appendChild(lr(g));else p=lr(g)}var y=p.cloneNode(!0);if(c){var B=lr(y),S=y.lastChild;hn(B,S)}else hn(y,y);return y}}function Et(r,n){return gu(r,n,"svg")}function Os(r=""){{var n=dr(r+"");return hn(n,n),n}}function Ii(){var r=document.createDocumentFragment(),n=document.createComment(""),i=dr();return r.append(n,i),hn(n,i),r}function z(r,n){r!==null&&r.before(n)}function Se(r,n){var i=n==null?"":typeof n=="object"?n+"":n;i!==(r.__t??=r.nodeValue)&&(r.__t=i,r.nodeValue=i+"")}function yu(r,n){return bu(r,n)}const en=new Map;function bu(r,{target:n,anchor:i,props:s={},events:c,context:u,intro:p=!0}){Zl();var m=new Set,g=S=>{for(var A=0;A<S.length;A++){var F=S[A];if(!m.has(F)){m.add(F);var T=hu(F);n.addEventListener(F,In,{passive:T});var V=en.get(F);V===void 0?(document.addEventListener(F,In,{passive:T}),en.set(F,1)):en.set(F,V+1)}}};g(ko(pu)),Ea.add(g);var y=void 0,B=ou(()=>{var S=i??n.appendChild(dr());return $l(S,{pending:()=>{}},A=>{Dt({});var F=tt;u&&(F.c=u),c&&(s.$$events=c),y=r(A,s)||{},Mt()}),()=>{for(var A of m){n.removeEventListener(A,In);var F=en.get(A);--F===0?(document.removeEventListener(A,In),en.delete(A)):en.set(A,F)}Ea.delete(g),S!==i&&S.parentNode?.removeChild(S)}});return _u.set(y,B),y}let _u=new WeakMap;class Ps{anchor;#t=new Map;#s=new Map;#e=new Map;#i=new Set;#a=!0;constructor(n,i=!0){this.anchor=n,this.#a=i}#n=()=>{var n=We;if(this.#t.has(n)){var i=this.#t.get(n),s=this.#s.get(i);if(s)Ti(s),this.#i.delete(i);else{var c=this.#e.get(i);c&&(this.#s.set(i,c.effect),this.#e.delete(i),c.fragment.lastChild.remove(),this.anchor.before(c.fragment),s=c.effect)}for(const[u,p]of this.#t){if(this.#t.delete(u),u===n)break;const m=this.#e.get(p);m&&(Bt(m.effect),this.#e.delete(p))}for(const[u,p]of this.#s){if(u===i||this.#i.has(u))continue;const m=()=>{if(Array.from(this.#t.values()).includes(u)){var y=document.createDocumentFragment();_s(p,y),y.append(dr()),this.#e.set(u,{effect:p,fragment:y})}else Bt(p);this.#i.delete(u),this.#s.delete(u)};this.#a||!s?(this.#i.add(u),Lr(p,m,!1)):m()}}};#r=n=>{this.#t.delete(n);const i=Array.from(this.#t.values());for(const[s,c]of this.#e)i.includes(s)||(Bt(c.effect),this.#e.delete(s))};ensure(n,i){var s=We,c=fs();if(i&&!this.#s.has(n)&&!this.#e.has(n))if(c){var u=document.createDocumentFragment(),p=dr();u.append(p),this.#e.set(n,{effect:Ut(()=>i(p)),fragment:u})}else this.#s.set(n,Ut(()=>i(this.anchor)));if(this.#t.set(s,n),c){for(const[m,g]of this.#s)m===n?s.unskip_effect(g):s.skip_effect(g);for(const[m,g]of this.#e)m===n?s.unskip_effect(g.effect):s.skip_effect(g.effect);s.oncommit(this.#n),s.ondiscard(this.#r)}else this.#n()}}function pe(r,n,i=!1){var s=new Ps(r),c=i?ln:0;function u(p,m){s.ensure(p,m)}Oo(()=>{var p=!1;n((m,g=0)=>{p=!0,u(g,m)}),p||u(!1,null)},c)}const wu=Symbol("NaN");function xu(r,n,i){var s=new Ps(r),c=!bn();Oo(()=>{var u=n();u!==u&&(u=wu),c&&u!==null&&typeof u=="object"&&(u={}),s.ensure(u,i)})}function ku(r,n,i){for(var s=[],c=n.length,u,p=n.length,m=0;m<c;m++){let S=n[m];Lr(S,()=>{if(u){if(u.pending.delete(S),u.done.add(S),u.pending.size===0){var A=r.outrogroups;ki(ko(u.done)),A.delete(u),A.size===0&&(r.outrogroups=null)}}else p-=1},!1)}if(p===0){var g=s.length===0&&i!==null;if(g){var y=i,B=y.parentNode;eu(B),B.append(y),r.items.clear()}ki(n,!g)}else u={pending:new Set(n),done:new Set},(r.outrogroups??=new Set).add(u)}function ki(r,n=!0){for(var i=0;i<r.length;i++)Bt(r[i],n)}var Aa;function Bs(r,n,i,s,c,u=null){var p=r,m=new Map;{var g=r;p=g.appendChild(dr())}var y=null,B=fn(()=>{var ee=i();return xo(ee)?ee:ee==null?[]:ko(ee)}),S,A=!0;function F(){V.fallback=y,Cu(V,S,p,n,s),y!==null&&(S.length===0?(y.f&Cr)===0?Ti(y):(y.f^=Cr,Fn(y,null,p)):Lr(y,()=>{y=null}))}var T=Oo(()=>{S=h(B);for(var ee=S.length,se=new Set,ve=We,ge=fs(),be=0;be<ee;be+=1){var X=S[be],ie=s(X,be),ce=A?null:m.get(ie);ce?(ce.v&&dn(ce.v,X),ce.i&&dn(ce.i,be),ge&&ve.unskip_effect(ce.e)):(ce=Eu(m,A?p:Aa??=dr(),X,ie,be,c,n,i),A||(ce.e.f|=Cr),m.set(ie,ce)),se.add(ie)}if(ee===0&&u&&!y&&(A?y=Ut(()=>u(p)):(y=Ut(()=>u(Aa??=dr())),y.f|=Cr)),ee>se.size&&ml(),!A)if(ge){for(const[le,Pe]of m)se.has(le)||ve.skip_effect(Pe.e);ve.oncommit(F),ve.ondiscard(()=>{})}else F();h(B)}),V={effect:T,items:m,outrogroups:null,fallback:y};A=!1}function Tn(r){for(;r!==null&&(r.f&Jt)===0;)r=r.next;return r}function Cu(r,n,i,s,c){var u=n.length,p=r.items,m=Tn(r.effect.first),g,y=null,B=[],S=[],A,F,T,V;for(V=0;V<u;V+=1){if(A=n[V],F=c(A,V),T=p.get(F).e,r.outrogroups!==null)for(const le of r.outrogroups)le.pending.delete(T),le.done.delete(T);if((T.f&Cr)!==0)if(T.f^=Cr,T===m)Fn(T,null,i);else{var ee=y?y.next:m;T===r.effect.last&&(r.effect.last=T.prev),T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),xr(r,y,T),xr(r,T,ee),Fn(T,ee,i),y=T,B=[],S=[],m=Tn(y.next);continue}if((T.f&Nt)!==0&&Ti(T),T!==m){if(g!==void 0&&g.has(T)){if(B.length<S.length){var se=S[0],ve;y=se.prev;var ge=B[0],be=B[B.length-1];for(ve=0;ve<B.length;ve+=1)Fn(B[ve],se,i);for(ve=0;ve<S.length;ve+=1)g.delete(S[ve]);xr(r,ge.prev,be.next),xr(r,y,ge),xr(r,be,se),m=se,y=be,V-=1,B=[],S=[]}else g.delete(T),Fn(T,m,i),xr(r,T.prev,T.next),xr(r,T,y===null?r.effect.first:y.next),xr(r,y,T),y=T;continue}for(B=[],S=[];m!==null&&m!==T;)(g??=new Set).add(m),S.push(m),m=Tn(m.next);if(m===null)continue}(T.f&Cr)===0&&B.push(T),y=T,m=Tn(T.next)}if(r.outrogroups!==null){for(const le of r.outrogroups)le.pending.size===0&&(ki(ko(le.done)),r.outrogroups?.delete(le));r.outrogroups.size===0&&(r.outrogroups=null)}if(m!==null||g!==void 0){var X=[];if(g!==void 0)for(T of g)(T.f&Nt)===0&&X.push(T);for(;m!==null;)(m.f&Nt)===0&&m!==r.fallback&&X.push(m),m=Tn(m.next);var ie=X.length;if(ie>0){var ce=u===0?i:null;ku(r,X,ce)}}}function Eu(r,n,i,s,c,u,p,m){var g=(p&Sl)!==0?(p&Ol)===0?oe(i,!1,!1):Ur(i):null,y=(p&Al)!==0?Ur(c):null;return{v:g,i:y,e:Ut(()=>(u(n,g??i,y??c,m),()=>{r.delete(s)}))}}function Fn(r,n,i){if(r.nodes)for(var s=r.nodes.start,c=r.nodes.end,u=n&&(n.f&Cr)===0?n.nodes.start:i;s!==null;){var p=zn(s);if(u.before(s),s===c)return;s=p}}function xr(r,n,i){n===null?r.effect.first=i:n.next=i,i===null?r.effect.last=n:i.prev=n}const Oa=[...` 	
\r\fÂ \v\uFEFF`];function Su(r,n,i){var s=r==null?"":""+r;if(i){for(var c in i)if(i[c])s=s?s+" "+c:c;else if(s.length)for(var u=c.length,p=0;(p=s.indexOf(c,p))>=0;){var m=p+u;(p===0||Oa.includes(s[p-1]))&&(m===s.length||Oa.includes(s[m]))?s=(p===0?"":s.substring(0,p))+s.substring(m+1):p=m}}return s===""?null:s}function Pa(r,n=!1){var i=n?" !important;":";",s="";for(var c in r){var u=r[c];u!=null&&u!==""&&(s+=" "+c+": "+u+i)}return s}function Au(r,n){if(n){var i="",s,c;return Array.isArray(n)?(s=n[0],c=n[1]):s=n,s&&(i+=Pa(s)),c&&(i+=Pa(c,!0)),i=i.trim(),i===""?null:i}return String(r)}function Br(r,n,i,s,c,u){var p=r.__className;if(p!==i||p===void 0){var m=Su(i,s,u);m==null?r.removeAttribute("class"):r.className=m,r.__className=i}else if(u&&c!==u)for(var g in u){var y=!!u[g];(c==null||y!==!!c[g])&&r.classList.toggle(g,y)}return u}function ci(r,n={},i,s){for(var c in i){var u=i[c];n[c]!==u&&(i[c]==null?r.style.removeProperty(c):r.style.setProperty(c,u,s))}}function Ou(r,n,i,s){var c=r.__style;if(c!==n){var u=Au(n,s);u==null?r.removeAttribute("style"):r.style.cssText=u,r.__style=n}else s&&(Array.isArray(s)?(ci(r,i?.[0],s[0]),ci(r,i?.[1],s[1],"important")):ci(r,i,s));return s}const Pu=Symbol("is custom element"),Bu=Symbol("is html");function pn(r,n,i,s){var c=Du(r);c[n]!==(c[n]=i)&&(n==="loading"&&(r[hl]=i),i==null?r.removeAttribute(n):typeof i!="string"&&Mu(r).includes(n)?r[n]=i:r.setAttribute(n,i))}function Du(r){return r.__attributes??={[Pu]:r.nodeName.includes("-"),[Bu]:r.namespaceURI===Tl}}var Ba=new Map;function Mu(r){var n=r.getAttribute("is")||r.nodeName,i=Ba.get(n);if(i)return i;Ba.set(n,i=[]);for(var s,c=r,u=Element.prototype;u!==c;){s=qa(c);for(var p in s)s[p].set&&i.push(p);c=Ai(c)}return i}function Ci(r,n,i=n){var s=new WeakSet;ds(r,"input",async c=>{var u=c?r.defaultValue:r.value;if(u=di(r)?vi(u):u,i(u),We!==null&&s.add(We),await du(),u!==(u=n())){var p=r.selectionStart,m=r.selectionEnd,g=r.value.length;if(r.value=u??"",m!==null){var y=r.value.length;p===m&&m===g&&y>g?(r.selectionStart=y,r.selectionEnd=y):(r.selectionStart=p,r.selectionEnd=Math.min(m,y))}}}),ue(n)==null&&r.value&&(i(di(r)?vi(r.value):r.value),We!==null&&s.add(We)),wn(()=>{var c=n();if(r===document.activeElement){var u=gi??We;if(s.has(u))return}di(r)&&c===vi(r.value)||r.type==="date"&&!c&&!r.value||c!==r.value&&(r.value=c??"")})}const fi=new Set;function Da(r,n,i,s,c=s){var u=i.getAttribute("type")==="checkbox",p=r;if(n!==null)for(var m of n)p=p[m]??=[];p.push(i),ds(i,"change",()=>{var g=i.__value;u&&(g=ju(p,g,i.checked)),c(g)},()=>c(u?[]:null)),wn(()=>{var g=s();u?(g=g||[],i.checked=g.includes(i.__value)):i.checked=Jl(i.__value,g)}),Ao(()=>{var g=p.indexOf(i);g!==-1&&p.splice(g,1)}),fi.has(p)||(fi.add(p),tr(()=>{p.sort((g,y)=>g.compareDocumentPosition(y)===4?-1:1),fi.delete(p)})),tr(()=>{})}function ju(r,n,i){for(var s=new Set,c=0;c<r.length;c+=1)r[c].checked&&s.add(r[c].__value);return i||s.delete(n),Array.from(s)}function di(r){var n=r.type;return n==="number"||n==="range"}function vi(r){return r===""?null:+r}function Ma(r,n){return r===n||r?.[fr]===n}function Po(r={},n,i,s){return iu(()=>{var c,u;return wn(()=>{c=u,u=[],ue(()=>{r!==i(...u)&&(n(r,...u),c&&Ma(i(...c),r)&&n(null,...c))})}),()=>{tr(()=>{u&&Ma(i(...u),r)&&n(null,...u)})}}),r}function Fi(r){return function(...n){var i=n[0];return i.stopPropagation(),r?.apply(this,n)}}function Ds(r){return function(...n){var i=n[0];return i.preventDefault(),r?.apply(this,n)}}function Lt(r=!1){const n=tt,i=n.l.u;if(!i)return;let s=()=>Ge(n.s);if(r){let c=0,u={};const p=Eo(()=>{let m=!1;const g=n.s;for(const y in g)g[y]!==u[y]&&(u[y]=g[y],m=!0);return m&&c++,c});s=()=>h(p)}i.b.length&&nu(()=>{ja(n,s),pi(i.b)}),wi(()=>{const c=ue(()=>i.m.map(dl));return()=>{for(const u of c)typeof u=="function"&&u()}}),i.a.length&&wi(()=>{ja(n,s),pi(i.a)})}function ja(r,n){if(r.l.s)for(const i of r.l.s)h(i);n()}function Ru(r,n){var i=r.$$events?.[n.type],s=xo(i)?i.slice():i==null?[]:[i];for(var c of s)c.call(this,n)}function Ms(r,n,i){if(r==null)return n(void 0),an;const s=ue(()=>r.subscribe(n,i));return s.unsubscribe?()=>s.unsubscribe():s}const tn=[];function js(r,n=an){let i=null;const s=new Set;function c(m){if(Wa(r,m)&&(r=m,i)){const g=!tn.length;for(const y of s)y[1](),tn.push(y,r);if(g){for(let y=0;y<tn.length;y+=2)tn[y][0](tn[y+1]);tn.length=0}}}function u(m){c(m(r))}function p(m,g=an){const y=[m,g];return s.add(y),s.size===1&&(i=n(c,u)||an),m(r),()=>{s.delete(y),s.size===0&&i&&(i(),i=null)}}return{set:c,update:u,subscribe:p}}function Tu(r){let n;return Ms(r,i=>n=i)(),n}let ho=!1,Ei=Symbol();function Bo(r,n,i){const s=i[n]??={store:null,source:oe(void 0),unsubscribe:an};if(s.store!==r&&!(Ei in i))if(s.unsubscribe(),s.store=r??null,r==null)s.source.v=void 0,s.unsubscribe=an;else{var c=!0;s.unsubscribe=Ms(r,u=>{c?s.source.v=u:R(s.source,u)}),c=!1}return r&&Ei in i?Tu(r):h(s.source)}function Do(){const r={};function n(){Ao(()=>{for(var i in r)r[i].unsubscribe();La(r,Ei,{enumerable:!1,value:!0})})}return[r,n]}function Iu(r){var n=ho;try{return ho=!1,[r(),ho]}finally{ho=n}}function je(r,n,i,s){var c=!yn||(i&Bl)!==0,u=(i&Ml)!==0,p=(i&jl)!==0,m=s,g=!0,y=()=>(g&&(g=!1,m=p?ue(s):s),m),B;if(u){var S=fr in r||vl in r;B=on(r,n)?.set??(S&&n in r?ge=>r[n]=ge:void 0)}var A,F=!1;u?[A,F]=Iu(()=>r[n]):A=r[n],A===void 0&&s!==void 0&&(A=y(),B&&(c&&wl(),B(A)));var T;if(c?T=()=>{var ge=r[n];return ge===void 0?y():(g=!0,ge)}:T=()=>{var ge=r[n];return ge!==void 0&&(m=void 0),ge===void 0?m:ge},c&&(i&Dl)===0)return T;if(B){var V=r.$$legacy;return(function(ge,be){return arguments.length>0?((!c||!be||V||F)&&B(be?T():ge),ge):T()})}var ee=!1,se=((i&Pl)!==0?Eo:fn)(()=>(ee=!1,T()));u&&h(se);var ve=Ye;return(function(ge,be){if(arguments.length>0){const X=be?h(se):c&&u?nn(ge):ge;return R(se,X),ee=!0,m!==void 0&&(m=X),ge}return Pr&&ee||(ve.f&cr)!==0?se.v:h(se)})}function Mo(r){tt===null&&Di(),yn&&tt.l!==null?Ku(tt).m.push(r):wi(()=>{const n=ue(r);if(typeof n=="function")return n})}function Rs(r){tt===null&&Di(),Mo(()=>()=>ue(r))}function Fu(r,n,{bubbles:i=!1,cancelable:s=!1}={}){return new CustomEvent(r,{detail:n,bubbles:i,cancelable:s})}function kn(){const r=tt;return r===null&&Di(),(n,i,s)=>{const c=r.s.$$events?.[n];if(c){const u=xo(c)?c.slice():[c],p=Fu(n,i,s);for(const m of u)m.call(r.x,p);return!p.defaultPrevented}return!0}}function Ku(r){var n=r.l;return n.u??={a:[],b:[],m:[]}}const Nu="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Nu);Kl();var Lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var mo={exports:{}},zu=mo.exports,Ra;function Uu(){return Ra||(Ra=1,(function(r,n){((i,s)=>{r.exports=s()})(zu,function(){var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(o,a){o.__proto__=a}:function(o,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(o[l]=a[l])}))(e,t)},s=function(){return(s=Object.assign||function(e){for(var t,o=1,a=arguments.length;o<a;o++)for(var l in t=arguments[o])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)};function c(e,t,o){for(var a,l=0,f=t.length;l<f;l++)!a&&l in t||((a=a||Array.prototype.slice.call(t,0,l))[l]=t[l]);return e.concat(a||Array.prototype.slice.call(t))}var u=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Lu,p=Object.keys,m=Array.isArray;function g(e,t){return typeof t=="object"&&p(t).forEach(function(o){e[o]=t[o]}),e}typeof Promise>"u"||u.Promise||(u.Promise=Promise);var y=Object.getPrototypeOf,B={}.hasOwnProperty;function S(e,t){return B.call(e,t)}function A(e,t){typeof t=="function"&&(t=t(y(e))),(typeof Reflect>"u"?p:Reflect.ownKeys)(t).forEach(function(o){T(e,o,t[o])})}var F=Object.defineProperty;function T(e,t,o,a){F(e,t,g(o&&S(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},a))}function V(e){return{from:function(t){return e.prototype=Object.create(t.prototype),T(e.prototype,"constructor",e),{extend:A.bind(null,e.prototype)}}}}var ee=Object.getOwnPropertyDescriptor,se=[].slice;function ve(e,t,o){return se.call(e,t,o)}function ge(e,t){return t(e)}function be(e){if(!e)throw new Error("Assertion Failed")}function X(e){u.setImmediate?setImmediate(e):setTimeout(e,0)}function ie(e,t){if(typeof t=="string"&&S(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var o=[],a=0,l=t.length;a<l;++a){var f=ie(e,t[a]);o.push(f)}return o}var d,v=t.indexOf(".");return v===-1||(d=e[t.substr(0,v)])==null?void 0:ie(d,t.substr(v+1))}function ce(e,t,o){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){be(typeof o!="string"&&"length"in o);for(var a=0,l=t.length;a<l;++a)ce(e,t[a],o[a])}else{var f,d,v=t.indexOf(".");v!==-1?(f=t.substr(0,v),(v=t.substr(v+1))===""?o===void 0?m(e)&&!isNaN(parseInt(f))?e.splice(f,1):delete e[f]:e[f]=o:ce(d=(d=e[f])&&S(e,f)?d:e[f]={},v,o)):o===void 0?m(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=o}}function le(e){var t,o={};for(t in e)S(e,t)&&(o[t]=e[t]);return o}var Pe=[].concat;function Be(e){return Pe.apply([],e)}var q="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Be([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return u[e]}),Le=new Set(q.map(function(e){return u[e]})),$e=null;function J(e){return $e=new WeakMap,e=(function t(o){if(!o||typeof o!="object")return o;var a=$e.get(o);if(a)return a;if(m(o)){a=[],$e.set(o,a);for(var l=0,f=o.length;l<f;++l)a.push(t(o[l]))}else if(Le.has(o.constructor))a=o;else{var d,v=y(o);for(d in a=v===Object.prototype?{}:Object.create(v),$e.set(o,a),o)S(o,d)&&(a[d]=t(o[d]))}return a})(e),$e=null,e}var xe={}.toString;function Fe(e){return xe.call(e).slice(8,-1)}var De=typeof Symbol<"u"?Symbol.iterator:"@@iterator",He=typeof De=="symbol"?function(e){var t;return e!=null&&(t=e[De])&&t.apply(e)}:function(){return null};function qe(e,t){t=e.indexOf(t),0<=t&&e.splice(t,1)}var Ce={};function Ve(e){var t,o,a,l;if(arguments.length===1){if(m(e))return e.slice();if(this===Ce&&typeof e=="string")return[e];if(l=He(e))for(o=[];!(a=l.next()).done;)o.push(a.value);else{if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(o=new Array(t);t--;)o[t]=e[t]}}else for(t=arguments.length,o=new Array(t);t--;)o[t]=arguments[t];return o}var ot=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},q=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],it=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(q),ae={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ke(e,t){this.name=e,this.message=t}function Ze(e,t){return e+". Errors: "+Object.keys(t).map(function(o){return t[o].toString()}).filter(function(o,a,l){return l.indexOf(o)===a}).join(`
`)}function ft(e,t,o,a){this.failures=t,this.failedKeys=a,this.successCount=o,this.message=Ze(e,t)}function fe(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(o){return t[o]}),this.failuresByPos=t,this.message=Ze(e,this.failures)}V(ke).from(Error).extend({toString:function(){return this.name+": "+this.message}}),V(ft).from(ke),V(fe).from(ke);var Re=it.reduce(function(e,t){return e[t]=t+"Error",e},{}),dt=ke,Y=it.reduce(function(e,t){var o=t+"Error";function a(l,f){this.name=o,l?typeof l=="string"?(this.message="".concat(l).concat(f?`
 `+f:""),this.inner=f||null):typeof l=="object"&&(this.message="".concat(l.name," ").concat(l.message),this.inner=l):(this.message=ae[t]||o,this.inner=null)}return V(a).from(dt),e[t]=a,e},{}),Je=(Y.Syntax=SyntaxError,Y.Type=TypeError,Y.Range=RangeError,q.reduce(function(e,t){return e[t+"Error"]=Y[t],e},{}));q=it.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Y[t]),e},{});function he(){}function lt(e){return e}function _e(e,t){return e==null||e===lt?t:function(o){return t(e(o))}}function Me(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function re(e,t){return e===he?t:function(){var o=e.apply(this,arguments),a=(o!==void 0&&(arguments[0]=o),this.onsuccess),l=this.onerror,f=(this.onsuccess=null,this.onerror=null,t.apply(this,arguments));return a&&(this.onsuccess=this.onsuccess?Me(a,this.onsuccess):a),l&&(this.onerror=this.onerror?Me(l,this.onerror):l),f!==void 0?f:o}}function de(e,t){return e===he?t:function(){e.apply(this,arguments);var o=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Me(o,this.onsuccess):o),a&&(this.onerror=this.onerror?Me(a,this.onerror):a)}}function Ae(e,t){return e===he?t:function(l){var a=e.apply(this,arguments),l=(g(l,a),this.onsuccess),f=this.onerror,d=(this.onsuccess=null,this.onerror=null,t.apply(this,arguments));return l&&(this.onsuccess=this.onsuccess?Me(l,this.onsuccess):l),f&&(this.onerror=this.onerror?Me(f,this.onerror):f),a===void 0?d===void 0?void 0:d:g(a,d)}}function we(e,t){return e===he?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Te(e,t){return e===he?t:function(){var o=e.apply(this,arguments);if(o&&typeof o.then=="function"){for(var a=this,l=arguments.length,f=new Array(l);l--;)f[l]=arguments[l];return o.then(function(){return t.apply(a,f)})}return t.apply(this,arguments)}}q.ModifyError=ft,q.DexieError=ke,q.BulkError=fe;var Xe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function vt(e){Xe=e}var yt={},bt=100,jt=typeof Promise>"u"?[]:(it=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[jt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),y(jt),it]:[it,y(it),it]),it=jt[0],Jr=jt[1],Jr=Jr&&Jr.then,Rt=it&&it.constructor,Cn=!!jt[2],Dr=function(e,t){or.push([e,t]),Tt&&(queueMicrotask(Ns),Tt=!1)},_t=!0,Tt=!0,It=[],hr=[],En=lt,St={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:he,pgp:!1,env:{},finalize:he},ne=St,or=[],Wt=0,Un=[];function W(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ne;if(typeof e!="function"){if(e!==yt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Ro(this,this._value)}else this._state=null,this._value=null,++t.ref,(function o(a,l){try{l(function(f){if(a._state===null){if(f===a)throw new TypeError("A promise cannot be resolved with itself.");var d=a._lib&&$r();f&&typeof f.then=="function"?o(a,function(v,w){f instanceof W?f._then(v,w):f.then(v,w)}):(a._state=!0,a._value=f,Ni(a)),d&&Hr()}},Ro.bind(null,a))}catch(f){Ro(a,f)}})(this,e)}var jo={get:function(){var e=ne,t=Yn;function o(a,l){var f=this,d=!e.global&&(e!==ne||t!==Yn),v=d&&!mr(),w=new W(function(P,x){To(f,new Ki(qi(a,e,d,v),qi(l,e,d,v),P,x,e))});return this._consoleTask&&(w._consoleTask=this._consoleTask),w}return o.prototype=yt,o},set:function(e){T(this,"then",e&&e.prototype===yt?jo:{get:function(){return e},set:jo.set})}};function Ki(e,t,o,a,l){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=o,this.reject=a,this.psd=l}function Ro(e,t){var o,a;hr.push(t),e._state===null&&(o=e._lib&&$r(),t=En(t),e._state=!1,e._value=t,a=e,It.some(function(l){return l._value===a._value})||It.push(a),Ni(e),o)&&Hr()}function Ni(e){var t=e._listeners;e._listeners=[];for(var o=0,a=t.length;o<a;++o)To(e,t[o]);var l=e._PSD;--l.ref||l.finalize(),Wt===0&&(++Wt,Dr(function(){--Wt==0&&Io()},[]))}function To(e,t){if(e._state===null)e._listeners.push(t);else{var o=e._state?t.onFulfilled:t.onRejected;if(o===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Wt,Dr(Ks,[o,e,t])}}function Ks(e,t,o){try{var a,l=t._value;!t._state&&hr.length&&(hr=[]),a=Xe&&t._consoleTask?t._consoleTask.run(function(){return e(l)}):e(l),t._state||hr.indexOf(l)!==-1||(f=>{for(var d=It.length;d;)if(It[--d]._value===f._value)return It.splice(d,1)})(t),o.resolve(a)}catch(f){o.reject(f)}finally{--Wt==0&&Io(),--o.psd.ref||o.psd.finalize()}}function Ns(){Mr(St,function(){$r()&&Hr()})}function $r(){var e=_t;return Tt=_t=!1,e}function Hr(){var e,t,o;do for(;0<or.length;)for(e=or,or=[],o=e.length,t=0;t<o;++t){var a=e[t];a[0].apply(null,a[1])}while(0<or.length);Tt=_t=!0}function Io(){for(var e=It,t=(It=[],e.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)}),Un.slice(0)),o=t.length;o;)t[--o]()}function Vn(e){return new W(yt,!1,e)}function rt(e,t){var o=ne;return function(){var a=$r(),l=ne;try{return gr(o,!0),e.apply(this,arguments)}catch(f){t&&t(f)}finally{gr(l,!1),a&&Hr()}}}A(W.prototype,{then:jo,_then:function(e,t){To(this,new Ki(null,null,e,t,ne))},catch:function(e){var t,o;return arguments.length===1?this.then(null,e):(t=e,o=arguments[1],typeof t=="function"?this.then(null,function(a){return(a instanceof t?o:Vn)(a)}):this.then(null,function(a){return(a&&a.name===t?o:Vn)(a)}))},finally:function(e){return this.then(function(t){return W.resolve(e()).then(function(){return t})},function(t){return W.resolve(e()).then(function(){return Vn(t)})})},timeout:function(e,t){var o=this;return e<1/0?new W(function(a,l){var f=setTimeout(function(){return l(new Y.Timeout(t))},e);o.then(a,l).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&T(W.prototype,Symbol.toStringTag,"Dexie.Promise"),St.env=Li(),A(W,{all:function(){var e=Ve.apply(null,arguments).map(Wn);return new W(function(t,o){e.length===0&&t([]);var a=e.length;e.forEach(function(l,f){return W.resolve(l).then(function(d){e[f]=d,--a||t(e)},o)})})},resolve:function(e){return e instanceof W?e:e&&typeof e.then=="function"?new W(function(t,o){e.then(t,o)}):new W(yt,!0,e)},reject:Vn,race:function(){var e=Ve.apply(null,arguments).map(Wn);return new W(function(t,o){e.map(function(a){return W.resolve(a).then(t,o)})})},PSD:{get:function(){return ne},set:function(e){return ne=e}},totalEchoes:{get:function(){return Yn}},newPSD:pr,usePSD:Mr,scheduler:{get:function(){return Dr},set:function(e){Dr=e}},rejectionMapper:{get:function(){return En},set:function(e){En=e}},follow:function(e,t){return new W(function(o,a){return pr(function(l,f){var d=ne;d.unhandleds=[],d.onunhandled=f,d.finalize=Me(function(){var v,w=this;v=function(){w.unhandleds.length===0?l():f(w.unhandleds[0])},Un.push(function P(){v(),Un.splice(Un.indexOf(P),1)}),++Wt,Dr(function(){--Wt==0&&Io()},[])},d.finalize),e()},t,o,a)})}}),Rt&&(Rt.allSettled&&T(W,"allSettled",function(){var e=Ve.apply(null,arguments).map(Wn);return new W(function(t){e.length===0&&t([]);var o=e.length,a=new Array(o);e.forEach(function(l,f){return W.resolve(l).then(function(d){return a[f]={status:"fulfilled",value:d}},function(d){return a[f]={status:"rejected",reason:d}}).then(function(){return--o||t(a)})})})}),Rt.any&&typeof AggregateError<"u"&&T(W,"any",function(){var e=Ve.apply(null,arguments).map(Wn);return new W(function(t,o){e.length===0&&o(new AggregateError([]));var a=e.length,l=new Array(a);e.forEach(function(f,d){return W.resolve(f).then(function(v){return t(v)},function(v){l[d]=v,--a||o(new AggregateError(l))})})})}),Rt.withResolvers)&&(W.withResolvers=Rt.withResolvers);var mt={awaits:0,echoes:0,id:0},Ls=0,$n=[],Hn=0,Yn=0,qs=0;function pr(e,d,o,a){var l=ne,f=Object.create(l),d=(f.parent=l,f.ref=0,f.global=!1,f.id=++qs,St.env,f.env=Cn?{Promise:W,PromiseProp:{value:W,configurable:!0,writable:!0},all:W.all,race:W.race,allSettled:W.allSettled,any:W.any,resolve:W.resolve,reject:W.reject}:{},d&&g(f,d),++l.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},Mr(f,e,o,a));return f.ref===0&&f.finalize(),d}function Yr(){return mt.id||(mt.id=++Ls),++mt.awaits,mt.echoes+=bt,mt.id}function mr(){return!!mt.awaits&&(--mt.awaits==0&&(mt.id=0),mt.echoes=mt.awaits*bt,!0)}function Wn(e){return mt.echoes&&e&&e.constructor===Rt?(Yr(),e.then(function(t){return mr(),t},function(t){return mr(),ut(t)})):e}function zs(){var e=$n[$n.length-1];$n.pop(),gr(e,!1)}function gr(e,t){var o,a,l=ne;(t?!mt.echoes||Hn++&&e===ne:!Hn||--Hn&&e===ne)||queueMicrotask(t?(function(f){++Yn,mt.echoes&&--mt.echoes!=0||(mt.echoes=mt.awaits=mt.id=0),$n.push(ne),gr(f,!0)}).bind(null,e):zs),e!==ne&&(ne=e,l===St&&(St.env=Li()),Cn)&&(o=St.env.Promise,a=e.env,l.global||e.global)&&(Object.defineProperty(u,"Promise",a.PromiseProp),o.all=a.all,o.race=a.race,o.resolve=a.resolve,o.reject=a.reject,a.allSettled&&(o.allSettled=a.allSettled),a.any)&&(o.any=a.any)}function Li(){var e=u.Promise;return Cn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Mr(e,t,o,a,l){var f=ne;try{return gr(e,!0),t(o,a,l)}finally{gr(f,!1)}}function qi(e,t,o,a){return typeof e!="function"?e:function(){var l=ne;o&&Yr(),gr(t,!0);try{return e.apply(this,arguments)}finally{gr(l,!1),a&&queueMicrotask(mr)}}}function Fo(e){Promise===Rt&&mt.echoes===0?Hn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Jr).indexOf("[native code]")===-1&&(Yr=mr=he);var ut=W.reject,jr="ï¿¿",ir="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zi="String expected.",Wr=[],Gn="__dbnames",Ko="readonly",No="readwrite";function Rr(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ui={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Xn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=J(t))[e],t}}function Vi(){throw Y.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ie(e,t){try{var o=$i(e),a=$i(t);if(o!==a)return o==="Array"?1:a==="Array"?-1:o==="binary"?1:a==="binary"?-1:o==="string"?1:a==="string"?-1:o==="Date"?1:a!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":for(var l=Hi(e),f=Hi(t),d=l.length,v=f.length,w=d<v?d:v,P=0;P<w;++P)if(l[P]!==f[P])return l[P]<f[P]?-1:1;return d===v?0:d<v?-1:1;case"Array":for(var x=e,b=t,C=x.length,E=b.length,k=C<E?C:E,_=0;_<k;++_){var D=Ie(x[_],b[_]);if(D!==0)return D}return C===E?0:C<E?-1:1}}catch{}return NaN}function $i(e){var t=typeof e;return t=="object"&&(ArrayBuffer.isView(e)||(t=Fe(e))==="ArrayBuffer")?"binary":t}function Hi(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Qn(e,t,o){var a=e.schema.yProps;return a?(t&&0<o.numFailures&&(t=t.filter(function(l,f){return!o.failures[f]})),Promise.all(a.map(function(l){return l=l.updatesTable,t?e.db.table(l).where("k").anyOf(t).delete():e.db.table(l).clear()})).then(function(){return o})):o}Yi.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var o=t.add;if(m(o))return c(c([],m(e)?e:[],!0),o).sort();if(typeof o=="number")return(Number(e)||0)+o;if(typeof o=="bigint")try{return BigInt(e)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(t.remove!==void 0){var a=t.remove;if(m(a))return m(e)?e.filter(function(l){return!a.includes(l)}).sort():[];if(typeof a=="number")return Number(e)-a;if(typeof a=="bigint")try{return BigInt(e)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return o=(o=t.replacePrefix)==null?void 0:o[0],o&&typeof e=="string"&&e.startsWith(o)?t.replacePrefix[1]+e.substring(o.length):e};var Sn=Yi;function Yi(e){this["@@propmod"]=e}function Wi(e,t){for(var o=p(t),a=o.length,l=!1,f=0;f<a;++f){var d=o[f],v=t[d],w=ie(e,d);v instanceof Sn?(ce(e,d,v.execute(w)),l=!0):w!==v&&(ce(e,d,v),l=!0)}return l}et.prototype._trans=function(e,t,o){var a=this._tx||ne.trans,l=this.name,f=Xe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function d(P,x,b){if(b.schema[l])return t(b.idbtrans,b);throw new Y.NotFound("Table "+l+" not part of transaction")}var v=$r();try{var w=a&&a.db._novip===this.db._novip?a===ne.trans?a._promise(e,d,o):pr(function(){return a._promise(e,d,o)},{trans:a,transless:ne.transless||ne}):(function P(x,b,C,E){if(x.idbdb&&(x._state.openComplete||ne.letThrough||x._vip)){var k=x._createTransaction(b,C,x._dbSchema);try{k.create(),x._state.PR1398_maxLoop=3}catch(_){return _.name===Re.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return P(x,b,C,E)})):ut(_)}return k._promise(b,function(_,D){return pr(function(){return ne.trans=k,E(_,D,k)})}).then(function(_){if(b==="readwrite")try{k.idbtrans.commit()}catch{}return b==="readonly"?_:k._completion.then(function(){return _})})}if(x._state.openComplete)return ut(new Y.DatabaseClosed(x._state.dbOpenError));if(!x._state.isBeingOpened){if(!x._state.autoOpen)return ut(new Y.DatabaseClosed);x.open().catch(he)}return x._state.dbReadyPromise.then(function(){return P(x,b,C,E)})})(this.db,e,[this.name],d);return f&&(w._consoleTask=f,w=w.catch(function(P){return console.trace(P),ut(P)})),w}finally{v&&Hr()}},et.prototype.get=function(e,t){var o=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?ut(new Y.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return o.core.get({trans:a,key:e}).then(function(l){return o.hook.reading.fire(l)})}).then(t)},et.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(m(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=p(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&t.every(function(P){return 0<=v.keyPath.indexOf(P)})){for(var w=0;w<t.length;++w)if(t.indexOf(v.keyPath[w])===-1)return!1;return!0}return!1}).sort(function(v,w){return v.keyPath.length-w.keyPath.length})[0];if(o&&this.db._maxKey!==jr)return d=o.keyPath.slice(0,t.length),this.where(d).equals(d.map(function(v){return e[v]}));!o&&Xe&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var a=this.schema.idxByName;function l(v,w){return Ie(v,w)===0}var d=t.reduce(function(x,w){var P=x[0],x=x[1],b=a[w],C=e[w];return[P||b,P||!b?Rr(x,b&&b.multi?function(E){return E=ie(E,w),m(E)&&E.some(function(k){return l(C,k)})}:function(E){return l(C,ie(E,w))}):x]},[null,null]),f=d[0],d=d[1];return f?this.where(f.name).equals(e[f.keyPath]).filter(d):o?this.filter(d):this.where(t).equals("")},et.prototype.filter=function(e){return this.toCollection().and(e)},et.prototype.count=function(e){return this.toCollection().count(e)},et.prototype.offset=function(e){return this.toCollection().offset(e)},et.prototype.limit=function(e){return this.toCollection().limit(e)},et.prototype.each=function(e){return this.toCollection().each(e)},et.prototype.toArray=function(e){return this.toCollection().toArray(e)},et.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},et.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,m(e)?"[".concat(e.join("+"),"]"):e))},et.prototype.reverse=function(){return this.toCollection().reverse()},et.prototype.mapToClass=function(e){for(var t=this.db,o=this.name,a=((this.schema.mappedClass=e).prototype instanceof Vi&&(e=(d=>{var v=x,w=d;if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");function P(){this.constructor=v}function x(){return d!==null&&d.apply(this,arguments)||this}return i(v,w),v.prototype=w===null?Object.create(w):(P.prototype=w.prototype,new P),Object.defineProperty(x.prototype,"db",{get:function(){return t},enumerable:!1,configurable:!0}),x.prototype.table=function(){return o},x})(e)),new Set),l=e.prototype;l;l=y(l))Object.getOwnPropertyNames(l).forEach(function(d){return a.add(d)});function f(d){if(!d)return d;var v,w=Object.create(e.prototype);for(v in d)if(!a.has(v))try{w[v]=d[v]}catch{}return w}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=f,this.hook("reading",f),e},et.prototype.defineClass=function(){return this.mapToClass(function(e){g(this,e)})},et.prototype.add=function(e,t){var o=this,a=this.schema.primKey,l=a.auto,f=a.keyPath,d=e;return f&&l&&(d=Xn(f)(e)),this._trans("readwrite",function(v){return o.core.mutate({trans:v,type:"add",keys:t!=null?[t]:null,values:[d]})}).then(function(v){return v.numFailures?W.reject(v.failures[0]):v.lastResult}).then(function(v){if(f)try{ce(e,f,v)}catch{}return v})},et.prototype.upsert=function(e,t){var o=this,a=this.schema.primKey.keyPath;return this._trans("readwrite",function(l){return o.core.get({trans:l,key:e}).then(function(f){var d=f??{};return Wi(d,t),a&&ce(d,a,e),o.core.mutate({trans:l,type:"put",values:[d],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(v){return v.numFailures?W.reject(v.failures[0]):!!f})})})},et.prototype.update=function(e,t){return typeof e!="object"||m(e)?this.where(":id").equals(e).modify(t):(e=ie(e,this.schema.primKey.keyPath))===void 0?ut(new Y.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},et.prototype.put=function(e,t){var o=this,a=this.schema.primKey,l=a.auto,f=a.keyPath,d=e;return f&&l&&(d=Xn(f)(e)),this._trans("readwrite",function(v){return o.core.mutate({trans:v,type:"put",values:[d],keys:t!=null?[t]:null})}).then(function(v){return v.numFailures?W.reject(v.failures[0]):v.lastResult}).then(function(v){if(f)try{ce(e,f,v)}catch{}return v})},et.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(o){return t.core.mutate({trans:o,type:"delete",keys:[e]}).then(function(a){return Qn(t,[e],a)}).then(function(a){return a.numFailures?W.reject(a.failures[0]):void 0})})},et.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ui}).then(function(o){return Qn(e,null,o)})}).then(function(t){return t.numFailures?W.reject(t.failures[0]):void 0})},et.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(o){return t.core.getMany({keys:e,trans:o}).then(function(a){return a.map(function(l){return t.hook.reading.fire(l)})})})},et.prototype.bulkAdd=function(e,t,o){var a=this,l=Array.isArray(t)?t:void 0,f=(o=o||(l?void 0:t))?o.allKeys:void 0;return this._trans("readwrite",function(d){var v=a.schema.primKey,P=v.auto,v=v.keyPath;if(v&&l)throw new Y.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(l&&l.length!==e.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var w=e.length,P=v&&P?e.map(Xn(v)):e;return a.core.mutate({trans:d,type:"add",keys:l,values:P,wantResults:f}).then(function(x){var b=x.numFailures,C=x.failures;if(b===0)return f?x.results:x.lastResult;throw new fe("".concat(a.name,".bulkAdd(): ").concat(b," of ").concat(w," operations failed"),C)})})},et.prototype.bulkPut=function(e,t,o){var a=this,l=Array.isArray(t)?t:void 0,f=(o=o||(l?void 0:t))?o.allKeys:void 0;return this._trans("readwrite",function(d){var v=a.schema.primKey,P=v.auto,v=v.keyPath;if(v&&l)throw new Y.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(l&&l.length!==e.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");var w=e.length,P=v&&P?e.map(Xn(v)):e;return a.core.mutate({trans:d,type:"put",keys:l,values:P,wantResults:f}).then(function(x){var b=x.numFailures,C=x.failures;if(b===0)return f?x.results:x.lastResult;throw new fe("".concat(a.name,".bulkPut(): ").concat(b," of ").concat(w," operations failed"),C)})})},et.prototype.bulkUpdate=function(e){var t=this,o=this.core,a=e.map(function(d){return d.key}),l=e.map(function(d){return d.changes}),f=[];return this._trans("readwrite",function(d){return o.getMany({trans:d,keys:a,cache:"clone"}).then(function(v){var w=[],P=[],x=(e.forEach(function(b,C){var E=b.key,k=b.changes,_=v[C];if(_){for(var D=0,M=Object.keys(k);D<M.length;D++){var O=M[D],I=k[O];if(O===t.schema.primKey.keyPath){if(Ie(I,E)!==0)throw new Y.Constraint("Cannot update primary key in bulkUpdate()")}else ce(_,O,I)}f.push(C),w.push(E),P.push(_)}}),w.length);return o.mutate({trans:d,type:"put",keys:w,values:P,updates:{keys:a,changeSpecs:l}}).then(function(b){var C=b.numFailures,E=b.failures;if(C===0)return x;for(var k=0,_=Object.keys(E);k<_.length;k++){var D,M=_[k],O=f[Number(M)];O!=null&&(D=E[M],delete E[M],E[O]=D)}throw new fe("".concat(t.name,".bulkUpdate(): ").concat(C," of ").concat(x," operations failed"),E)})})})},et.prototype.bulkDelete=function(e){var t=this,o=e.length;return this._trans("readwrite",function(a){return t.core.mutate({trans:a,type:"delete",keys:e}).then(function(l){return Qn(t,e,l)})}).then(function(a){var l=a.numFailures,f=a.failures;if(l===0)return a.lastResult;throw new fe("".concat(t.name,".bulkDelete(): ").concat(l," of ").concat(o," operations failed"),f)})};var Gi=et;function et(){}function An(e){function t(d,v){if(v){for(var w=arguments.length,P=new Array(w-1);--w;)P[w-1]=arguments[w];return o[d].subscribe.apply(null,P),e}if(typeof d=="string")return o[d]}var o={};t.addEventType=f;for(var a=1,l=arguments.length;a<l;++a)f(arguments[a]);return t;function f(d,v,w){var P,x;if(typeof d!="object")return v=v||we,x={subscribers:[],fire:w=w||he,subscribe:function(b){x.subscribers.indexOf(b)===-1&&(x.subscribers.push(b),x.fire=v(x.fire,b))},unsubscribe:function(b){x.subscribers=x.subscribers.filter(function(C){return C!==b}),x.fire=x.subscribers.reduce(v,w)}},o[d]=t[d]=x;p(P=d).forEach(function(b){var C=P[b];if(m(C))f(b,P[b][0],P[b][1]);else{if(C!=="asap")throw new Y.InvalidArgument("Invalid event config");var E=f(b,lt,function(){for(var k=arguments.length,_=new Array(k);k--;)_[k]=arguments[k];E.subscribers.forEach(function(D){X(function(){D.apply(null,_)})})})}})}}function On(e,t){return V(t).from({prototype:e}),t}function Gr(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Lo(e,t){e.filter=Rr(e.filter,t)}function qo(e,t,o){var a=e.replayFilter;e.replayFilter=a?function(){return Rr(a(),t())}:t,e.justLimit=o&&!a}function Jn(e,t){if(e.isPrimKey)return t.primaryKey;var o=t.getIndexByKeyPath(e.index);if(o)return o;throw new Y.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed")}function Xi(e,t,o){var a=Jn(e,t.schema);return t.openCursor({trans:o,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:a,range:e.range}})}function Zn(e,t,o,a){var l,f,d=e.replayFilter?Rr(e.filter,e.replayFilter()):e.filter;return e.or?(l={},f=function(v,w,P){var x,b;d&&!d(w,P,function(C){return w.stop(C)},function(C){return w.fail(C)})||((b=""+(x=w.primaryKey))=="[object ArrayBuffer]"&&(b=""+new Uint8Array(x)),S(l,b))||(l[b]=!0,t(v,w,P))},Promise.all([e.or._iterate(f,o),Qi(Xi(e,a,o),e.algorithm,f,!e.keysOnly&&e.valueMapper)])):Qi(Xi(e,a,o),Rr(e.algorithm,d),t,!e.keysOnly&&e.valueMapper)}function Qi(e,t,o,a){var l=rt(a?function(f,d,v){return o(a(f),d,v)}:o);return e.then(function(f){if(f)return f.start(function(){var d=function(){return f.continue()};t&&!t(f,function(v){return d=v},function(v){f.stop(v),d=he},function(v){f.fail(v),d=he})||l(f.value,f,function(v){return d=v}),d()})})}ze.prototype._read=function(e,t){var o=this._ctx;return o.error?o.table._trans(null,ut.bind(null,o.error)):o.table._trans("readonly",e).then(t)},ze.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,ut.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ze.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Rr(t.algorithm,e)},ze.prototype._iterate=function(e,t){return Zn(this._ctx,e,t,this._ctx.table.core)},ze.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return e&&g(o,e),t._ctx=o,t},ze.prototype.raw=function(){return this._ctx.valueMapper=null,this},ze.prototype.each=function(e){var t=this._ctx;return this._read(function(o){return Zn(t,e,o,t.table.core)})},ze.prototype.count=function(e){var t=this;return this._read(function(o){var a,l=t._ctx,f=l.table.core;return Gr(l,!0)?f.count({trans:o,query:{index:Jn(l,f.schema),range:l.range}}).then(function(d){return Math.min(d,l.limit)}):(a=0,Zn(l,function(){return++a,!1},o,f).then(function(){return a}))}).then(e)},ze.prototype.sortBy=function(e,t){var o=e.split(".").reverse(),a=o[0],l=o.length-1;function f(w,P){return P?f(w[o[P]],P-1):w[a]}var d=this._ctx.dir==="next"?1:-1;function v(w,P){return Ie(f(w,l),f(P,l))*d}return this.toArray(function(w){return w.sort(v)}).then(t)},ze.prototype.toArray=function(e){var t=this;return this._read(function(o){var a,l,f,d=t._ctx;return d.dir==="next"&&Gr(d,!0)&&0<d.limit?(a=d.valueMapper,l=Jn(d,d.table.core.schema),d.table.core.query({trans:o,limit:d.limit,values:!0,query:{index:l,range:d.range}}).then(function(v){return v=v.result,a?v.map(a):v})):(f=[],Zn(d,function(v){return f.push(v)},o,d.table.core).then(function(){return f}))},e)},ze.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Gr(t)?qo(t,function(){var o=e;return function(a,l){return o===0||(o===1?--o:l(function(){a.advance(o),o=0}),!1)}}):qo(t,function(){var o=e;return function(){return--o<0}})),this},ze.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),qo(this._ctx,function(){var t=e;return function(o,a,l){return--t<=0&&a(l),0<=t}},!0),this},ze.prototype.until=function(e,t){return Lo(this._ctx,function(o,a,l){return!e(o.value)||(a(l),t)}),this},ze.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},ze.prototype.last=function(e){return this.reverse().first(e)},ze.prototype.filter=function(e){var t;return Lo(this._ctx,function(o){return e(o.value)}),(t=this._ctx).isMatch=Rr(t.isMatch,e),this},ze.prototype.and=function(e){return this.filter(e)},ze.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ze.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ze.prototype.desc=function(){return this.reverse()},ze.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(o,a){e(a.key,a)})},ze.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ze.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(o,a){e(a.primaryKey,a)})},ze.prototype.keys=function(e){var t=this._ctx,o=(t.keysOnly=!t.isMatch,[]);return this.each(function(a,l){o.push(l.key)}).then(function(){return o}).then(e)},ze.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Gr(t,!0)&&0<t.limit)return this._read(function(a){var l=Jn(t,t.table.core.schema);return t.table.core.query({trans:a,values:!1,limit:t.limit,query:{index:l,range:t.range}})}).then(function(a){return a.result}).then(e);t.keysOnly=!t.isMatch;var o=[];return this.each(function(a,l){o.push(l.primaryKey)}).then(function(){return o}).then(e)},ze.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ze.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},ze.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ze.prototype.distinct=function(){var e,t=this._ctx,t=t.index&&t.table.schema.idxByName[t.index];return t&&t.multi&&(e={},Lo(this._ctx,function(a){var a=a.primaryKey.toString(),l=S(e,a);return e[a]=!0,!l})),this},ze.prototype.modify=function(e){var t=this,o=this._ctx;return this._write(function(a){function l(_,D){var M=D.failures;C+=_-D.numFailures;for(var O=0,I=p(M);O<I.length;O++){var N=I[O];b.push(M[N])}}var f=typeof e=="function"?e:function(_){return Wi(_,e)},d=o.table.core,x=d.schema.primaryKey,v=x.outbound,w=x.extractKey,P=200,x=t.db._options.modifyChunkSize,b=(x&&(P=typeof x=="object"?x[d.name]||x["*"]||200:x),[]),C=0,E=[],k=e===Ji;return t.clone().primaryKeys().then(function(_){function D(O){var I=Math.min(P,_.length-O),N=_.slice(O,O+I);return(k?Promise.resolve([]):d.getMany({trans:a,keys:N,cache:"immutable"})).then(function($){var H=[],L=[],Z=v?[]:null,G=k?N:[];if(!k)for(var U=0;U<I;++U){var te=$[U],Ke={value:J(te),primKey:_[O+U]};f.call(Ke,Ke.value,Ke)!==!1&&(Ke.value==null?G.push(_[O+U]):v||Ie(w(te),w(Ke.value))===0?(L.push(Ke.value),v&&Z.push(_[O+U])):(G.push(_[O+U]),H.push(Ke.value)))}return Promise.resolve(0<H.length&&d.mutate({trans:a,type:"add",values:H}).then(function(Ue){for(var ye in Ue.failures)G.splice(parseInt(ye),1);l(H.length,Ue)})).then(function(){return(0<L.length||M&&typeof e=="object")&&d.mutate({trans:a,type:"put",keys:Z,values:L,criteria:M,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<O}).then(function(Ue){return l(L.length,Ue)})}).then(function(){return(0<G.length||M&&k)&&d.mutate({trans:a,type:"delete",keys:G,criteria:M,isAdditionalChunk:0<O}).then(function(Ue){return Qn(o.table,G,Ue)}).then(function(Ue){return l(G.length,Ue)})}).then(function(){return _.length>O+I&&D(O+P)})})}var M=Gr(o)&&o.limit===1/0&&(typeof e!="function"||k)&&{index:o.index,range:o.range};return D(0).then(function(){if(0<b.length)throw new ft("Error modifying one or more objects",b,C,E);return _.length})})})},ze.prototype.delete=function(){var e=this._ctx,t=e.range;return!Gr(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Ji):this._write(function(o){var a=e.table.core.schema.primaryKey,l=t;return e.table.core.count({trans:o,query:{index:a,range:l}}).then(function(f){return e.table.core.mutate({trans:o,type:"deleteRange",range:l}).then(function(w){var v=w.failures,w=w.numFailures;if(w)throw new ft("Could not delete some values",Object.keys(v).map(function(P){return v[P]}),f-w);return f-w})})})};var Us=ze;function ze(){}var Ji=function(e,t){return t.value=null};function Vs(e,t){return e<t?-1:e===t?0:1}function $s(e,t){return t<e?-1:e===t?0:1}function Ft(e,t,o){return e=e instanceof ea?new e.Collection(e):e,e._ctx.error=new(o||TypeError)(t),e}function Xr(e){return new e.Collection(e,function(){return Zi("")}).limit(0)}function eo(E,t,o,a){var l,f,d,v,w,P,x,b=o.length;if(!o.every(function(_){return typeof _=="string"}))return Ft(E,zi);function C(_){l=_==="next"?function(M){return M.toUpperCase()}:function(M){return M.toLowerCase()},f=_==="next"?function(M){return M.toLowerCase()}:function(M){return M.toUpperCase()},d=_==="next"?Vs:$s;var D=o.map(function(M){return{lower:f(M),upper:l(M)}}).sort(function(M,O){return d(M.lower,O.lower)});v=D.map(function(M){return M.upper}),w=D.map(function(M){return M.lower}),x=(P=_)==="next"?"":a}C("next");var E=new E.Collection(E,function(){return yr(v[0],w[b-1]+a)}),k=(E._ondirectionchange=function(_){C(_)},0);return E._addAlgorithm(function(_,D,M){var O=_.key;if(typeof O=="string"){var I=f(O);if(t(I,w,k))return!0;for(var N=null,$=k;$<b;++$){var H=((L,Z,G,U,te,Ke)=>{for(var Ue=Math.min(L.length,U.length),ye=-1,Ee=0;Ee<Ue;++Ee){var nt=Z[Ee];if(nt!==U[Ee])return te(L[Ee],G[Ee])<0?L.substr(0,Ee)+G[Ee]+G.substr(Ee+1):te(L[Ee],U[Ee])<0?L.substr(0,Ee)+U[Ee]+G.substr(Ee+1):0<=ye?L.substr(0,ye)+Z[ye]+G.substr(ye+1):null;te(L[Ee],nt)<0&&(ye=Ee)}return Ue<U.length&&Ke==="next"?L+G.substr(L.length):Ue<L.length&&Ke==="prev"?L.substr(0,G.length):ye<0?null:L.substr(0,ye)+U[ye]+G.substr(ye+1)})(O,I,v[$],w[$],d,P);H===null&&N===null?k=$+1:(N===null||0<d(N,H))&&(N=H)}D(N!==null?function(){_.continue(N+x)}:M)}return!1}),E}function yr(e,t,o,a){return{type:2,lower:e,upper:t,lowerOpen:o,upperOpen:a}}function Zi(e){return{type:1,lower:e,upper:e}}Object.defineProperty(gt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),gt.prototype.between=function(e,t,o,a){o=o!==!1,a=a===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(o||a)&&(!o||!a)?Xr(this):new this.Collection(this,function(){return yr(e,t,!o,!a)})}catch{return Ft(this,ir)}},gt.prototype.equals=function(e){return e==null?Ft(this,ir):new this.Collection(this,function(){return Zi(e)})},gt.prototype.above=function(e){return e==null?Ft(this,ir):new this.Collection(this,function(){return yr(e,void 0,!0)})},gt.prototype.aboveOrEqual=function(e){return e==null?Ft(this,ir):new this.Collection(this,function(){return yr(e,void 0,!1)})},gt.prototype.below=function(e){return e==null?Ft(this,ir):new this.Collection(this,function(){return yr(void 0,e,!1,!0)})},gt.prototype.belowOrEqual=function(e){return e==null?Ft(this,ir):new this.Collection(this,function(){return yr(void 0,e)})},gt.prototype.startsWith=function(e){return typeof e!="string"?Ft(this,zi):this.between(e,e+jr,!0,!0)},gt.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):eo(this,function(t,o){return t.indexOf(o[0])===0},[e],jr)},gt.prototype.equalsIgnoreCase=function(e){return eo(this,function(t,o){return t===o[0]},[e],"")},gt.prototype.anyOfIgnoreCase=function(){var e=Ve.apply(Ce,arguments);return e.length===0?Xr(this):eo(this,function(t,o){return o.indexOf(t)!==-1},e,"")},gt.prototype.startsWithAnyOfIgnoreCase=function(){var e=Ve.apply(Ce,arguments);return e.length===0?Xr(this):eo(this,function(t,o){return o.some(function(a){return t.indexOf(a)===0})},e,jr)},gt.prototype.anyOf=function(){var e,t,o=this,a=Ve.apply(Ce,arguments),l=this._cmp;try{a.sort(l)}catch{return Ft(this,ir)}return a.length===0?Xr(this):((e=new this.Collection(this,function(){return yr(a[0],a[a.length-1])}))._ondirectionchange=function(f){l=f==="next"?o._ascending:o._descending,a.sort(l)},t=0,e._addAlgorithm(function(f,d,v){for(var w=f.key;0<l(w,a[t]);)if(++t===a.length)return d(v),!1;return l(w,a[t])===0||(d(function(){f.continue(a[t])}),!1)}),e)},gt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},gt.prototype.noneOf=function(){var e=Ve.apply(Ce,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Ft(this,ir)}var t=e.reduce(function(o,a){return o?o.concat([[o[o.length-1][1],a]]):[[-1/0,a]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},gt.prototype.inAnyRange=function(e,M){var o=this,a=this._cmp,l=this._ascending,f=this._descending,d=this._min,v=this._max;if(e.length===0)return Xr(this);if(!e.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&l(O[0],O[1])<=0}))return Ft(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Y.InvalidArgument);var w=!M||M.includeLowers!==!1,P=M&&M.includeUppers===!0,x,b=l;function C(O,I){return b(O[0],I[0])}try{(x=e.reduce(function(O,I){for(var N=0,$=O.length;N<$;++N){var H=O[N];if(a(I[0],H[1])<0&&0<a(I[1],H[0])){H[0]=d(H[0],I[0]),H[1]=v(H[1],I[1]);break}}return N===$&&O.push(I),O},[])).sort(C)}catch{return Ft(this,ir)}var E=0,k=P?function(O){return 0<l(O,x[E][1])}:function(O){return 0<=l(O,x[E][1])},_=w?function(O){return 0<f(O,x[E][0])}:function(O){return 0<=f(O,x[E][0])},D=k,M=new this.Collection(this,function(){return yr(x[0][0],x[x.length-1][1],!w,!P)});return M._ondirectionchange=function(O){b=O==="next"?(D=k,l):(D=_,f),x.sort(C)},M._addAlgorithm(function(O,I,N){for(var $,H=O.key;D(H);)if(++E===x.length)return I(N),!1;return!k($=H)&&!_($)||(o._cmp(H,x[E][1])===0||o._cmp(H,x[E][0])===0||I(function(){b===l?O.continue(x[E][0]):O.continue(x[E][1])}),!1)}),M},gt.prototype.startsWithAnyOf=function(){var e=Ve.apply(Ce,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Xr(this):this.inAnyRange(e.map(function(t){return[t,t+jr]})):Ft(this,"startsWithAnyOf() only works with strings")};var ea=gt;function gt(){}function Zt(e){return rt(function(t){return Pn(t),e(t.target.error),!1})}function Pn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Bn="storagemutated",zo="x-storagemutated-1",br=An(null,Bn),Hs=(er.prototype._lock=function(){return be(!ne.global),++this._reculock,this._reculock!==1||ne.global||(ne.lockOwnerFor=this),this},er.prototype._unlock=function(){if(be(!ne.global),--this._reculock==0)for(ne.global||(ne.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Mr(e[1],e[0])}catch{}}return this},er.prototype._locked=function(){return this._reculock&&ne.lockOwnerFor!==this},er.prototype.create=function(e){var t=this;if(this.mode){var o=this.db.idbdb,a=this.db._state.dbOpenError;if(be(!this.idbtrans),!e&&!o)switch(a&&a.name){case"DatabaseClosedError":throw new Y.DatabaseClosed(a);case"MissingAPIError":throw new Y.MissingAPI(a.message,a);default:throw new Y.OpenFailed(a)}if(!this.active)throw new Y.TransactionInactive;be(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||o).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=rt(function(l){Pn(l),t._reject(e.error)}),e.onabort=rt(function(l){Pn(l),t.active&&t._reject(new Y.Abort(e.error)),t.active=!1,t.on("abort").fire(l)}),e.oncomplete=rt(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&br.storagemutated.fire(e.mutatedParts)})}return this},er.prototype._promise=function(e,t,o){var a,l=this;return e==="readwrite"&&this.mode!=="readwrite"?ut(new Y.ReadOnly("Transaction is readonly")):this.active?this._locked()?new W(function(f,d){l._blockedFuncs.push([function(){l._promise(e,t,o).then(f,d)},ne])}):o?pr(function(){var f=new W(function(d,v){l._lock();var w=t(d,v,l);w&&w.then&&w.then(d,v)});return f.finally(function(){return l._unlock()}),f._lib=!0,f}):((a=new W(function(f,d){var v=t(f,d,l);v&&v.then&&v.then(f,d)}))._lib=!0,a):ut(new Y.TransactionInactive)},er.prototype._root=function(){return this.parent?this.parent._root():this},er.prototype.waitFor=function(e){var t,o=this._root(),a=W.resolve(e),l=(o._waitingFor?o._waitingFor=o._waitingFor.then(function(){return a}):(o._waitingFor=a,o._waitingQueue=[],t=o.idbtrans.objectStore(o.storeNames[0]),(function f(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(t.get(-1/0).onsuccess=f)})()),o._waitingFor);return new W(function(f,d){a.then(function(v){return o._waitingQueue.push(rt(f.bind(null,v)))},function(v){return o._waitingQueue.push(rt(d.bind(null,v)))}).finally(function(){o._waitingFor===l&&(o._waitingFor=null)})})},er.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Y.Abort))},er.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(S(t,e))return t[e];var o=this.schema[e];if(o)return(o=new this.db.Table(e,o,this)).core=this.db.core.table(e),t[e]=o;throw new Y.NotFound("Table "+e+" not part of transaction")},er);function er(){}function Uo(e,t,o,a,l,f,d,v){return{name:e,keyPath:t,unique:o,multi:a,auto:l,compound:f,src:(o&&!d?"&":"")+(a?"*":"")+(l?"++":"")+ta(t),type:v}}function ta(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Vo(e,t,o){return{name:e,primKey:t,indexes:o,mappedClass:null,idxByName:(a=function(l){return[l.name,l]},o.reduce(function(l,f,d){return f=a(f,d),f&&(l[f[0]]=f[1]),l},{}))};var a}var Dn=function(e){try{return e.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return jr},jr}};function $o(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(o){return o[t]}:function(o){return ie(o,t)}:function(o){return ie(o,e)};var t}function ra(e){return[].slice.call(e)}var Ys=0;function Mn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Ws(e,t,w){function a(k){if(k.type===3)return null;if(k.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=k.lower,C=k.upper,E=k.lowerOpen,k=k.upperOpen;return b===void 0?C===void 0?null:t.upperBound(C,!!k):C===void 0?t.lowerBound(b,!!E):t.bound(b,C,!!E,!!k)}function l(x){var b,C=x.name;return{name:C,schema:x,mutate:function(E){var k=E.trans,_=E.type,D=E.keys,M=E.values,O=E.range;return new Promise(function(I,N){I=rt(I);var $=k.objectStore(C),H=$.keyPath==null,L=_==="put"||_==="add";if(!L&&_!=="delete"&&_!=="deleteRange")throw new Error("Invalid operation type: "+_);var Z,G=(D||M||{length:1}).length;if(D&&M&&D.length!==M.length)throw new Error("Given keys array must have same length as given values array.");if(G===0)return I({numFailures:0,failures:{},results:[],lastResult:void 0});function U(at){++Ue,Pn(at)}var te=[],Ke=[],Ue=0;if(_==="deleteRange"){if(O.type===4)return I({numFailures:Ue,failures:Ke,results:[],lastResult:void 0});O.type===3?te.push(Z=$.clear()):te.push(Z=$.delete(a(O)))}else{var H=L?H?[M,D]:[M,null]:[D,null],ye=H[0],Ee=H[1];if(L)for(var nt=0;nt<G;++nt)te.push(Z=Ee&&Ee[nt]!==void 0?$[_](ye[nt],Ee[nt]):$[_](ye[nt])),Z.onerror=U;else for(nt=0;nt<G;++nt)te.push(Z=$[_](ye[nt])),Z.onerror=U}function qt(at){at=at.target.result,te.forEach(function(Fr,ui){return Fr.error!=null&&(Ke[ui]=Fr.error)}),I({numFailures:Ue,failures:Ke,results:_==="delete"?D:te.map(function(Fr){return Fr.result}),lastResult:at})}Z.onerror=function(at){U(at),qt(at)},Z.onsuccess=qt})},getMany:function(E){var k=E.trans,_=E.keys;return new Promise(function(D,M){D=rt(D);for(var O,I=k.objectStore(C),N=_.length,$=new Array(N),H=0,L=0,Z=function(te){te=te.target,$[te._pos]=te.result,++L===H&&D($)},G=Zt(M),U=0;U<N;++U)_[U]!=null&&((O=I.get(_[U]))._pos=U,O.onsuccess=Z,O.onerror=G,++H);H===0&&D($)})},get:function(E){var k=E.trans,_=E.key;return new Promise(function(D,M){D=rt(D);var O=k.objectStore(C).get(_);O.onsuccess=function(I){return D(I.target.result)},O.onerror=Zt(M)})},query:(b=v,function(E){return new Promise(function(k,_){k=rt(k);var D,M,O,L=E.trans,I=E.values,N=E.limit,H=E.query,$=N===1/0?void 0:N,Z=H.index,H=H.range,L=L.objectStore(C),L=Z.isPrimaryKey?L:L.index(Z.name),Z=a(H);if(N===0)return k({result:[]});b?((H=I?L.getAll(Z,$):L.getAllKeys(Z,$)).onsuccess=function(G){return k({result:G.target.result})},H.onerror=Zt(_)):(D=0,M=!I&&"openKeyCursor"in L?L.openKeyCursor(Z):L.openCursor(Z),O=[],M.onsuccess=function(G){var U=M.result;return!U||(O.push(I?U.value:U.primaryKey),++D===N)?k({result:O}):void U.continue()},M.onerror=Zt(_))})}),openCursor:function(E){var k=E.trans,_=E.values,D=E.query,M=E.reverse,O=E.unique;return new Promise(function(I,N){I=rt(I);var L=D.index,$=D.range,H=k.objectStore(C),H=L.isPrimaryKey?H:H.index(L.name),L=M?O?"prevunique":"prev":O?"nextunique":"next",Z=!_&&"openKeyCursor"in H?H.openKeyCursor(a($),L):H.openCursor(a($),L);Z.onerror=Zt(N),Z.onsuccess=rt(function(G){var U,te,Ke,Ue,ye=Z.result;ye?(ye.___id=++Ys,ye.done=!1,U=ye.continue.bind(ye),te=(te=ye.continuePrimaryKey)&&te.bind(ye),Ke=ye.advance.bind(ye),Ue=function(){throw new Error("Cursor not stopped")},ye.trans=k,ye.stop=ye.continue=ye.continuePrimaryKey=ye.advance=function(){throw new Error("Cursor not started")},ye.fail=rt(N),ye.next=function(){var Ee=this,nt=1;return this.start(function(){return nt--?Ee.continue():Ee.stop()}).then(function(){return Ee})},ye.start=function(Ee){function nt(){if(Z.result)try{Ee()}catch(at){ye.fail(at)}else ye.done=!0,ye.start=function(){throw new Error("Cursor behind last entry")},ye.stop()}var qt=new Promise(function(at,Fr){at=rt(at),Z.onerror=Zt(Fr),ye.fail=Fr,ye.stop=function(ui){ye.stop=ye.continue=ye.continuePrimaryKey=ye.advance=Ue,at(ui)}});return Z.onsuccess=rt(function(at){Z.onsuccess=nt,nt()}),ye.continue=U,ye.continuePrimaryKey=te,ye.advance=Ke,nt(),qt},I(ye)):I(null)},N)})},count:function(E){var k=E.query,_=E.trans,D=k.index,M=k.range;return new Promise(function(O,I){var N=_.objectStore(C),N=D.isPrimaryKey?N:N.index(D.name),$=a(M),$=$?N.count($):N.count();$.onsuccess=rt(function(H){return O(H.target.result)}),$.onerror=Zt(I)})}}}f=w,d=ra((w=e).objectStoreNames);var f,w={schema:{name:w.name,tables:d.map(function(x){return f.objectStore(x)}).map(function(x){var b=x.keyPath,C=x.autoIncrement,k=m(b),E={},k={name:x.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:k,keyPath:b,autoIncrement:C,unique:!0,extractKey:$o(b)},indexes:ra(x.indexNames).map(function(_){return x.index(_)}).map(function(O){var I=O.name,D=O.unique,M=O.multiEntry,O=O.keyPath,I={name:I,compound:m(O),keyPath:O,unique:D,multiEntry:M,extractKey:$o(O)};return E[Mn(O)]=I}),getIndexByKeyPath:function(_){return E[Mn(_)]}};return E[":id"]=k.primaryKey,b!=null&&(E[Mn(b)]=k.primaryKey),k})},hasGetAll:0<d.length&&"getAll"in f.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},d=w.schema,v=w.hasGetAll,w=d.tables.map(l),P={};return w.forEach(function(x){return P[x.name]=x}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(x){if(P[x])return P[x];throw new Error("Table '".concat(x,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Dn(t),schema:d}}function Gs(e,t,o,a){return o=o.IDBKeyRange,t=Ws(t,o,a),{dbcore:e.dbcore.reduce(function(l,f){return f=f.create,s(s({},l),f(l))},t)}}function to(e,t){var o=t.db,o=Gs(e._middlewares,o,e._deps,t);e.core=o.dbcore,e.tables.forEach(function(a){var l=a.name;e.core.schema.tables.some(function(f){return f.name===l})&&(a.core=e.core.table(l),e[l]instanceof e.Table)&&(e[l].core=a.core)})}function ro(e,t,o,a){o.forEach(function(l){var f=a[l];t.forEach(function(d){var v=(function w(P,x){return ee(P,x)||(P=y(P))&&w(P,x)})(d,l);(!v||"value"in v&&v.value===void 0)&&(d===e.Transaction.prototype||d instanceof e.Transaction?T(d,l,{get:function(){return this.table(l)},set:function(w){F(this,l,{value:w,writable:!0,configurable:!0,enumerable:!0})}}):d[l]=new e.Table(l,f))})})}function Ho(e,t){t.forEach(function(o){for(var a in o)o[a]instanceof e.Table&&delete o[a]})}function Xs(e,t){return e._cfg.version-t._cfg.version}function Qs(e,t,o,a){var l=e._dbSchema,f=(o.objectStoreNames.contains("$meta")&&!l.$meta&&(l.$meta=Vo("$meta",oa("")[0],[]),e._storeNames.push("$meta")),e._createTransaction("readwrite",e._storeNames,l)),d=(f.create(o),f._completion.catch(a),f._reject.bind(f)),v=ne.transless||ne;pr(function(){if(ne.trans=f,ne.transless=v,t!==0)return to(e,o),P=t,((w=f).storeNames.includes("$meta")?w.table("$meta").get("version").then(function(x){return x??P}):W.resolve(P)).then(function(D){var b=e,C=D,E=f,k=o,_=[],D=b._versions,M=b._dbSchema=oo(0,b.idbdb,k);return(D=D.filter(function(O){return O._cfg.version>=C})).length===0?W.resolve():(D.forEach(function(O){_.push(function(){var I,N,$,H=M,L=O._cfg.dbschema,Z=(io(b,H,k),io(b,L,k),M=b._dbSchema=L,Yo(H,L)),G=(Z.add.forEach(function(U){Wo(k,U[0],U[1].primKey,U[1].indexes)}),Z.change.forEach(function(U){if(U.recreate)throw new Y.Upgrade("Not yet support for changing primary key");var te=k.objectStore(U.name);U.add.forEach(function(Ke){return no(te,Ke)}),U.change.forEach(function(Ke){te.deleteIndex(Ke.name),no(te,Ke)}),U.del.forEach(function(Ke){return te.deleteIndex(Ke)})}),O._cfg.contentUpgrade);if(G&&O._cfg.version>C)return to(b,k),E._memoizedTables={},I=le(L),Z.del.forEach(function(U){I[U]=H[U]}),Ho(b,[b.Transaction.prototype]),ro(b,[b.Transaction.prototype],p(I),I),E.schema=I,(N=ot(G))&&Yr(),L=W.follow(function(){var U;($=G(E))&&N&&(U=mr.bind(null,null),$.then(U,U))}),$&&typeof $.then=="function"?W.resolve($):L.then(function(){return $})}),_.push(function(I){var N,$,H=O._cfg.dbschema;N=H,$=I,[].slice.call($.db.objectStoreNames).forEach(function(L){return N[L]==null&&$.db.deleteObjectStore(L)}),Ho(b,[b.Transaction.prototype]),ro(b,[b.Transaction.prototype],b._storeNames,b._dbSchema),E.schema=b._dbSchema}),_.push(function(I){b.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(b.idbdb.version/10)===O._cfg.version?(b.idbdb.deleteObjectStore("$meta"),delete b._dbSchema.$meta,b._storeNames=b._storeNames.filter(function(N){return N!=="$meta"})):I.objectStore("$meta").put(O._cfg.version,"version"))})}),(function O(){return _.length?W.resolve(_.shift()(E.idbtrans)).then(O):W.resolve()})().then(function(){na(M,k)}))}).catch(d);var w,P;p(l).forEach(function(x){Wo(o,x,l[x].primKey,l[x].indexes)}),to(e,o),W.follow(function(){return e.on.populate.fire(f)}).catch(d)})}function Js(e,t){na(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var o=oo(0,e.idbdb,t);io(e,e._dbSchema,t);for(var a=0,l=Yo(o,e._dbSchema).change;a<l.length;a++){var f=(d=>{if(d.change.length||d.recreate)return console.warn("Unable to patch indexes of table ".concat(d.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=t.objectStore(d.name);d.add.forEach(function(w){Xe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(d.name,".").concat(w.src)),no(v,w)})})(l[a]);if(typeof f=="object")return f.value}}function Yo(e,t){var o,a={del:[],add:[],change:[]};for(o in e)t[o]||a.del.push(o);for(o in t){var l=e[o],f=t[o];if(l){var d={name:o,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(l.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||l.primKey.auto!==f.primKey.auto)d.recreate=!0,a.change.push(d);else{var v=l.idxByName,w=f.idxByName,P=void 0;for(P in v)w[P]||d.del.push(P);for(P in w){var x=v[P],b=w[P];x?x.src!==b.src&&d.change.push(b):d.add.push(b)}(0<d.del.length||0<d.add.length||0<d.change.length)&&a.change.push(d)}}else a.add.push([o,f])}return a}function Wo(e,t,o,a){var l=e.db.createObjectStore(t,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});a.forEach(function(f){return no(l,f)})}function na(e,t){p(e).forEach(function(o){t.db.objectStoreNames.contains(o)||(Xe&&console.debug("Dexie: Creating missing table",o),Wo(t,o,e[o].primKey,e[o].indexes))})}function no(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function oo(e,t,o){var a={};return ve(t.objectStoreNames,0).forEach(function(l){for(var f=o.objectStore(l),d=Uo(ta(P=f.keyPath),P||"",!0,!1,!!f.autoIncrement,P&&typeof P!="string",!0),v=[],w=0;w<f.indexNames.length;++w){var x=f.index(f.indexNames[w]),P=x.keyPath,x=Uo(x.name,P,!!x.unique,!!x.multiEntry,!1,P&&typeof P!="string",!1);v.push(x)}a[l]=Vo(l,d,v)}),a}function io(e,t,o){for(var a=o.db.objectStoreNames,l=0;l<a.length;++l){var f=a[l],d=o.objectStore(f);e._hasGetAll="getAll"in d;for(var v=0;v<d.indexNames.length;++v){var w,P=d.indexNames[v],x=d.index(P).keyPath,x=typeof x=="string"?x:"["+ve(x).join("+")+"]";t[f]&&(w=t[f].idxByName[x])&&(w.name=P,delete t[f].idxByName[x],t[f].idxByName[P]=w)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function oa(e){return e.split(",").map(function(t,o){var l=t.split(":"),a=(a=l[1])==null?void 0:a.trim(),l=(t=l[0].trim()).replace(/([&*]|\+\+)/g,""),f=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Uo(l,f||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),m(f),o===0,a)})}Qr.prototype._createTableSchema=Vo,Qr.prototype._parseIndexSyntax=oa,Qr.prototype._parseStoresSpec=function(e,t){var o=this;p(e).forEach(function(a){if(e[a]!==null){var l=o._parseIndexSyntax(e[a]),f=l.shift();if(!f)throw new Y.Schema("Invalid schema for table "+a+": "+e[a]);if(f.unique=!0,f.multi)throw new Y.Schema("Primary key cannot be multiEntry*");l.forEach(function(d){if(d.auto)throw new Y.Schema("Only primary key can be marked as autoIncrement (++)");if(!d.keyPath)throw new Y.Schema("Index must have a name and cannot be an empty string")}),f=o._createTableSchema(a,f,l),t[a]=f}})},Qr.prototype.stores=function(o){var t=this.db,o=(this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,o):o,t._versions),a={},l={};return o.forEach(function(f){g(a,f._cfg.storesSource),l=f._cfg.dbschema={},f._parseStoresSpec(a,l)}),t._dbSchema=l,Ho(t,[t._allTables,t,t.Transaction.prototype]),ro(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],p(l),l),t._storeNames=p(l),this},Qr.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Te(this._cfg.contentUpgrade||he,e),this};var Zs=Qr;function Qr(){}function Go(e,t){var o=e._dbNamesDB;return o||(o=e._dbNamesDB=new ar(Gn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),o.table("dbnames")}function Xo(e){return e&&typeof e.databases=="function"}function Qo(e){return pr(function(){return ne.letThrough=!0,e()})}function Jo(e){return!("from"in e)}var Ct=function(e,t){var o;if(!this)return o=new Ct,e&&"d"in e&&g(o,e),o;g(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function jn(e,t,o){var a=Ie(t,o);if(!isNaN(a)){if(0<a)throw RangeError();if(Jo(e))return g(e,{from:t,to:o,d:1});var a=e.l,l=e.r;if(Ie(o,e.from)<0)return a?jn(a,t,o):e.l={from:t,to:o,d:1,l:null,r:null},aa(e);if(0<Ie(t,e.to))return l?jn(l,t,o):e.r={from:t,to:o,d:1,l:null,r:null},aa(e);Ie(t,e.from)<0&&(e.from=t,e.l=null,e.d=l?l.d+1:1),0<Ie(o,e.to)&&(e.to=o,e.r=null,e.d=e.l?e.l.d+1:1),t=!e.r,a&&!e.l&&Rn(e,a),l&&t&&Rn(e,l)}}function Rn(e,t){Jo(t)||(function o(a,l){var f=l.from,d=l.l,v=l.r;jn(a,f,l.to),d&&o(a,d),v&&o(a,v)})(e,t)}function ia(e,t){var o=ao(t),a=o.next();if(!a.done)for(var l=a.value,f=ao(e),d=f.next(l.from),v=d.value;!a.done&&!d.done;){if(Ie(v.from,l.to)<=0&&0<=Ie(v.to,l.from))return!0;Ie(l.from,v.from)<0?l=(a=o.next(v.from)).value:v=(d=f.next(l.from)).value}return!1}function ao(e){var t=Jo(e)?null:{s:0,n:e};return{next:function(o){for(var a=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,a)for(;t.n.l&&Ie(o,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!a||Ie(o,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function aa(e){var t,o,a,l=(((l=e.r)==null?void 0:l.d)||0)-(((l=e.l)==null?void 0:l.d)||0),l=1<l?"r":l<-1?"l":"";l&&(t=l=="r"?"l":"r",o=s({},e),a=e[l],e.from=a.from,e.to=a.to,e[l]=a[l],o[l]=a[t],(e[t]=o).d=sa(o)),e.d=sa(e)}function sa(o){var t=o.r,o=o.l;return(t?o?Math.max(t.d,o.d):t.d:o?o.d:0)+1}function so(e,t){return p(t).forEach(function(o){e[o]?Rn(e[o],t[o]):e[o]=(function a(l){var f,d,v={};for(f in l)S(l,f)&&(d=l[f],v[f]=!d||typeof d!="object"||Le.has(d.constructor)?d:a(d));return v})(t[o])}),e}function Zo(e,t){return e.all||t.all||Object.keys(e).some(function(o){return t[o]&&ia(t[o],e[o])})}A(Ct.prototype,((it={add:function(e){return Rn(this,e),this},addKey:function(e){return jn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(o){return jn(t,o,o)}),this},hasKey:function(e){var t=ao(this).next(e).value;return t&&Ie(t.from,e)<=0&&0<=Ie(t.to,e)}})[De]=function(){return ao(this)},it));var Tr={},ei={},ti=!1;function lo(e){so(ei,e),ti||(ti=!0,setTimeout(function(){ti=!1,ri(ei,!(ei={}))},0))}function ri(e,t){t===void 0&&(t=!1);var o=new Set;if(e.all)for(var a=0,l=Object.values(Tr);a<l.length;a++)la(v=l[a],e,o,t);else for(var f in e){var d,v,f=/^idb\:\/\/(.*)\/(.*)\//.exec(f);f&&(d=f[1],f=f[2],v=Tr["idb://".concat(d,"/").concat(f)])&&la(v,e,o,t)}o.forEach(function(w){return w()})}function la(e,t,o,a){for(var l=[],f=0,d=Object.entries(e.queries.query);f<d.length;f++){for(var v=d[f],w=v[0],P=[],x=0,b=v[1];x<b.length;x++){var C=b[x];Zo(t,C.obsSet)?C.subscribers.forEach(function(D){return o.add(D)}):a&&P.push(C)}a&&l.push([w,P])}if(a)for(var E=0,k=l;E<k.length;E++){var _=k[E],w=_[0],P=_[1];e.queries.query[w]=P}}function el(e){var t=e._state,o=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?ut(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var a=t.openCanceller,l=Math.round(10*e.verno),f=!1;function d(){if(t.openCanceller!==a)throw new Y.DatabaseClosed("db.open() was cancelled")}function v(){return new W(function(C,E){if(d(),!o)throw new Y.MissingAPI;var k=e.name,_=t.autoSchema||!l?o.open(k):o.open(k,l);if(!_)throw new Y.MissingAPI;_.onerror=Zt(E),_.onblocked=rt(e._fireOnBlocked),_.onupgradeneeded=rt(function(D){var M;x=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=Pn,x.abort(),_.result.close(),(M=o.deleteDatabase(k)).onsuccess=M.onerror=rt(function(){E(new Y.NoSuchDatabase("Database ".concat(k," doesnt exist")))})):(x.onerror=Zt(E),M=D.oldVersion>Math.pow(2,62)?0:D.oldVersion,b=M<1,e.idbdb=_.result,f&&Js(e,x),Qs(e,M/10,x,E))},E),_.onsuccess=rt(function(){x=null;var D,M,O,I,N,$,H=e.idbdb=_.result,L=ve(H.objectStoreNames);if(0<L.length)try{var Z=H.transaction((N=L).length===1?N[0]:N,"readonly");if(t.autoSchema)$=H,I=Z,(O=e).verno=$.version/10,I=O._dbSchema=oo(0,$,I),O._storeNames=ve($.objectStoreNames,0),ro(O,[O._allTables],p(I),I);else if(io(e,e._dbSchema,Z),M=Z,((M=Yo(oo(0,(D=e).idbdb,M),D._dbSchema)).add.length||M.change.some(function(G){return G.add.length||G.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),H.close(),l=H.version+1,f=!0,C(v());to(e,Z)}catch{}Wr.push(e),H.onversionchange=rt(function(G){t.vcFired=!0,e.on("versionchange").fire(G)}),H.onclose=rt(function(){e.close({disableAutoOpen:!1})}),b&&(L=e._deps,N=k,Xo($=L.indexedDB)||N===Gn||Go($,L.IDBKeyRange).put({name:N}).catch(he)),C()},E)}).catch(function(C){switch(C?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(0<l)return l=0,v()}return W.reject(C)})}var w,P=t.dbReadyResolve,x=null,b=!1;return W.race([a,(typeof navigator>"u"?W.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(C){function E(){return indexedDB.databases().finally(C)}w=setInterval(E,100),E()}).finally(function(){return clearInterval(w)}):Promise.resolve()).then(v)]).then(function(){return d(),t.onReadyBeingFired=[],W.resolve(Qo(function(){return e.on.ready.fire(e.vip)})).then(function C(){var E;if(0<t.onReadyBeingFired.length)return E=t.onReadyBeingFired.reduce(Te,he),t.onReadyBeingFired=[],W.resolve(Qo(function(){return E(e.vip)})).then(C)})}).finally(function(){t.openCanceller===a&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(C){t.dbOpenError=C;try{x&&x.abort()}catch{}return a===t.openCanceller&&e._close(),ut(C)}).finally(function(){t.openComplete=!0,P()}).then(function(){var C;return b&&(C={},e.tables.forEach(function(E){E.schema.indexes.forEach(function(k){k.name&&(C["idb://".concat(e.name,"/").concat(E.name,"/").concat(k.name)]=new Ct(-1/0,[[[]]]))}),C["idb://".concat(e.name,"/").concat(E.name,"/")]=C["idb://".concat(e.name,"/").concat(E.name,"/:dels")]=new Ct(-1/0,[[[]]])}),br(Bn).fire(C),ri(C,!0)),e})}function ni(e){function t(f){return e.next(f)}var o=l(t),a=l(function(f){return e.throw(f)});function l(f){return function(v){var v=f(v),w=v.value;return v.done?w:w&&typeof w.then=="function"?w.then(o,a):m(w)?Promise.all(w).then(o,a):o(w)}}return l(t)()}function uo(e,t,o){for(var a=m(e)?e.slice():[e],l=0;l<o;++l)a.push(t);return a}var tl={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return s(s({},e),{table:function(a){var o=e.table(a),a=o.schema,l={},f=[];function d(C,E,k){var O=Mn(C),_=l[O]=l[O]||[],D=C==null?0:typeof C=="string"?1:C.length,M=0<E,O=s(s({},k),{name:M?"".concat(O,"(virtual-from:").concat(k.name,")"):k.name,lowLevelIndex:k,isVirtual:M,keyTail:E,keyLength:D,extractKey:$o(C),unique:!M&&k.unique});return _.push(O),O.isPrimaryKey||f.push(O),1<D&&d(D===2?C[0]:C.slice(0,D-1),E+1,k),_.sort(function(I,N){return I.keyTail-N.keyTail}),O}var v=d(a.primaryKey.keyPath,0,a.primaryKey);l[":id"]=[v];for(var w=0,P=a.indexes;w<P.length;w++){var x=P[w];d(x.keyPath,0,x)}function b(C){var E,k=C.query.index;return k.isVirtual?s(s({},C),{query:{index:k.lowLevelIndex,range:(E=C.query.range,k=k.keyTail,{type:E.type===1?2:E.type,lower:uo(E.lower,E.lowerOpen?e.MAX_KEY:e.MIN_KEY,k),lowerOpen:!0,upper:uo(E.upper,E.upperOpen?e.MIN_KEY:e.MAX_KEY,k),upperOpen:!0})}}):C}return s(s({},o),{schema:s(s({},a),{primaryKey:v,indexes:f,getIndexByKeyPath:function(C){return(C=l[Mn(C)])&&C[0]}}),count:function(C){return o.count(b(C))},query:function(C){return o.query(b(C))},openCursor:function(C){var E=C.query.index,k=E.keyTail,_=E.keyLength;return E.isVirtual?o.openCursor(b(C)).then(function(M){return M&&D(M)}):o.openCursor(C);function D(M){return Object.create(M,{continue:{value:function(O){O!=null?M.continue(uo(O,C.reverse?e.MAX_KEY:e.MIN_KEY,k)):C.unique?M.continue(M.key.slice(0,_).concat(C.reverse?e.MIN_KEY:e.MAX_KEY,k)):M.continue()}},continuePrimaryKey:{value:function(O,I){M.continuePrimaryKey(uo(O,e.MAX_KEY,k),I)}},primaryKey:{get:function(){return M.primaryKey}},key:{get:function(){var O=M.key;return _===1?O[0]:O.slice(0,_)}},value:{get:function(){return M.value}}})}}})}})}};function oi(e,t,o,a){return o=o||{},a=a||"",p(e).forEach(function(l){var f,d,v;S(t,l)?(f=e[l],d=t[l],typeof f=="object"&&typeof d=="object"&&f&&d?(v=Fe(f))!==Fe(d)?o[a+l]=t[l]:v==="Object"?oi(f,d,o,a+l+"."):f!==d&&(o[a+l]=t[l]):f!==d&&(o[a+l]=t[l])):o[a+l]=void 0}),p(t).forEach(function(l){S(e,l)||(o[a+l]=t[l])}),o}function ii(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var rl={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return s(s({},e),{table:function(t){var o=e.table(t),a=o.schema.primaryKey;return s(s({},o),{mutate:function(l){var f=ne.trans,d=f.table(t).hook,v=d.deleting,w=d.creating,P=d.updating;switch(l.type){case"add":if(w.fire===he)break;return f._promise("readwrite",function(){return x(l)},!0);case"put":if(w.fire===he&&P.fire===he)break;return f._promise("readwrite",function(){return x(l)},!0);case"delete":if(v.fire===he)break;return f._promise("readwrite",function(){return x(l)},!0);case"deleteRange":if(v.fire===he)break;return f._promise("readwrite",function(){return(function b(C,E,k){return o.query({trans:C,values:!1,query:{index:a,range:E},limit:k}).then(function(_){var D=_.result;return x({type:"delete",keys:D,trans:C}).then(function(M){return 0<M.numFailures?Promise.reject(M.failures[0]):D.length<k?{failures:[],numFailures:0,lastResult:void 0}:b(C,s(s({},E),{lower:D[D.length-1],lowerOpen:!0}),k)})})})(l.trans,l.range,1e4)},!0)}return o.mutate(l);function x(b){var C,E,k,_=ne.trans,D=b.keys||ii(a,b);if(D)return(b=b.type==="add"||b.type==="put"?s(s({},b),{keys:D}):s({},b)).type!=="delete"&&(b.values=c([],b.values)),b.keys&&(b.keys=c([],b.keys)),C=o,k=D,((E=b).type==="add"?Promise.resolve([]):C.getMany({trans:E.trans,keys:k,cache:"immutable"})).then(function(M){var O=D.map(function(I,N){var $,H,L,Z=M[N],G={onerror:null,onsuccess:null};return b.type==="delete"?v.fire.call(G,I,Z,_):b.type==="add"||Z===void 0?($=w.fire.call(G,I,b.values[N],_),I==null&&$!=null&&(b.keys[N]=I=$,a.outbound||ce(b.values[N],a.keyPath,I))):($=oi(Z,b.values[N]),(H=P.fire.call(G,$,I,Z,_))&&(L=b.values[N],Object.keys(H).forEach(function(U){S(L,U)?L[U]=H[U]:ce(L,U,H[U])}))),G});return o.mutate(b).then(function(I){for(var N=I.failures,$=I.results,H=I.numFailures,I=I.lastResult,L=0;L<D.length;++L){var Z=($||D)[L],G=O[L];Z==null?G.onerror&&G.onerror(N[L]):G.onsuccess&&G.onsuccess(b.type==="put"&&M[L]?b.values[L]:Z)}return{failures:N,results:$,numFailures:H,lastResult:I}}).catch(function(I){return O.forEach(function(N){return N.onerror&&N.onerror(I)}),Promise.reject(I)})});throw new Error("Keys missing")}}})}})}};function ua(e,t,o){try{if(!t||t.keys.length<e.length)return null;for(var a=[],l=0,f=0;l<t.keys.length&&f<e.length;++l)Ie(t.keys[l],e[f])===0&&(a.push(o?J(t.values[l]):t.values[l]),++f);return a.length===e.length?a:null}catch{return null}}var nl={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var o=e.table(t);return s(s({},o),{getMany:function(a){var l;return a.cache?(l=ua(a.keys,a.trans._cache,a.cache==="clone"))?W.resolve(l):o.getMany(a).then(function(f){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?J(f):f},f}):o.getMany(a)},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),o.mutate(a)}})}}}};function ca(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function fa(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var ol={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,o=new Ct(e.MIN_KEY,e.MAX_KEY);return s(s({},e),{transaction:function(a,l,f){if(ne.subscr&&l!=="readonly")throw new Y.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ne.querier));return e.transaction(a,l,f)},table:function(a){function l(D){var _,D=D.query;return[_=D.index,new Ct((_=(D=D.range).lower)!=null?_:e.MIN_KEY,(_=D.upper)!=null?_:e.MAX_KEY)]}var f=e.table(a),d=f.schema,v=d.primaryKey,w=d.indexes,P=v.extractKey,x=v.outbound,b=v.autoIncrement&&w.filter(function(k){return k.compound&&k.keyPath.includes(v.keyPath)}),C=s(s({},f),{mutate:function(k){function _(te){return te="idb://".concat(t,"/").concat(a,"/").concat(te),N[te]||(N[te]=new Ct)}var D,M,O,I=k.trans,N=k.mutatedParts||(k.mutatedParts={}),$=_(""),H=_(":dels"),L=k.type,G=k.type==="deleteRange"?[k.range]:k.type==="delete"?[k.keys]:k.values.length<50?[ii(v,k).filter(function(te){return te}),k.values]:[],Z=G[0],G=G[1],U=k.trans._cache;return m(Z)?($.addKeys(Z),(L=L==="delete"||Z.length===G.length?ua(Z,U):null)||H.addKeys(Z),(L||G)&&(D=_,M=L,O=G,d.indexes.forEach(function(te){var Ke=D(te.name||"");function Ue(Ee){return Ee!=null?te.extractKey(Ee):null}function ye(Ee){te.multiEntry&&m(Ee)?Ee.forEach(function(nt){return Ke.addKey(nt)}):Ke.addKey(Ee)}(M||O).forEach(function(Ee,at){var qt=M&&Ue(M[at]),at=O&&Ue(O[at]);Ie(qt,at)!==0&&(qt!=null&&ye(qt),at!=null)&&ye(at)})}))):Z?(G={from:(U=Z.lower)!=null?U:e.MIN_KEY,to:(L=Z.upper)!=null?L:e.MAX_KEY},H.add(G),$.add(G)):($.add(o),H.add(o),d.indexes.forEach(function(te){return _(te.name).add(o)})),f.mutate(k).then(function(te){return!Z||k.type!=="add"&&k.type!=="put"||($.addKeys(te.results),b&&b.forEach(function(Ke){for(var Ue=k.values.map(function(qt){return Ke.extractKey(qt)}),ye=Ke.keyPath.findIndex(function(qt){return qt===v.keyPath}),Ee=0,nt=te.results.length;Ee<nt;++Ee)Ue[Ee][ye]=te.results[Ee];_(Ke.name).addKeys(Ue)})),I.mutatedParts=so(I.mutatedParts||{},N),te})}}),E={get:function(k){return[v,new Ct(k.key)]},getMany:function(k){return[v,new Ct().addKeys(k.keys)]},count:l,query:l,openCursor:l};return p(E).forEach(function(k){C[k]=function(_){var D=ne.subscr,M=!!D,O=ca(ne,f)&&fa(k,_)?_.obsSet={}:D;if(M){var I,D=function(G){return G="idb://".concat(t,"/").concat(a,"/").concat(G),O[G]||(O[G]=new Ct)},N=D(""),$=D(":dels"),M=E[k](_),H=M[0],M=M[1];if((k==="query"&&H.isPrimaryKey&&!_.values?$:D(H.name||"")).add(M),!H.isPrimaryKey){if(k!=="count")return I=k==="query"&&x&&_.values&&f.query(s(s({},_),{values:!1})),f[k].apply(this,arguments).then(function(G){if(k==="query"){if(x&&_.values)return I.then(function(Ue){return Ue=Ue.result,N.addKeys(Ue),G});var U=_.values?G.result.map(P):G.result;(_.values?N:$).addKeys(U)}else{var te,Ke;if(k==="openCursor")return Ke=_.values,(te=G)&&Object.create(te,{key:{get:function(){return $.addKey(te.primaryKey),te.key}},primaryKey:{get:function(){var Ue=te.primaryKey;return $.addKey(Ue),Ue}},value:{get:function(){return Ke&&N.addKey(te.primaryKey),te.value}}})}return G});$.add(o)}}return f[k].apply(this,arguments)}}),C}})}};function da(e,t,o){var a;return o.numFailures===0?t:t.type==="deleteRange"||(a=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1,o.numFailures===a)?null:(a=s({},t),m(a.keys)&&(a.keys=a.keys.filter(function(l,f){return!(f in o.failures)})),"values"in a&&m(a.values)&&(a.values=a.values.filter(function(l,f){return!(f in o.failures)})),a)}function ai(e,t){return o=e,((a=t).lower===void 0||(a.lowerOpen?0<Ie(o,a.lower):0<=Ie(o,a.lower)))&&(o=e,(a=t).upper===void 0||(a.upperOpen?Ie(o,a.upper)<0:Ie(o,a.upper)<=0));var o,a}function va(e,t,o,a,l,f){var d,v,w,P,x,b;return!o||o.length===0||(d=t.query.index,v=d.multiEntry,w=t.query.range,P=a.schema.primaryKey.extractKey,x=d.extractKey,b=(d.lowLevelIndex||d).extractKey,(a=o.reduce(function(C,E){var k=C,_=[];if(E.type==="add"||E.type==="put")for(var D=new Ct,M=E.values.length-1;0<=M;--M){var O,I=E.values[M],N=P(I);!D.hasKey(N)&&(O=x(I),v&&m(O)?O.some(function(G){return ai(G,w)}):ai(O,w))&&(D.addKey(N),_.push(I))}switch(E.type){case"add":var $=new Ct().addKeys(t.values?C.map(function(U){return P(U)}):C),k=C.concat(t.values?_.filter(function(U){return U=P(U),!$.hasKey(U)&&($.addKey(U),!0)}):_.map(function(U){return P(U)}).filter(function(U){return!$.hasKey(U)&&($.addKey(U),!0)}));break;case"put":var H=new Ct().addKeys(E.values.map(function(U){return P(U)}));k=C.filter(function(U){return!H.hasKey(t.values?P(U):U)}).concat(t.values?_:_.map(function(U){return P(U)}));break;case"delete":var L=new Ct().addKeys(E.keys);k=C.filter(function(U){return!L.hasKey(t.values?P(U):U)});break;case"deleteRange":var Z=E.range;k=C.filter(function(U){return!ai(P(U),Z)})}return k},e))===e)?e:(a.sort(function(C,E){return Ie(b(C),b(E))||Ie(P(C),P(E))}),t.limit&&t.limit<1/0&&(a.length>t.limit?a.length=t.limit:e.length===t.limit&&a.length<t.limit&&(l.dirty=!0)),f?Object.freeze(a):a)}function ha(e,t){return Ie(e.lower,t.lower)===0&&Ie(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function il(e,t){return((o,a,l,f)=>{if(o===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((o=Ie(o,a))===0){if(l&&f)return 0;if(l)return 1;if(f)return-1}return o})(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=((o,a,l,f)=>{if(o===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((o=Ie(o,a))===0){if(l&&f)return 0;if(l)return-1;if(f)return 1}return o})(e.upper,t.upper,e.upperOpen,t.upperOpen)}function al(e,t,o,a){e.subscribers.add(o),a.addEventListener("abort",function(){var l,f;e.subscribers.delete(o),e.subscribers.size===0&&(l=e,f=t,setTimeout(function(){l.subscribers.size===0&&qe(f,l)},3e3))})}var sl={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return s(s({},e),{transaction:function(o,a,l){var f,d,v=e.transaction(o,a,l);return a==="readwrite"&&(l=(f=new AbortController).signal,v.addEventListener("abort",(d=function(w){return function(){if(f.abort(),a==="readwrite"){for(var P=new Set,x=0,b=o;x<b.length;x++){var C=b[x],E=Tr["idb://".concat(t,"/").concat(C)];if(E){var k=e.table(C),_=E.optimisticOps.filter(function(te){return te.trans===v});if(v._explicit&&w&&v.mutatedParts)for(var D=0,M=Object.values(E.queries.query);D<M.length;D++)for(var O=0,I=(H=M[D]).slice();O<I.length;O++)Zo((L=I[O]).obsSet,v.mutatedParts)&&(qe(H,L),L.subscribers.forEach(function(te){return P.add(te)}));else if(0<_.length){E.optimisticOps=E.optimisticOps.filter(function(te){return te.trans!==v});for(var N=0,$=Object.values(E.queries.query);N<$.length;N++)for(var H,L,Z,G=0,U=(H=$[N]).slice();G<U.length;G++)(L=U[G]).res!=null&&v.mutatedParts&&(w&&!L.dirty?(Z=Object.isFrozen(L.res),Z=va(L.res,L.req,_,k,L,Z),L.dirty?(qe(H,L),L.subscribers.forEach(function(te){return P.add(te)})):Z!==L.res&&(L.res=Z,L.promise=W.resolve({result:Z}))):(L.dirty&&qe(H,L),L.subscribers.forEach(function(te){return P.add(te)})))}}}P.forEach(function(te){return te()})}}})(!1),{signal:l}),v.addEventListener("error",d(!1),{signal:l}),v.addEventListener("complete",d(!0),{signal:l})),v},table:function(o){var a=e.table(o),l=a.schema.primaryKey;return s(s({},a),{mutate:function(f){var d,v=ne.trans;return!l.outbound&&v.db._options.cache!=="disabled"&&!v.explicit&&v.idbtrans.mode==="readwrite"&&(d=Tr["idb://".concat(t,"/").concat(o)])?(v=a.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||ii(l,f).some(function(w){return w==null}))?(d.optimisticOps.push(f),f.mutatedParts&&lo(f.mutatedParts),v.then(function(w){0<w.numFailures&&(qe(d.optimisticOps,f),(w=da(0,f,w))&&d.optimisticOps.push(w),f.mutatedParts)&&lo(f.mutatedParts)}),v.catch(function(){qe(d.optimisticOps,f),f.mutatedParts&&lo(f.mutatedParts)})):v.then(function(w){var P=da(0,s(s({},f),{values:f.values.map(function(x,b){var C;return w.failures[b]?x:(ce(C=(C=l.keyPath)!=null&&C.includes(".")?J(x):s({},x),l.keyPath,w.results[b]),C)})}),w);d.optimisticOps.push(P),queueMicrotask(function(){return f.mutatedParts&&lo(f.mutatedParts)})}),v):a.mutate(f)},query:function(f){var d,v,w,P,x,b,C;return ca(ne,a)&&fa("query",f)?(d=((w=ne.trans)==null?void 0:w.db._options.cache)==="immutable",v=(w=ne).requery,w=w.signal,b=((E,k,_,D)=>{var M=Tr["idb://".concat(E,"/").concat(k)];if(!M)return[];if(!(E=M.queries[_]))return[null,!1,M,null];var O=E[(D.query?D.query.index.name:null)||""];if(!O)return[null,!1,M,null];switch(_){case"query":var I=O.find(function(N){return N.req.limit===D.limit&&N.req.values===D.values&&ha(N.req.query.range,D.query.range)});return I?[I,!0,M,O]:[O.find(function(N){return("limit"in N.req?N.req.limit:1/0)>=D.limit&&(!D.values||N.req.values)&&il(N.req.query.range,D.query.range)}),!1,M,O];case"count":return I=O.find(function(N){return ha(N.req.query.range,D.query.range)}),[I,!!I,M,O]}})(t,o,"query",f),C=b[0],P=b[2],x=b[3],C&&b[1]?C.obsSet=f.obsSet:(b=a.query(f).then(function(E){var k=E.result;if(C&&(C.res=k),d){for(var _=0,D=k.length;_<D;++_)Object.freeze(k[_]);Object.freeze(k)}else E.result=J(k);return E}).catch(function(E){return x&&C&&qe(x,C),Promise.reject(E)}),C={obsSet:f.obsSet,promise:b,subscribers:new Set,type:"query",req:f,dirty:!1},x?x.push(C):(x=[C],(P=P||(Tr["idb://".concat(t,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=x)),al(C,x,v,w),C.promise.then(function(E){return{result:va(E.result,f,P?.optimisticOps,a,C,d)}})):a.query(f)}})}})}};function co(e,t){return new Proxy(e,{get:function(o,a,l){return a==="db"?t:Reflect.get(o,a,l)}})}ct.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Y.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Y.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,o=t.filter(function(a){return a._cfg.version===e})[0];return o||(o=new this.Version(e),t.push(o),t.sort(Xs),o.stores({}),this._state.autoSchema=!1),o},ct.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ne.letThrough||this._vip)?e():new W(function(o,a){if(t._state.openComplete)return a(new Y.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void a(new Y.DatabaseClosed);t.open().catch(he)}t._state.dbReadyPromise.then(o,a)}).then(e)},ct.prototype.use=function(l){var t=l.stack,o=l.create,a=l.level,l=l.name,f=(l&&this.unuse({stack:t,name:l}),this._middlewares[t]||(this._middlewares[t]=[]));return f.push({stack:t,create:o,level:a??10,name:l}),f.sort(function(d,v){return d.level-v.level}),this},ct.prototype.unuse=function(e){var t=e.stack,o=e.name,a=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(l){return a?l.create!==a:!!o&&l.name!==o})),this},ct.prototype.open=function(){var e=this;return Mr(St,function(){return el(e)})},ct.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=Wr.indexOf(this);if(0<=t&&Wr.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new W(function(o){e.dbReadyResolve=o}),e.openCanceller=new W(function(o,a){e.cancelOpen=a}))},ct.prototype.close=function(t){var t=(t===void 0?{disableAutoOpen:!0}:t).disableAutoOpen,o=this._state;t?(o.isBeingOpened&&o.cancelOpen(new Y.DatabaseClosed),this._close(),o.autoOpen=!1,o.dbOpenError=new Y.DatabaseClosed):(this._close(),o.autoOpen=this._options.autoOpen||o.isBeingOpened,o.openComplete=!1,o.dbOpenError=null)},ct.prototype.delete=function(e){var t=this,o=(e===void 0&&(e={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),a=this._state;return new W(function(l,f){function d(){t.close(e);var v=t._deps.indexedDB.deleteDatabase(t.name);v.onsuccess=rt(function(){var w,P,x;w=t._deps,P=t.name,Xo(x=w.indexedDB)||P===Gn||Go(x,w.IDBKeyRange).delete(P).catch(he),l()}),v.onerror=Zt(f),v.onblocked=t._fireOnBlocked}if(o)throw new Y.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(d):d()})},ct.prototype.backendDB=function(){return this.idbdb},ct.prototype.isOpen=function(){return this.idbdb!==null},ct.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ct.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ct.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ct.prototype,"tables",{get:function(){var e=this;return p(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ct.prototype.transaction=function(){var e=(function(t,o,a){var l=arguments.length;if(l<2)throw new Y.InvalidArgument("Too few arguments");for(var f=new Array(l-1);--l;)f[l-1]=arguments[l];return a=f.pop(),[t,Be(f),a]}).apply(this,arguments);return this._transaction.apply(this,e)},ct.prototype._transaction=function(e,t,o){var a,l,f=this,d=ne.trans,v=(d&&d.db===this&&e.indexOf("!")===-1||(d=null),e.indexOf("?")!==-1);e=e.replace("!","").replace("?","");try{if(l=t.map(function(P){if(P=P instanceof f.Table?P.name:P,typeof P!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return P}),e=="r"||e===Ko)a=Ko;else{if(e!="rw"&&e!=No)throw new Y.InvalidArgument("Invalid transaction mode: "+e);a=No}if(d){if(d.mode===Ko&&a===No){if(!v)throw new Y.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");d=null}d&&l.forEach(function(P){if(d&&d.storeNames.indexOf(P)===-1){if(!v)throw new Y.SubTransaction("Table "+P+" not included in parent transaction.");d=null}}),v&&d&&!d.active&&(d=null)}}catch(P){return d?d._promise(null,function(x,b){b(P)}):ut(P)}var w=(function P(x,b,C,E,k){return W.resolve().then(function(){var O=ne.transless||ne,_=x._createTransaction(b,C,x._dbSchema,E),O=(_.explicit=!0,{trans:_,transless:O});if(E)_.idbtrans=E.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,x._state.PR1398_maxLoop=3}catch(I){return I.name===Re.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return P(x,b,C,null,k)})):ut(I)}var D,M=ot(k),O=(M&&Yr(),W.follow(function(){var I;(D=k.call(_,_))&&(M?(I=mr.bind(null,null),D.then(I,I)):typeof D.next=="function"&&typeof D.throw=="function"&&(D=ni(D)))},O));return(D&&typeof D.then=="function"?W.resolve(D).then(function(I){return _.active?I:ut(new Y.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):O.then(function(){return D})).then(function(I){return E&&_._resolve(),_._completion.then(function(){return I})}).catch(function(I){return _._reject(I),ut(I)})})}).bind(null,this,a,l,d,o);return d?d._promise(a,w,"lock"):ne.trans?Mr(ne.transless,function(){return f._whenReady(w)}):this._whenReady(w)},ct.prototype.table=function(e){if(S(this._allTables,e))return this._allTables[e];throw new Y.InvalidTable("Table ".concat(e," does not exist"))};var ar=ct;function ct(e,t){var o,a,l,f,d,v=this,w=(this._middlewares={},this.verno=0,ct.dependencies),w=(this._options=t=s({addons:ct.addons,autoOpen:!0,indexedDB:w.indexedDB,IDBKeyRange:w.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},t.addons),P=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:he,dbReadyPromise:null,cancelOpen:he,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen}),x=(P.dbReadyPromise=new W(function(b){P.dbReadyResolve=b}),P.openCanceller=new W(function(b,C){P.cancelOpen=C}),this._state=P,this.name=e,this.on=An(this,"populate","blocked","versionchange","close",{ready:[Te,he]}),this.once=function(b,C){var E=function(){for(var k=[],_=0;_<arguments.length;_++)k[_]=arguments[_];v.on(b).unsubscribe(E),C.apply(v,k)};return v.on(b,E)},this.on.ready.subscribe=ge(this.on.ready.subscribe,function(b){return function(C,E){ct.vip(function(){var k,_=v._state;_.openComplete?(_.dbOpenError||W.resolve().then(C),E&&b(C)):_.onReadyBeingFired?(_.onReadyBeingFired.push(C),E&&b(C)):(b(C),k=v,E||b(function D(){k.on.ready.unsubscribe(C),k.on.ready.unsubscribe(D)}))})}}),this.Collection=(o=this,On(Us.prototype,function(D,_){this.db=o;var E=Ui,k=null;if(_)try{E=_()}catch(O){k=O}var _=D._ctx,D=_.table,M=D.hook.reading.fire;this._ctx={table:D,index:_.index,isPrimKey:!_.index||D.schema.primKey.keyPath&&_.index===D.schema.primKey.name,range:E,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:k,or:_.or,valueMapper:M!==lt?M:null}})),this.Table=(a=this,On(Gi.prototype,function(b,C,E){this.db=a,this._tx=E,this.name=b,this.schema=C,this.hook=a._allTables[b]?a._allTables[b].hook:An(null,{creating:[re,he],reading:[_e,lt],updating:[Ae,he],deleting:[de,he]})})),this.Transaction=(l=this,On(Hs.prototype,function(b,C,E,k,_){var D=this;b!=="readonly"&&C.forEach(function(M){M=(M=E[M])==null?void 0:M.yProps,M&&(C=C.concat(M.map(function(O){return O.updatesTable})))}),this.db=l,this.mode=b,this.storeNames=C,this.schema=E,this.chromeTransactionDurability=k,this.idbtrans=null,this.on=An(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new W(function(M,O){D._resolve=M,D._reject=O}),this._completion.then(function(){D.active=!1,D.on.complete.fire()},function(M){var O=D.active;return D.active=!1,D.on.error.fire(M),D.parent?D.parent._reject(M):O&&D.idbtrans&&D.idbtrans.abort(),ut(M)})})),this.Version=(f=this,On(Zs.prototype,function(b){this.db=f,this._cfg={version:b,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(d=this,On(ea.prototype,function(b,C,E){if(this.db=d,this._ctx={table:b,index:C===":id"?null:C,or:E},this._cmp=this._ascending=Ie,this._descending=function(k,_){return Ie(_,k)},this._max=function(k,_){return 0<Ie(k,_)?k:_},this._min=function(k,_){return Ie(k,_)<0?k:_},this._IDBKeyRange=d._deps.IDBKeyRange,!this._IDBKeyRange)throw new Y.MissingAPI})),this.on("versionchange",function(b){0<b.newVersion?console.warn("Another connection wants to upgrade database '".concat(v.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(v.name,"'. Closing db now to resume the delete request.")),v.close({disableAutoOpen:!1})}),this.on("blocked",function(b){!b.newVersion||b.newVersion<b.oldVersion?console.warn("Dexie.delete('".concat(v.name,"') was blocked")):console.warn("Upgrade '".concat(v.name,"' blocked by other connection holding version ").concat(b.oldVersion/10))}),this._maxKey=Dn(t.IDBKeyRange),this._createTransaction=function(b,C,E,k){return new v.Transaction(b,C,E,v._options.chromeTransactionDurability,k)},this._fireOnBlocked=function(b){v.on("blocked").fire(b),Wr.filter(function(C){return C.name===v.name&&C!==v&&!C._state.vcFired}).map(function(C){return C.on("versionchange").fire(b)})},this.use(nl),this.use(sl),this.use(ol),this.use(tl),this.use(rl),new Proxy(this,{get:function(b,C,E){var k;return C==="_vip"||(C==="table"?function(_){return co(v.table(_),x)}:(k=Reflect.get(b,C,E))instanceof Gi?co(k,x):C==="tables"?k.map(function(_){return co(_,x)}):C==="_createTransaction"?function(){return co(k.apply(this,arguments),x)}:k)}}));this.vip=x,w.forEach(function(b){return b(v)})}var fo,Jr=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ll=(si.prototype.subscribe=function(e,t,o){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:o})},si.prototype[Jr]=function(){return this},si);function si(e){this._subscribe=e}try{fo={indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch{fo={indexedDB:null,IDBKeyRange:null}}function pa(e){var t,o=!1,a=new ll(function(l){var f=ot(e),d,v=!1,w={},P={},x={get closed(){return v},unsubscribe:function(){v||(v=!0,d&&d.abort(),b&&br.storagemutated.unsubscribe(E))}},b=(l.start&&l.start(x),!1),C=function(){return Fo(k)},E=function(_){so(w,_),Zo(P,w)&&C()},k=function(){var _,D,M;!v&&fo.indexedDB&&(w={},_={},d&&d.abort(),d=new AbortController,M=(O=>{var I=$r();try{f&&Yr();var N=pr(e,O);return N=f?N.finally(mr):N}finally{I&&Hr()}})(D={subscr:_,signal:d.signal,requery:C,querier:e,trans:null}),Promise.resolve(M).then(function(O){o=!0,t=O,v||D.signal.aborted||(w={},(I=>{for(var N in I)if(S(I,N))return;return 1})(P=_)||b||(br(Bn,E),b=!0),Fo(function(){return!v&&l.next&&l.next(O)}))},function(O){o=!1,["DatabaseClosedError","AbortError"].includes(O?.name)||v||Fo(function(){v||l.error&&l.error(O)})}))};return setTimeout(C,0),x});return a.hasValue=function(){return o},a.getValue=function(){return t},a}var Ir=ar;function li(e){var t=_r;try{_r=!0,br.storagemutated.fire(e),ri(e,!0)}finally{_r=t}}A(Ir,s(s({},q),{delete:function(e){return new Ir(e,{addons:[]}).delete()},exists:function(e){return new Ir(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Ir.dependencies,o=t.indexedDB,t=t.IDBKeyRange,(Xo(o)?Promise.resolve(o.databases()).then(function(a){return a.map(function(l){return l.name}).filter(function(l){return l!==Gn})}):Go(o,t).toCollection().primaryKeys()).then(e)}catch{return ut(new Y.MissingAPI)}var t,o},defineClass:function(){return function(e){g(this,e)}},ignoreTransaction:function(e){return ne.trans?Mr(ne.transless,e):e()},vip:Qo,async:function(e){return function(){try{var t=ni(e.apply(this,arguments));return t&&typeof t.then=="function"?t:W.resolve(t)}catch(o){return ut(o)}}},spawn:function(e,t,o){try{var a=ni(e.apply(o,t||[]));return a&&typeof a.then=="function"?a:W.resolve(a)}catch(l){return ut(l)}},currentTransaction:{get:function(){return ne.trans||null}},waitFor:function(e,t){return e=W.resolve(typeof e=="function"?Ir.ignoreTransaction(e):e).timeout(t||6e4),ne.trans?ne.trans.waitFor(e):e},Promise:W,debug:{get:function(){return Xe},set:function(e){vt(e)}},derive:V,extend:g,props:A,override:ge,Events:An,on:br,liveQuery:pa,extendObservabilitySet:so,getByKeyPath:ie,setByKeyPath:ce,delByKeyPath:function(e,t){typeof t=="string"?ce(e,t,void 0):"length"in t&&[].map.call(t,function(o){ce(e,o,void 0)})},shallowClone:le,deepClone:J,getObjectDiff:oi,cmp:Ie,asap:X,minKey:-1/0,addons:[],connections:Wr,errnames:Re,dependencies:fo,cache:Tr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,o){return e+t/Math.pow(10,2*o)})})),Ir.maxKey=Dn(Ir.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(br(Bn,function(e){_r||(e=new CustomEvent(zo,{detail:e}),_r=!0,dispatchEvent(e),_r=!1)}),addEventListener(zo,function(e){e=e.detail,_r||li(e)}));var Zr,_r=!1,ma=function(){};return typeof BroadcastChannel<"u"&&((ma=function(){(Zr=new BroadcastChannel(zo)).onmessage=function(e){return e.data&&li(e.data)}})(),typeof Zr.unref=="function"&&Zr.unref(),br(Bn,function(e){_r||Zr.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!ar.disableBfCache&&e.persisted){Xe&&console.debug("Dexie: handling persisted pagehide"),Zr?.close();for(var t=0,o=Wr;t<o.length;t++)o[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!ar.disableBfCache&&e.persisted&&(Xe&&console.debug("Dexie: handling persisted pageshow"),ma(),li({all:new Ct(-1/0,[[]])}))})),W.rejectionMapper=function(e,t){return!e||e instanceof ke||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Je[e.name]?e:(t=new Je[e.name](t||e.message,e),"stack"in e&&T(t,"stack",{get:function(){return this.inner.stack}}),t)},vt(Xe),s(ar,Object.freeze({__proto__:null,Dexie:ar,Entity:Vi,PropModification:Sn,RangeSet:Ct,add:function(e){return new Sn({add:e})},cmp:Ie,default:ar,liveQuery:pa,mergeRanges:Rn,rangesOverlap:ia,remove:function(e){return new Sn({remove:e})},replacePrefix:function(e,t){return new Sn({replacePrefix:[e,t]})}}),{default:ar}),ar})})(mo)),mo.exports}var Vu=Uu();const Si=qu(Vu),Ta=Symbol.for("Dexie"),bo=globalThis[Ta]||(globalThis[Ta]=Si);if(Si.semVer!==bo.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Si.semVer} and ${bo.semVer}`);const{liveQuery:nd,mergeRanges:od,rangesOverlap:id,RangeSet:ad,cmp:sd,Entity:ld,PropModification:ud,replacePrefix:cd,add:fd,remove:dd,DexieYProvider:vd}=bo,Qe=new bo("MemoriaDB");Qe.version(1).stores({collections:"id, name, createdAt, updatedAt",cards:"id, collectionId, createdAt, lastReviewedAt"});class $u{constructor(n={}){this.id=n.id||crypto.randomUUID(),this.name=n.name||"",this.description=n.description||"",this.createdAt=n.createdAt||Date.now(),this.updatedAt=n.updatedAt||Date.now(),this.cardCount=n.cardCount||0}}class Hu{constructor(n={}){this.id=n.id||crypto.randomUUID(),this.collectionId=n.collectionId||"",this.text=n.text||"",this.imageBlob=n.imageBlob||null,this.audioBlob=n.audioBlob||null,this.createdAt=n.createdAt||Date.now(),this.lastReviewedAt=n.lastReviewedAt||null,this.reviewCount=n.reviewCount||0,this.difficulty=n.difficulty||0}}async function Yu(){try{return await Qe.open(),console.log("â Memoria database initialized successfully"),console.log("ð Database version:",Qe.verno),!0}catch(r){return console.error("â Failed to initialize database:",r),window.indexedDB||console.error("â ï¸ Your browser does not support IndexedDB. Please upgrade to a modern browser."),!1}}function mn(r){if(!r)return"Never";const n=new Date(r),s=new Date-n,c=Math.floor(s/1e3),u=Math.floor(c/60),p=Math.floor(u/60),m=Math.floor(p/24),g=Math.floor(m/7),y=Math.floor(m/30),B=Math.floor(m/365);return c<60?"Just now":u<60?`${u} minute${u!==1?"s":""} ago`:p<24?`${p} hour${p!==1?"s":""} ago`:m<7?`${m} day${m!==1?"s":""} ago`:g<4?`${g} week${g!==1?"s":""} ago`:y<12?`${y} month${y!==1?"s":""} ago`:`${B} year${B!==1?"s":""} ago`}function Wu(r,n=100){return!r||r.length<=n?r:r.substring(0,n)+"..."}function Gu(){return{indexedDB:!!window.indexedDB,serviceWorker:"serviceWorker"in navigator,mediaDevices:!!navigator.mediaDevices,getUserMedia:!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),mediaRecorder:typeof MediaRecorder<"u",crypto:!!window.crypto&&!!window.crypto.randomUUID,canvas:(()=>{try{const r=document.createElement("canvas");return!!(r.getContext&&r.getContext("2d"))}catch{return!1}})()}}function Xu(){const r=Gu();console.log("ð Browser Support Check:"),console.table(r);const n=Object.keys(r).filter(i=>!r[i]);n.length>0?console.warn("â ï¸ Unsupported features:",n.join(", ")):console.log("â All features supported!")}function Qu(){const{subscribe:r,set:n,update:i}=js([]);return{subscribe:r,async load(){try{const s=await Qe.collections.orderBy("updatedAt").reverse().toArray();return n(s),console.log("ð Loaded",s.length,"collections"),s}catch(s){throw console.error("Failed to load collections:",s),n([]),s}},async create(s){try{const c=new $u({name:s.name,description:s.description||""});return await Qe.collections.add(c),i(u=>[c,...u]),console.log("â Created collection:",c.name),c}catch(c){throw console.error("Failed to create collection:",c),c}},async update(s,c){try{const u={...c,updatedAt:Date.now()};await Qe.collections.update(s,u),i(p=>p.map(m=>m.id===s?{...m,...u}:m)),console.log("â Updated collection:",s)}catch(u){throw console.error("Failed to update collection:",u),u}},async delete(s){try{await Qe.collections.delete(s),await Qe.cards.where("collectionId").equals(s).delete(),i(c=>c.filter(u=>u.id!==s)),console.log("ðï¸ Deleted collection:",s)}catch(c){throw console.error("Failed to delete collection:",c),c}},async getById(s){try{return await Qe.collections.get(s)}catch(c){throw console.error("Failed to get collection:",c),c}},async updateCardCount(s,c){try{await Qe.collections.update(s,{cardCount:c,updatedAt:Date.now()}),i(u=>u.map(p=>p.id===s?{...p,cardCount:c,updatedAt:Date.now()}:p))}catch(u){throw console.error("Failed to update card count:",u),u}},async clear(){await Qe.collections.clear(),await Qe.cards.clear(),n([]),console.log("ðï¸ Cleared all collections")}}}const ur=Qu();var Ju=Q('<div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10"><button class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit</button> <button class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> Delete</button></div>'),Zu=Q('<p class="text-gray-600 text-sm mb-4 line-clamp-2 svelte-17y57sb"> </p>'),ec=Q('<p class="text-gray-400 text-sm italic mb-4">No description</p>'),tc=Q('<div><div class="absolute top-4 right-4 menu-container"><button class="text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-100" aria-label="Collection options"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path></svg></button> <!></div> <div class="pr-8"><h3 class="text-xl font-semibold text-gray-900 mb-2"> </h3> <!> <div class="flex items-center justify-between mt-4 pt-4 border-t border-gray-100"><div class="flex items-center text-sm text-gray-500"><svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg> <span class="font-medium"> </span> <span class="ml-1">cards</span></div> <div class="text-xs text-gray-400"> </div></div></div></div>');function rc(r,n){Dt(n,!1);let i=je(n,"collection",8),s=je(n,"onEdit",8,null),c=je(n,"onDelete",8,null),u=je(n,"onClick",8,null),p=oe(!1);function m(){R(p,!h(p))}function g(){R(p,!1),s()&&s()(i())}function y(){R(p,!1),c()&&c()(i())}function B(J){h(p)&&!J.target.closest(".menu-container")&&R(p,!1)}Lt();var S=tc();me("click",Ln,B);let A;var F=j(S),T=j(F),V=K(T,2);{var ee=J=>{var xe=Ju(),Fe=j(xe),De=K(Fe,2);me("click",Fe,g),me("click",De,y),z(J,xe)};pe(V,J=>{h(p)&&J(ee)})}var se=K(F,2),ve=j(se),ge=j(ve),be=K(ve,2);{var X=J=>{var xe=Zu(),Fe=j(xe);Oe(()=>Se(Fe,(Ge(i()),ue(()=>i().description)))),z(J,xe)},ie=J=>{var xe=ec();z(J,xe)};pe(be,J=>{Ge(i()),ue(()=>i().description)?J(X):J(ie,!1)})}var ce=K(be,2),le=j(ce),Pe=K(j(le),2),Be=j(Pe),Le=K(le,2),$e=j(Le);Oe(J=>{A=Br(S,1,"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow p-6 relative",null,A,{"cursor-pointer":u()}),pn(S,"role",u()?"button":null),pn(S,"tabindex",u()?0:null),Se(ge,(Ge(i()),ue(()=>i().name))),Se(Be,(Ge(i()),ue(()=>i().cardCount||0))),Se($e,`Updated ${J??""}`)},[()=>(Ge(mn),Ge(i()),ue(()=>mn(i().updatedAt)))]),me("click",T,Fi(m)),me("click",S,()=>u()&&u()(i())),me("keydown",S,J=>(J.key==="Enter"||J.key===" ")&&u()&&u()(i())),z(r,S),Mt()}var nc=Q('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>'),oc=Q('<button class="inline-flex items-center px-6 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Create Your First Collection</button>'),ic=Q('<div class="text-center py-16"><div class="inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4"><svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div> <h3 class="text-xl font-semibold text-gray-900 mb-2">No collections yet</h3> <p class="text-gray-600 mb-6 max-w-sm mx-auto">Get started by creating your first collection to organize your flashcards.</p> <!></div>'),ac=Q("<div><!></div>");function sc(r,n){Dt(n,!1);let i=je(n,"collections",24,()=>[]),s=je(n,"onEdit",8,null),c=je(n,"onDelete",8,null),u=je(n,"onCreate",8,null),p=je(n,"onClick",8,null);Lt();var m=ac(),g=j(m);{var y=S=>{var A=nc();Bs(A,5,i,F=>F.id,(F,T)=>{rc(F,{get collection(){return h(T)},get onEdit(){return s()},get onDelete(){return c()},get onClick(){return p()}})}),z(S,A)},B=S=>{var A=ic(),F=K(j(A),6);{var T=V=>{var ee=oc();me("click",ee,function(...se){u()?.apply(this,se)}),z(V,ee)};pe(F,V=>{u()&&V(T)})}z(S,A)};pe(g,S=>{Ge(i()),ue(()=>i().length>0)?S(y):S(B,!1)})}z(r,m),Mt()}var lc=Q('<div class="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"> </div>'),uc=Q('<p class="text-sm text-red-600"> </p>'),cc=Q('<p class="text-xs text-gray-500">Required</p>'),fc=Q('<p class="text-sm text-red-600"> </p>'),dc=Q("<div></div>"),vc=Et('<svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Saving...',1),hc=Q('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center p-4 z-50 overflow-y-auto" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white rounded-lg shadow-xl max-w-md w-full max-h-[85dvh] overflow-y-auto my-auto"><div class="flex items-center justify-between p-6 border-b border-gray-200"><h2 id="modal-title" class="text-2xl font-semibold text-gray-900"> </h2> <button class="p-2 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors" aria-label="Close"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6"><!> <div class="mb-4"><label for="collection-name" class="block text-sm font-medium text-gray-700 mb-2">Collection Name <span class="text-red-500">*</span></label> <input id="collection-name" type="text" placeholder="e.g., Spanish Vocabulary" maxlength="100"/> <div class="flex items-center justify-between mt-1"><!> <p class="text-xs text-gray-400"> </p></div></div> <div class="mb-6"><label for="collection-description" class="block text-sm font-medium text-gray-700 mb-2">Description <span class="text-gray-400 text-xs">(optional)</span></label> <textarea id="collection-description" placeholder="Add a description to help you remember what this collection is for..." maxlength="500" rows="4"></textarea> <div class="flex items-center justify-between mt-1"><!> <p class="text-xs text-gray-400"> </p></div></div> <div class="flex gap-3"><button type="button" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Cancel</button> <button type="submit" class="flex-1 px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"><!></button></div></form></div></div>');function pc(r,n){Dt(n,!1);const i=oe(),s=oe(),c=oe();let u=je(n,"collection",8,null),p=je(n,"isOpen",8,!1);const m=kn();let g=oe(u()?.name||""),y=oe(u()?.description||""),B=oe(!1),S=oe({});function A(){u()||(R(g,""),R(y,"")),R(S,{}),R(B,!1)}function F(){return R(S,{}),h(g).trim()?h(g).trim().length>100&&Pt(S,h(S).name="Collection name must be 100 characters or less"):Pt(S,h(S).name="Collection name is required"),h(y).length>500&&Pt(S,h(S).description="Description must be 500 characters or less"),Object.keys(h(S)).length===0}async function T(){if(F()){R(B,!0);try{const X={name:h(g).trim(),description:h(y).trim()};h(i)?m("update",{id:u().id,...X}):m("create",X),V()}catch(X){console.error("Failed to submit:",X),Pt(S,h(S).general="Failed to save collection. Please try again.")}finally{R(B,!1)}}}function V(){m("close"),A()}function ee(X){X.target===X.currentTarget&&V()}function se(X){X.key==="Escape"&&V()}ht(()=>Ge(u()),()=>{u()&&(R(g,u().name||""),R(y,u().description||""))}),ht(()=>Ge(p()),()=>{p()||A()}),ht(()=>Ge(u()),()=>{R(i,u()!==null)}),ht(()=>h(i),()=>{R(s,h(i)?"Edit Collection":"New Collection")}),ht(()=>h(i),()=>{R(c,h(i)?"Save Changes":"Create Collection")}),_n(),Lt();var ve=Ii(),ge=Or(ve);{var be=X=>{var ie=hc(),ce=j(ie),le=j(ce),Pe=j(le),Be=j(Pe),Le=K(Pe,2),$e=K(le,2),J=j($e);{var xe=we=>{var Te=lc(),Xe=j(Te);Oe(()=>Se(Xe,(h(S),ue(()=>h(S).general)))),z(we,Te)};pe(J,we=>{h(S),ue(()=>h(S).general)&&we(xe)})}var Fe=K(J,2),De=K(j(Fe),2);let He;var qe=K(De,2),Ce=j(qe);{var Ve=we=>{var Te=uc(),Xe=j(Te);Oe(()=>Se(Xe,(h(S),ue(()=>h(S).name)))),z(we,Te)},ot=we=>{var Te=cc();z(we,Te)};pe(Ce,we=>{h(S),ue(()=>h(S).name)?we(Ve):we(ot,!1)})}var q=K(Ce,2),ae=j(q),ke=K(Fe,2),Ze=K(j(ke),2);let ft;var fe=K(Ze,2),Re=j(fe);{var dt=we=>{var Te=fc(),Xe=j(Te);Oe(()=>Se(Xe,(h(S),ue(()=>h(S).description)))),z(we,Te)},Y=we=>{var Te=dc();z(we,Te)};pe(Re,we=>{h(S),ue(()=>h(S).description)?we(dt):we(Y,!1)})}var Je=K(Re,2),he=j(Je),lt=K(ke,2),_e=j(lt),Me=K(_e,2),re=j(Me);{var de=we=>{var Te=vc();z(we,Te)},Ae=we=>{var Te=Os();Oe(()=>Se(Te,h(c))),z(we,Te)};pe(re,we=>{h(B)?we(de):we(Ae,!1)})}Oe(()=>{Se(Be,h(s)),He=Br(De,1,"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-colors text-base",null,He,{"border-red-500":h(S).name}),De.disabled=h(B),Se(ae,`${h(g),ue(()=>h(g).length)??""}/100`),ft=Br(Ze,1,"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-colors resize-none text-base",null,ft,{"border-red-500":h(S).description}),Ze.disabled=h(B),Se(he,`${h(y),ue(()=>h(y).length)??""}/500`),_e.disabled=h(B),Me.disabled=h(B)}),me("click",Le,V),Ci(De,()=>h(g),we=>R(g,we)),Ci(Ze,()=>h(y),we=>R(y,we)),me("click",_e,V),me("submit",$e,Ds(T)),me("click",ie,ee),me("keydown",ie,se),z(X,ie)};pe(ge,X=>{p()&&X(be)})}z(r,ve),Mt()}function mc(){const{subscribe:r,set:n,update:i}=js([]);return{subscribe:r,async load(s){try{const c=await Qe.cards.where("collectionId").equals(s).sortBy("createdAt");return c.reverse(),n(c),console.log("ð Loaded",c.length,"cards for collection",s),c}catch(c){throw console.error("Failed to load cards:",c),n([]),c}},async create(s,c){try{const u=new Hu({collectionId:s,text:c.text,imageBlob:c.imageBlob||null,audioBlob:c.audioBlob||null});return await Qe.cards.add(u),i(p=>[u,...p]),await Ia(s),console.log("â Created card:",u.id),u}catch(u){throw console.error("Failed to create card:",u),u}},async update(s,c){try{await Qe.cards.update(s,c),i(u=>u.map(p=>p.id===s?{...p,...c}:p)),console.log("â Updated card:",s)}catch(u){throw console.error("Failed to update card:",u),u}},async delete(s,c){try{await Qe.cards.delete(s),i(u=>u.filter(p=>p.id!==s)),await Ia(c),console.log("ðï¸ Deleted card:",s)}catch(u){throw console.error("Failed to delete card:",u),u}},async getById(s){try{return await Qe.cards.get(s)}catch(c){throw console.error("Failed to get card:",c),c}},async markAsReviewed(s){try{const c=await Qe.cards.get(s);if(!c)return;await Qe.cards.update(s,{lastReviewedAt:Date.now(),reviewCount:(c.reviewCount||0)+1}),i(u=>u.map(p=>p.id===s?{...p,lastReviewedAt:Date.now(),reviewCount:(p.reviewCount||0)+1}:p)),console.log("ð Marked card as reviewed:",s)}catch(c){throw console.error("Failed to mark card as reviewed:",c),c}},clear(){n([])}}}async function Ia(r){try{const n=await Qe.cards.where("collectionId").equals(r).count();await ur.updateCardCount(r,n)}catch(n){console.error("Failed to update collection card count:",n)}}const kr=mc();var gc=Q('<div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10"><button class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit</button> <button class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> Delete</button></div>'),yc=Q('<img alt="Card thumbnail" class="flex-shrink-0 w-16 h-16 object-cover rounded mr-3"/>'),bc=Q('<div class="flex-shrink-0 w-8 h-8 bg-indigo-100 rounded flex items-center justify-center mr-3"><svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg></div>'),_c=Q('<span class="inline-flex items-center mt-1 text-xs text-indigo-600"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg> Multi-line</span>'),wc=Q('<span class="inline-flex items-center px-2 py-1 bg-green-100 text-green-700 text-xs rounded"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path></svg> Photo</span>'),xc=Q('<span class="inline-flex items-center px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"></path></svg> Audio</span>'),kc=Q('<span class="flex items-center"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path></svg> </span>'),Cc=Q('<div class="bg-white rounded-lg border border-gray-200 hover:border-indigo-300 hover:shadow-md transition-all p-4 relative group"><div class="absolute top-3 right-3 menu-container"><button class="text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-100 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Card options"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path></svg></button> <!></div> <div class="pr-8"><div class="flex items-start mb-2"><!> <div class="flex-1 min-w-0"><p class="text-sm text-gray-900 whitespace-pre-wrap break-words"> </p> <!></div></div> <div class="flex items-center gap-2 mt-3"><!> <!></div> <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-100"><div class="flex items-center gap-3 text-xs text-gray-500"><!> <span> </span></div></div></div></div>');function Ec(r,n){Dt(n,!1);const i=oe();let s=je(n,"card",8),c=je(n,"onEdit",8,null),u=je(n,"onDelete",8,null),p=oe(!1);function m(){R(p,!h(p))}function g(){R(p,!1),c()&&c()(s())}function y(){R(p,!1),u()&&u()(s())}function B(q){h(p)&&!q.target.closest(".menu-container")&&R(p,!1)}function S(q){const ae=q.split(`
`).filter(Ze=>Ze.trim());if(ae.length===0)return"Empty card";const ke=ae.slice(0,2).join(`
`);return Wu(ke,150)}ht(()=>Ge(s()),()=>{R(i,s().text.split(`
`).filter(q=>q.trim()).length>1)}),_n(),Lt();var A=Cc();me("click",Ln,B);var F=j(A),T=j(F),V=K(T,2);{var ee=q=>{var ae=gc(),ke=j(ae),Ze=K(ke,2);me("click",ke,g),me("click",Ze,y),z(q,ae)};pe(V,q=>{h(p)&&q(ee)})}var se=K(F,2),ve=j(se),ge=j(ve);{var be=q=>{var ae=yc();Oe(ke=>pn(ae,"src",ke),[()=>(Ge(s()),ue(()=>URL.createObjectURL(s().imageBlob)))]),z(q,ae)},X=q=>{var ae=bc();z(q,ae)};pe(ge,q=>{Ge(s()),ue(()=>s().imageBlob)?q(be):q(X,!1)})}var ie=K(ge,2),ce=j(ie),le=j(ce),Pe=K(ce,2);{var Be=q=>{var ae=_c();z(q,ae)};pe(Pe,q=>{h(i)&&q(Be)})}var Le=K(ve,2),$e=j(Le);{var J=q=>{var ae=wc();z(q,ae)};pe($e,q=>{Ge(s()),ue(()=>s().imageBlob)&&q(J)})}var xe=K($e,2);{var Fe=q=>{var ae=xc();z(q,ae)};pe(xe,q=>{Ge(s()),ue(()=>s().audioBlob)&&q(Fe)})}var De=K(Le,2),He=j(De),qe=j(He);{var Ce=q=>{var ae=kc(),ke=K(j(ae));Oe(()=>Se(ke,` Reviewed ${Ge(s()),ue(()=>s().reviewCount)??""}x`)),z(q,ae)};pe(qe,q=>{Ge(s()),ue(()=>s().reviewCount>0)&&q(Ce)})}var Ve=K(qe,2),ot=j(Ve);Oe((q,ae)=>{Se(le,q),Se(ot,`Created ${ae??""}`)},[()=>(Ge(s()),ue(()=>S(s().text))),()=>(Ge(mn),Ge(s()),ue(()=>mn(s().createdAt)))]),me("click",T,Fi(m)),z(r,A),Mt()}var Sc=Q('<div class="space-y-3"></div>'),Ac=Q('<button class="inline-flex items-center px-6 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors shadow-sm"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add Your First Card</button>'),Oc=Q('<div class="text-center py-16 bg-white rounded-lg border-2 border-dashed border-gray-300"><div class="inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4"><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg></div> <h3 class="text-xl font-semibold text-gray-900 mb-2">No cards yet</h3> <p class="text-gray-600 mb-6 max-w-sm mx-auto">Start building your collection by adding your first flashcard.</p> <!></div>'),Pc=Q("<div><!></div>");function Bc(r,n){Dt(n,!1);let i=je(n,"cards",24,()=>[]),s=je(n,"onEdit",8,null),c=je(n,"onDelete",8,null),u=je(n,"onCreate",8,null);Lt();var p=Pc(),m=j(p);{var g=B=>{var S=Sc();Bs(S,5,i,A=>A.id,(A,F)=>{Ec(A,{get card(){return h(F)},get onEdit(){return s()},get onDelete(){return c()}})}),z(B,S)},y=B=>{var S=Oc(),A=K(j(S),6);{var F=T=>{var V=Ac();me("click",V,function(...ee){u()?.apply(this,ee)}),z(T,V)};pe(A,T=>{u()&&T(F)})}z(B,S)};pe(m,B=>{Ge(i()),ue(()=>i().length>0)?B(g):B(y,!1)})}z(r,p),Mt()}async function Dc(r,n=800,i=800,s=.8){return new Promise((c,u)=>{const p=new FileReader;p.onload=m=>{const g=new Image;g.onload=()=>{try{const y=document.createElement("canvas"),B=y.getContext("2d");let{width:S,height:A}=g;S>A?S>n&&(A=A*n/S,S=n):A>i&&(S=S*i/A,A=i),y.width=S,y.height=A,B.drawImage(g,0,0,S,A),y.toBlob(F=>{F?(console.log(`â Image compressed: ${(r.size/1024).toFixed(1)}KB â ${(F.size/1024).toFixed(1)}KB`),c(F)):y.toBlob(T=>{T?(console.log(`â Image compressed (JPEG): ${(r.size/1024).toFixed(1)}KB â ${(T.size/1024).toFixed(1)}KB`),c(T)):u(new Error("Failed to compress image"))},"image/jpeg",s)},"image/webp",s)}catch(y){u(y)}},g.onerror=()=>{u(new Error("Failed to load image"))},g.src=m.target.result},p.onerror=()=>{u(new Error("Failed to read file"))},p.readAsDataURL(r)})}function Mc(r){return r&&["image/jpeg","image/png","image/gif","image/webp"].includes(r.type)}function jc(r){return new Promise((n,i)=>{const s=new FileReader;s.onload=()=>{n(s.result)},s.onerror=()=>{i(new Error("Failed to read blob"))},s.readAsDataURL(r)})}var Rc=Q('<div class="absolute inset-0 bg-black bg-opacity-50 rounded-lg flex items-center justify-center"><div class="text-white text-center"><svg class="animate-spin h-8 w-8 mx-auto mb-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-sm">Compressing...</p></div></div>'),Tc=Q('<div class="relative"><img alt="Selected" class="w-full h-48 object-cover rounded-lg border border-gray-300"/> <button type="button" class="absolute top-2 right-2 p-2 bg-red-600 hover:bg-red-700 text-white rounded-lg shadow-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed" title="Remove photo"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button> <!></div>'),Ic=Q('<svg class="animate-spin h-8 w-8 text-indigo-600 mb-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-sm text-gray-600">Compressing image...</p>',1),Fc=Q('<svg class="w-12 h-12 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <p class="text-sm font-medium text-gray-700 mb-1">Add a photo</p> <p class="text-xs text-gray-500">Click to upload or take a photo</p> <p class="text-xs text-gray-400 mt-1">JPEG, PNG, GIF, or WebP (max 10MB)</p>',1),Kc=Q('<button type="button" class="w-full flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button>'),Nc=Q('<div class="p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm flex items-start"><svg class="w-5 h-5 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg> <span> </span></div>'),Lc=Q('<div class="space-y-3"><input type="file" accept="image/jpeg,image/png,image/gif,image/webp" capture="environment" class="hidden"/> <!> <!></div>');function qc(r,n){Dt(n,!1);let i=je(n,"imageBlob",8,null),s=je(n,"disabled",8,!1);const c=kn();let u=oe(),p=oe(!1),m=oe(null),g=oe(null);async function y(){if(i())try{R(m,await jc(i()))}catch(X){console.error("Failed to create preview:",X)}}async function B(X){const ie=X.target.files?.[0];ie&&(await S(ie),h(u)&&Pt(u,h(u).value=""))}async function S(X){if(R(g,null),!Mc(X)){R(g,"Please select a valid image file (JPEG, PNG, GIF, or WebP)");return}if(X.size>10*1024*1024){R(g,"Image is too large (max 10MB)");return}R(p,!0);try{const ie=await Dc(X);ie.size>500*1024&&console.warn("Compressed image is larger than 500KB:",(ie.size/1024).toFixed(1)+"KB"),c("change",ie)}catch(ie){console.error("Failed to compress image:",ie),R(g,"Failed to compress image. Please try another image.")}finally{R(p,!1)}}function A(){c("change",null),R(g,null)}function F(){h(u)&&!s()&&h(u).click()}ht(()=>Ge(i()),()=>{i()?y():R(m,null)}),_n(),Lt();var T=Lc(),V=j(T);Po(V,X=>R(u,X),()=>h(u));var ee=K(V,2);{var se=X=>{var ie=Tc(),ce=j(ie),le=K(ce,2),Pe=K(le,2);{var Be=Le=>{var $e=Rc();z(Le,$e)};pe(Pe,Le=>{h(p)&&Le(Be)})}Oe(()=>{pn(ce,"src",h(m)),le.disabled=s()||h(p)}),me("click",le,A),z(X,ie)},ve=X=>{var ie=Kc(),ce=j(ie);{var le=Be=>{var Le=Ic();z(Be,Le)},Pe=Be=>{var Le=Fc();z(Be,Le)};pe(ce,Be=>{h(p)?Be(le):Be(Pe,!1)})}Oe(()=>ie.disabled=s()||h(p)),me("click",ie,F),z(X,ie)};pe(ee,X=>{h(m)?X(se):X(ve,!1)})}var ge=K(ee,2);{var be=X=>{var ie=Nc(),ce=K(j(ie),2),le=j(ce);Oe(()=>Se(le,h(g))),z(X,ie)};pe(ge,X=>{h(g)&&X(be)})}Oe(()=>V.disabled=s()),me("change",V,B),z(r,T),Mt()}let zc=class{constructor(){this.mediaRecorder=null,this.audioChunks=[],this.stream=null,this.startTime=null,this.duration=0}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:24e3,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});const n=this.getSupportedMimeType();if(!n)throw new Error("No supported audio format found");this.mediaRecorder=new MediaRecorder(this.stream,{mimeType:n,audioBitsPerSecond:32e3}),this.audioChunks=[],this.mediaRecorder.ondataavailable=i=>{i.data.size>0&&this.audioChunks.push(i.data)},this.mediaRecorder.start(),this.startTime=Date.now(),console.log("â Recording started:",n)}catch(n){throw console.error("Failed to start recording:",n),this.cleanup(),n}}async stop(){return new Promise((n,i)=>{if(!this.mediaRecorder||this.mediaRecorder.state==="inactive"){i(new Error("No active recording"));return}this.mediaRecorder.onstop=()=>{try{this.duration=Date.now()-this.startTime;const s=this.mediaRecorder.mimeType,c=new Blob(this.audioChunks,{type:s});console.log(`â Recording stopped: ${(c.size/1024).toFixed(1)}KB, ${(this.duration/1e3).toFixed(1)}s`),this.cleanup(),n(c)}catch(s){i(s)}},this.mediaRecorder.onerror=s=>{console.error("MediaRecorder error:",s),this.cleanup(),i(s)},this.mediaRecorder.stop()})}getSupportedMimeType(){const n=["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/mp4","audio/mpeg"];for(const i of n)if(MediaRecorder.isTypeSupported(i))return i;return null}isRecording(){return this.mediaRecorder&&this.mediaRecorder.state==="recording"}getDuration(){return this.isRecording()?Date.now()-this.startTime:this.duration}cleanup(){this.stream&&(this.stream.getTracks().forEach(n=>n.stop()),this.stream=null),this.mediaRecorder=null,this.audioChunks=[]}};function Uc(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&typeof MediaRecorder<"u")}function Fa(r){const n=Math.floor(r/1e3),i=Math.floor(n/60),s=n%60;return`${i}:${s.toString().padStart(2,"0")}`}function Ka(r){return URL.createObjectURL(r)}var Vc=Q(`<div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-800 text-sm"><p class="font-medium mb-1">Audio recording not supported</p> <p>Your browser doesn't support audio recording. Please use a modern browser like Chrome, Firefox, or Safari.</p></div>`),$c=Et('<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>'),Hc=Et('<svg class="w-5 h-5 ml-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>'),Yc=Q('<div class="p-4 bg-gray-50 rounded-lg border border-gray-300"><div class="flex items-center justify-between mb-3"><div class="flex items-center text-sm text-gray-700"><svg class="w-5 h-5 text-purple-600 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"></path></svg> <span class="font-medium">Audio recorded</span></div> <button type="button" class="text-red-600 hover:text-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed">Remove</button></div> <audio class="hidden"></audio> <div class="flex items-center gap-3"><button type="button" class="flex-shrink-0 w-10 h-10 bg-purple-600 hover:bg-purple-700 text-white rounded-full flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed transition-colors"><!></button> <div class="flex-1 text-sm text-gray-600"><p>Click play to preview your recording</p></div></div></div>'),Wc=Q('<div class="p-6 bg-red-50 border-2 border-red-300 rounded-lg"><div class="flex flex-col items-center"><div class="relative mb-4"><div class="w-16 h-16 bg-red-600 rounded-full animate-pulse flex items-center justify-center"><svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z" clip-rule="evenodd"></path></svg></div></div> <div class="text-3xl font-bold text-red-900 mb-2 font-mono"> </div> <p class="text-sm text-red-700 mb-4">Recording...</p> <button type="button" class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors">Stop Recording</button></div></div>'),Gc=Q('<button type="button" class="w-full flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><svg class="w-12 h-12 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg> <p class="text-sm font-medium text-gray-700 mb-1">Record audio</p> <p class="text-xs text-gray-500">Click to start recording</p></button>'),Xc=Q('<div class="p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm flex items-start"><svg class="w-5 h-5 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg> <span> </span></div>'),Qc=Q('<div class="space-y-3"><!> <!></div>');function Jc(r,n){Dt(n,!1);let i=je(n,"audioBlob",8,null),s=je(n,"disabled",8,!1);const c=kn();let u=null,p=oe(!1),m=oe(0),g=null,y=oe(null),B=oe(null),S=oe(),A=oe(!1);const F=Uc();Rs(()=>{V(),h(y)&&URL.revokeObjectURL(h(y))});async function T(){if(R(B,null),!F){R(B,"Audio recording is not supported in this browser");return}try{u=new zc,await u.start(),R(p,!0),R(m,0),g=setInterval(()=>{u&&R(m,u.getDuration())},100)}catch(J){console.error("Failed to start recording:",J),J.name==="NotAllowedError"||J.name==="PermissionDeniedError"?R(B,"Microphone permission denied. Please allow microphone access and try again."):J.name==="NotFoundError"?R(B,"No microphone found. Please connect a microphone and try again."):R(B,"Failed to start recording. Please try again."),R(p,!1),u&&(u.cleanup(),u=null)}}async function V(){if(u){try{const J=await u.stop();g&&(clearInterval(g),g=null),R(p,!1),c("change",J)}catch(J){console.error("Failed to stop recording:",J),R(B,"Failed to save recording. Please try again."),R(p,!1)}u=null}}function ee(){h(y)&&(URL.revokeObjectURL(h(y)),R(y,null)),c("change",null),R(B,null),R(A,!1)}function se(){h(S)&&(h(A)?h(S).pause():h(S).play())}function ve(){R(A,!0)}function ge(){R(A,!1)}function be(){R(A,!1)}ht(()=>(Ge(i()),h(y),Ka),()=>{i()&&(h(y)&&URL.revokeObjectURL(h(y)),R(y,Ka(i())))}),_n(),Lt();var X=Qc(),ie=j(X);{var ce=J=>{var xe=Vc();z(J,xe)},le=J=>{var xe=Yc(),Fe=j(xe),De=K(j(Fe),2),He=K(Fe,2);Po(He,ae=>R(S,ae),()=>h(S));var qe=K(He,2),Ce=j(qe),Ve=j(Ce);{var ot=ae=>{var ke=$c();z(ae,ke)},q=ae=>{var ke=Hc();z(ae,ke)};pe(Ve,ae=>{h(A)?ae(ot):ae(q,!1)})}Oe(()=>{De.disabled=s(),pn(He,"src",h(y)),Ce.disabled=s()}),me("click",De,ee),me("play",He,ve),me("pause",He,ge),me("ended",He,be),me("click",Ce,se),z(J,xe)},Pe=J=>{var xe=Wc(),Fe=j(xe),De=K(j(Fe),2),He=j(De),qe=K(De,4);Oe(Ce=>Se(He,Ce),[()=>(Ge(Fa),h(m),ue(()=>Fa(h(m))))]),me("click",qe,V),z(J,xe)},Be=J=>{var xe=Gc();Oe(()=>xe.disabled=s()),me("click",xe,T),z(J,xe)};pe(ie,J=>{F?h(y)?J(le,1):h(p)?J(Pe,2):J(Be,!1):J(ce)})}var Le=K(ie,2);{var $e=J=>{var xe=Xc(),Fe=K(j(xe),2),De=j(Fe);Oe(()=>Se(De,h(B))),z(J,xe)};pe(Le,J=>{h(B)&&J($e)})}z(r,X),Mt()}var Zc=Q('<div class="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"> </div>'),ef=Q('<p class="text-sm text-red-600"> </p>'),tf=Q('<p class="text-xs text-gray-500">ð¡ Tip: You can use multiple lines to separate question and answer</p>'),rf=Et('<svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Saving...',1),nf=Q('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center p-4 z-50 overflow-y-auto" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[85dvh] overflow-y-auto my-auto"><div class="flex items-center justify-between p-6 border-b border-gray-200"><h2 id="modal-title" class="text-2xl font-semibold text-gray-900"> </h2> <button class="p-2 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors" aria-label="Close"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6"><!> <div class="mb-6"><label for="card-text" class="block text-sm font-medium text-gray-700 mb-2">Card Content <span class="text-red-500">*</span></label> <textarea id="card-text" placeholder="Enter the card content (e.g., question on one line, answer on another)  Example: What is the capital of France? Paris" maxlength="5000" rows="10"></textarea> <div class="flex items-center justify-between mt-1"><!> <p class="text-xs text-gray-400"> </p></div></div> <div class="mb-6"><label class="block text-sm font-medium text-gray-700 mb-2">Photo <span class="text-gray-400 text-xs">(optional)</span></label> <!></div> <div class="mb-6"><label class="block text-sm font-medium text-gray-700 mb-2">Audio <span class="text-gray-400 text-xs">(optional)</span></label> <!></div> <div class="flex gap-3"><button type="button" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Cancel</button> <button type="submit" class="flex-1 px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"><!></button></div></form></div></div>');function of(r,n){Dt(n,!1);const i=oe(),s=oe(),c=oe();let u=je(n,"card",8,null),p=je(n,"isOpen",8,!1);const m=kn();let g=oe(u()?.text||""),y=oe(u()?.imageBlob||null),B=oe(u()?.audioBlob||null),S=oe(!1),A=oe({});function F(){u()||(R(g,""),R(y,null),R(B,null)),R(A,{}),R(S,!1)}function T(le){R(y,le.detail)}function V(le){R(B,le.detail)}function ee(){return R(A,{}),h(g).trim()?h(g).trim().length>5e3&&Pt(A,h(A).text="Card text must be 5000 characters or less"):Pt(A,h(A).text="Card text is required"),Object.keys(h(A)).length===0}async function se(){if(ee()){R(S,!0);try{const le={text:h(g).trim(),imageBlob:h(y),audioBlob:h(B)};h(i)?m("update",{id:u().id,...le}):m("create",le),ve()}catch(le){console.error("Failed to submit:",le),Pt(A,h(A).general="Failed to save card. Please try again.")}finally{R(S,!1)}}}function ve(){m("close"),F()}function ge(le){le.target===le.currentTarget&&ve()}function be(le){le.key==="Escape"&&ve()}ht(()=>Ge(u()),()=>{u()&&(R(g,u().text||""),R(y,u().imageBlob||null),R(B,u().audioBlob||null))}),ht(()=>Ge(p()),()=>{p()||F()}),ht(()=>Ge(u()),()=>{R(i,u()!==null)}),ht(()=>h(i),()=>{R(s,h(i)?"Edit Card":"New Card")}),ht(()=>h(i),()=>{R(c,h(i)?"Save Changes":"Add Card")}),_n(),Lt();var X=Ii(),ie=Or(X);{var ce=le=>{var Pe=nf(),Be=j(Pe),Le=j(Be),$e=j(Le),J=j($e),xe=K($e,2),Fe=K(Le,2),De=j(Fe);{var He=de=>{var Ae=Zc(),we=j(Ae);Oe(()=>Se(we,(h(A),ue(()=>h(A).general)))),z(de,Ae)};pe(De,de=>{h(A),ue(()=>h(A).general)&&de(He)})}var qe=K(De,2),Ce=K(j(qe),2);let Ve;var ot=K(Ce,2),q=j(ot);{var ae=de=>{var Ae=ef(),we=j(Ae);Oe(()=>Se(we,(h(A),ue(()=>h(A).text)))),z(de,Ae)},ke=de=>{var Ae=tf();z(de,Ae)};pe(q,de=>{h(A),ue(()=>h(A).text)?de(ae):de(ke,!1)})}var Ze=K(q,2),ft=j(Ze),fe=K(qe,2),Re=K(j(fe),2);qc(Re,{get imageBlob(){return h(y)},get disabled(){return h(S)},$$events:{change:T}});var dt=K(fe,2),Y=K(j(dt),2);Jc(Y,{get audioBlob(){return h(B)},get disabled(){return h(S)},$$events:{change:V}});var Je=K(dt,2),he=j(Je),lt=K(he,2),_e=j(lt);{var Me=de=>{var Ae=rf();z(de,Ae)},re=de=>{var Ae=Os();Oe(()=>Se(Ae,h(c))),z(de,Ae)};pe(_e,de=>{h(S)?de(Me):de(re,!1)})}Oe(()=>{Se(J,h(s)),Ve=Br(Ce,1,"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-colors resize-y font-mono text-base",null,Ve,{"border-red-500":h(A).text}),Ce.disabled=h(S),Se(ft,`${h(g),ue(()=>h(g).length)??""}/5000`),he.disabled=h(S),lt.disabled=h(S)}),me("click",xe,ve),Ci(Ce,()=>h(g),de=>R(g,de)),me("click",he,ve),me("submit",Fe,Ds(se)),me("click",Pe,ge),me("keydown",Pe,be),z(le,Pe)};pe(ie,le=>{p()&&le(ce)})}z(r,X),Mt()}var af=Q('<div class="flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3"><svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div>'),sf=Q('<div class="flex-shrink-0 w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center mr-3"><svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>'),lf=Q('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" role="dialog" aria-modal="true" aria-labelledby="dialog-title" tabindex="-1"><div class="bg-white rounded-lg shadow-xl max-w-md w-full"><div class="p-6 border-b border-gray-200"><div class="flex items-center"><!> <h2 id="dialog-title" class="text-xl font-semibold text-gray-900"> </h2></div></div> <div class="p-6"><p class="text-gray-600"> </p></div> <div class="p-6 pt-0 flex gap-3"><button type="button" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors"> </button> <button type="button"> </button></div></div></div>');function Ts(r,n){Dt(n,!1);let i=je(n,"isOpen",8,!1),s=je(n,"title",8,"Confirm"),c=je(n,"message",8,"Are you sure?"),u=je(n,"confirmLabel",8,"Confirm"),p=je(n,"cancelLabel",8,"Cancel"),m=je(n,"isDanger",8,!1);const g=kn();function y(){g("confirm"),B()}function B(){g("cancel")}function S(ee){ee.target===ee.currentTarget&&B()}function A(ee){ee.key==="Escape"&&B()}Lt();var F=Ii(),T=Or(F);{var V=ee=>{var se=lf(),ve=j(se),ge=j(ve),be=j(ge),X=j(be);{var ie=Ce=>{var Ve=af();z(Ce,Ve)},ce=Ce=>{var Ve=sf();z(Ce,Ve)};pe(X,Ce=>{m()?Ce(ie):Ce(ce,!1)})}var le=K(X,2),Pe=j(le),Be=K(ge,2),Le=j(Be),$e=j(Le),J=K(Be,2),xe=j(J),Fe=j(xe),De=K(xe,2);let He;var qe=j(De);Oe(()=>{Se(Pe,s()),Se($e,c()),Se(Fe,p()),He=Br(De,1,"flex-1 px-4 py-2 font-medium rounded-lg transition-colors",null,He,{"bg-red-600":m(),"hover:bg-red-700":m(),"bg-indigo-600":!m(),"hover:bg-indigo-700":!m(),"text-white":!0}),Se(qe,u())}),me("click",xe,B),me("click",De,y),me("click",se,S),me("keydown",se,A),z(ee,se)};pe(T,ee=>{i()&&ee(V)})}z(r,F),Mt()}const uf=100;async function Is(){if(typeof window>"u")return;const r=document.querySelector('meta[name="viewport"]');if(!r)return;const n=r.getAttribute("content");r.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),window.scrollTo(0,0),await new Promise(i=>{requestAnimationFrame(()=>setTimeout(i,uf))}),r.setAttribute("content",n)}var cf=Q('<div class="mb-6"><img alt="" class="max-w-full max-h-64 mx-auto rounded-lg shadow-lg object-contain"/></div>'),ff=Q('<div class="text-gray-500 text-sm mb-4 uppercase tracking-wide">Question</div> <p class="text-xl sm:text-3xl text-gray-900 whitespace-pre-wrap leading-relaxed"> </p> <div class="mt-8 text-indigo-600 text-sm"><svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path></svg> Click or press Space to reveal answer</div>',1),df=Q('<div class="text-gray-500 text-sm mb-4 uppercase tracking-wide">Answer</div> <p class="text-xl sm:text-3xl text-gray-900 whitespace-pre-wrap leading-relaxed"> </p> <div class="mt-8 text-green-600 text-sm"><svg class="w-5 h-5 inline-block mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> Click or press Space to see question again</div>',1),vf=Q('<div class="text-center w-full"><!></div>'),hf=Q('<div class="text-center w-full"><p class="text-xl sm:text-3xl text-gray-900 whitespace-pre-wrap leading-relaxed"> </p></div>'),pf=Q('<div class="relative"><div class="bg-white rounded-2xl shadow-2xl p-6 sm:p-12 min-h-[200px] sm:min-h-[400px] flex flex-col items-center justify-center cursor-pointer active:scale-[0.98] transition-transform touch-pan-y" role="button" tabindex="0"><!> <!></div> <div class="absolute -top-4 left-1/2 -translate-x-1/2 bg-indigo-600 text-white px-4 py-2 rounded-full text-sm font-medium shadow-lg"> </div></div>'),mf=Q('<div class="mb-4 w-full max-w-md mx-auto" role="none"><audio controls="" class="w-full"></audio></div> <!>',1),gf=Q('<div class="text-center text-white"><p class="text-xl">No cards to study</p></div>'),yf=Q('<div class="fixed inset-0 bg-gradient-to-br from-indigo-900 to-purple-900 z-50 flex flex-col"><header class="bg-black bg-opacity-30 backdrop-blur-sm border-b border-white border-opacity-10"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex items-center justify-between"><div class="flex items-center gap-4"><button class="p-2 text-white hover:bg-white hover:bg-opacity-10 rounded-lg transition-colors" aria-label="Exit study mode"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <div class="text-white"><h1 class="text-lg font-semibold"> </h1> <p class="text-sm text-indigo-200">Study Mode</p></div></div> <div class="text-white text-right"><div class="text-2xl font-bold"> </div> <div class="text-sm text-indigo-200">Cards</div></div></div></div></header> <div class="flex-1 flex items-center justify-center p-8"><div class="max-w-4xl w-full"><!></div></div> <div class="py-3 text-center"><div class="keyboard-hints text-white text-xs opacity-60 svelte-q1k6k"><span>Arrow keys navigate</span> <span class="mx-3">Â·</span> <span>Space / Enter flip</span> <span class="mx-3">Â·</span> <span>Esc exit</span></div> <div class="touch-hints text-indigo-200 text-xs opacity-70 svelte-q1k6k">Swipe left / right to navigate Â· Tap to flip</div></div></div>');function bf(r,n){Dt(n,!1);const i=()=>Bo(kr,"$cards",s),[s,c]=Do(),u=oe(),p=oe(),m=oe(),g=oe(),y=oe(),B=oe();je(n,"collectionId",8);let S=je(n,"collectionName",8,""),A=je(n,"onExit",8),F=oe(0),T=oe([]),V=new Set,ee=oe(!0),se=oe(null),ve=oe(null);const ge=new Map;let be=oe();function X(_e){h(be)&&(h(be).pause(),_e?Pt(be,h(be).src=_e):h(be).removeAttribute("src"),h(be).load())}function ie(_e){if(!_e){R(se,null),R(ve,null),X(null);return}ge.has(_e.id)||ge.set(_e.id,{imageUrl:_e.imageBlob?URL.createObjectURL(_e.imageBlob):null,audioUrl:_e.audioBlob?URL.createObjectURL(_e.audioBlob):null});const Me=ge.get(_e.id);R(se,Me.imageUrl),R(ve,Me.audioUrl),X(Me.audioUrl)}Mo(async()=>{if(R(T,[...i()]),h(T).length===0){A()();return}ie(h(T)[0]),ce()}),Rs(()=>{for(const{imageUrl:_e,audioUrl:Me}of ge.values())_e&&URL.revokeObjectURL(_e),Me&&URL.revokeObjectURL(Me);ge.clear(),Is()});function ce(){!h(u)||V.has(h(u).id)||(V.add(h(u).id),kr.markAsReviewed(h(u).id))}function le(){h(m)&&(_a(F,-1),R(ee,!0),ie(h(T)[h(F)]),ce())}function Pe(){h(g)&&(_a(F),R(ee,!0),ie(h(T)[h(F)]),ce())}function Be(){R(ee,!h(ee))}function Le(_e){switch(_e.key){case"ArrowLeft":_e.preventDefault(),le();break;case"ArrowRight":_e.preventDefault(),Pe();break;case" ":case"Enter":_e.preventDefault(),Be();break;case"Escape":_e.preventDefault(),A()();break}}function $e(){A()()}function J(_e){const Me=_e.split(`
`).filter(de=>de.trim());if(Me.length<=1)return{front:_e,back:null};const re=Math.ceil(Me.length/2);return{front:Me.slice(0,re).join(`
`),back:Me.slice(re).join(`
`)}}let xe=0;function Fe(_e){xe=_e.changedTouches[0].clientX}function De(_e){const Me=_e.changedTouches[0].clientX-xe,re=50;Me>re?le():Me<-re?Pe():Be()}ht(()=>(h(T),h(F)),()=>{R(u,h(T)[h(F)])}),ht(()=>(h(T),h(F)),()=>{R(p,h(T).length>0?`${h(F)+1} / ${h(T).length}`:"0 / 0")}),ht(()=>h(F),()=>{R(m,h(F)>0)}),ht(()=>(h(F),h(T)),()=>{R(g,h(F)<h(T).length-1)}),ht(()=>h(u),()=>{R(y,h(u)&&h(u).text.split(`
`).filter(_e=>_e.trim()).length>1)}),ht(()=>h(u),()=>{R(B,h(u)?J(h(u).text):{front:"",back:null})}),_n(),Lt();var He=yf();me("keydown",Ln,Le);var qe=j(He),Ce=j(qe),Ve=j(Ce),ot=j(Ve),q=j(ot),ae=K(q,2),ke=j(ae),Ze=j(ke),ft=K(ot,2),fe=j(ft),Re=j(fe),dt=K(qe,2),Y=j(dt),Je=j(Y);{var he=_e=>{var Me=mf(),re=Or(Me);let de;var Ae=j(re);Po(Ae,Te=>R(be,Te),()=>h(be));var we=K(re,2);xu(we,()=>(h(u),ue(()=>h(u).id)),Te=>{var Xe=pf(),vt=j(Xe),yt=j(vt);{var bt=_t=>{var Tt=cf(),It=j(Tt);Oe(()=>pn(It,"src",h(se))),z(_t,Tt)};pe(yt,_t=>{h(se)&&_t(bt)})}var jt=K(yt,2);{var it=_t=>{var Tt=vf(),It=j(Tt);{var hr=St=>{var ne=ff(),or=K(Or(ne),2),Wt=j(or);Oe(()=>Se(Wt,(h(B),ue(()=>h(B).front)))),z(St,ne)},En=St=>{var ne=df(),or=K(Or(ne),2),Wt=j(or);Oe(()=>Se(Wt,(h(B),ue(()=>h(B).back)))),z(St,ne)};pe(It,St=>{h(ee)?St(hr):St(En,!1)})}z(_t,Tt)},Rt=_t=>{var Tt=hf(),It=j(Tt),hr=j(It);Oe(()=>Se(hr,(h(u),ue(()=>h(u).text)))),z(_t,Tt)};pe(jt,_t=>{h(y),h(B),ue(()=>h(y)&&h(B).back)?_t(it):_t(Rt,!1)})}var Cn=K(vt,2),Dr=j(Cn);Oe(()=>Se(Dr,`Card ${h(F)+1}`)),me("click",vt,Be),me("touchstart",vt,Fe),me("touchend",vt,De),me("keydown",vt,_t=>(_t.key==="Enter"||_t.key===" ")&&Be()),z(Te,Xe)}),Oe(()=>de=Ou(re,"",de,{display:h(ve)?"block":"none"})),me("click",re,Fi(function(Te){Ru.call(this,n,Te)})),z(_e,Me)},lt=_e=>{var Me=gf();z(_e,Me)};pe(Je,_e=>{h(u)?_e(he):_e(lt,!1)})}Oe(()=>{Se(Ze,S()),Se(Re,h(p))}),me("click",q,$e),z(r,He),Mt(),c()}const _o="1.0";async function wo(r){return new Promise((n,i)=>{const s=new FileReader;s.onloadend=()=>{n({type:r.type,data:s.result})},s.onerror=()=>{i(new Error("Failed to read blob"))},s.readAsDataURL(r)})}function Na(r){if(!r||!r.data)return null;try{const{type:n,data:i}=r,s=atob(i.split(",")[1]),c=new ArrayBuffer(s.length),u=new Uint8Array(c);for(let p=0;p<s.length;p++)u[p]=s.charCodeAt(p);return new Blob([c],{type:n})}catch(n){return console.error("Failed to convert base64 to blob:",n),null}}async function _f(r){try{const n=await Qe.collections.get(r);if(!n)throw new Error("Collection not found");const i=await Qe.cards.where("collectionId").equals(r).toArray();console.log(`ð¦ Exporting collection "${n.name}" with ${i.length} cards...`);const s=await Promise.all(i.map(async m=>({...m,imageBlob:m.imageBlob?await wo(m.imageBlob):null,audioBlob:m.audioBlob?await wo(m.audioBlob):null}))),c={version:_o,exportDate:new Date().toISOString(),collections:[{...n,cards:s}]},u=new Date().toISOString().split("T")[0],p=`${n.name.replace(/[^a-z0-9]/gi,"_")}_${u}.json`;Fs(c,p),console.log("â Export completed")}catch(n){throw console.error("Failed to export collection:",n),n}}async function wf(){try{const r=await Qe.collections.toArray();if(r.length===0)throw new Error("No collections to export");console.log(`ð¦ Exporting all ${r.length} collections...`);const n=await Promise.all(r.map(async u=>{const p=await Qe.cards.where("collectionId").equals(u.id).toArray(),m=await Promise.all(p.map(async g=>({...g,imageBlob:g.imageBlob?await wo(g.imageBlob):null,audioBlob:g.audioBlob?await wo(g.audioBlob):null})));return{...u,cards:m}})),i={version:_o,exportDate:new Date().toISOString(),collections:n},c=`memoria_backup_${new Date().toISOString().split("T")[0]}.json`;Fs(i,c),console.log("â Export completed")}catch(r){throw console.error("Failed to export all collections:",r),r}}async function xf(r,n="merge"){try{const i=await r.text(),s=JSON.parse(i);if(!s.version||!s.collections||!Array.isArray(s.collections))throw new Error("Invalid export file format");s.version!==_o&&console.warn(`Export version mismatch: ${s.version} vs ${_o}`),console.log(`ð¥ Importing ${s.collections.length} collection(s) with strategy: ${n}`);let c=0,u=0,p=0;for(const g of s.collections){const{cards:y,...B}=g;if(await Qe.collections.get(g.id))if(n==="merge"){u++,console.log(`â­ï¸ Skipped existing collection: ${g.name}`);continue}else n==="replace"&&(await Qe.cards.where("collectionId").equals(g.id).delete(),p++,console.log(`ð Replaced collection: ${g.name}`));else c++;if(await Qe.collections.put(B),y&&Array.isArray(y))for(const A of y){const F={...A,imageBlob:A.imageBlob?Na(A.imageBlob):null,audioBlob:A.audioBlob?Na(A.audioBlob):null};await Qe.cards.put(F)}}const m={imported:c,skipped:u,updated:p,total:s.collections.length};return console.log("â Import completed:",m),m}catch(i){throw console.error("Failed to import collections:",i),i}}function Fs(r,n){const i=JSON.stringify(r,null,2),s=new Blob([i],{type:"application/json"}),c=URL.createObjectURL(s),u=document.createElement("a");u.href=c,u.download=n,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c)}async function kf(r){try{const n=await r.text(),i=JSON.parse(n);return i.version?!i.collections||!Array.isArray(i.collections)?{valid:!1,error:"Missing or invalid collections field"}:i.collections.length===0?{valid:!1,error:"No collections in file"}:{valid:!0,version:i.version,collectionsCount:i.collections.length,exportDate:i.exportDate}:{valid:!1,error:"Missing version field"}}catch(n){return{valid:!1,error:n.message||"Invalid JSON file"}}}var Cf=Q('<p class="text-sm text-gray-600 mt-1 line-clamp-1"> </p>'),Ef=Q('<div class="min-w-0"><h1 class="text-2xl font-bold text-gray-900 truncate"> </h1> <!></div>'),Sf=Et('<svg class="animate-spin h-5 w-5 sm:mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),Af=Et('<svg class="w-5 h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>'),Of=Q('<div class="flex flex-wrap gap-2"><button class="inline-flex items-center min-h-[44px] px-3 py-2 text-gray-700 hover:bg-gray-100 font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed" aria-label="Export collection"><!> <span class="hidden sm:inline">Export</span></button> <button class="inline-flex items-center min-h-[44px] px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors shadow-sm" aria-label="Study cards"><svg class="w-5 h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg> <span class="hidden sm:inline">Study</span></button> <button class="inline-flex items-center min-h-[44px] px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors shadow-sm" aria-label="Add card"><svg class="w-5 h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> <span class="hidden sm:inline">Add Card</span></button></div>'),Pf=Q('<div class="flex flex-wrap items-center gap-4 sm:gap-6 mt-4 pt-4 border-t border-gray-100 text-sm text-gray-600"><div class="flex items-center"><svg class="w-4 h-4 mr-2 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg> <span class="font-medium"> </span> <span class="ml-1">cards</span></div> <div class="flex items-center"><svg class="w-4 h-4 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div></div>'),Bf=Et('<svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'),Df=Et('<svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>'),Mf=Q('<div class="fixed top-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-md z-50 animate-slide-in svelte-1e2lypv"><div><div class="flex items-center"><!> <p class="text-gray-900 font-medium"> </p></div></div></div>'),jf=Q('<div class="flex items-center justify-center py-16"><svg class="animate-spin h-8 w-8 text-indigo-600" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div>'),Rf=Q('<div class="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50"><header class="bg-white shadow-sm border-b border-gray-200"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex flex-col gap-3"><div class="flex items-center gap-4"><button class="p-3 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0" aria-label="Back to collections"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></button> <!></div> <!></div> <!></div></header> <!> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!></div></div> <!> <!> <!>',1);function Tf(r,n){Dt(n,!1);const i=()=>Bo(kr,"$cards",s),[s,c]=Do();let u=je(n,"collectionId",8),p=je(n,"onBack",8),m=oe(null),g=oe(!0),y=oe(!1),B=oe(null),S=oe(!1),A=oe(null),F=oe(!1),T=oe(!1),V=oe({show:!1,message:"",type:"success"});Mo(async()=>{await ee()});async function ee(){R(g,!0);try{if(R(m,await ur.getById(u())),!h(m)){console.error("Collection not found:",u()),p()();return}await kr.load(u())}catch(re){console.error("Failed to load collection:",re),se("Failed to load collection","error")}finally{R(g,!1)}}function se(re,de="success"){R(V,{show:!0,message:re,type:de}),setTimeout(()=>{Pt(V,h(V).show=!1)},3e3)}function ve(){R(B,null),R(y,!0)}function ge(re){R(B,re),R(y,!0)}function be(re){R(A,re),R(S,!0)}async function X(re){try{await kr.create(u(),re.detail),se("Card added successfully!")}catch{se("Failed to add card","error")}}async function ie(re){try{const{id:de,...Ae}=re.detail;await kr.update(de,Ae),se("Card updated successfully!")}catch{se("Failed to update card","error")}}async function ce(){if(h(A))try{await kr.delete(h(A).id,u()),se("Card deleted successfully!"),R(A,null)}catch{se("Failed to delete card","error")}}function le(){R(y,!1),R(B,null)}function Pe(){R(S,!1),R(A,null)}function Be(){if(i().length===0){se("Add some cards first before studying!","error");return}R(F,!0)}async function Le(){await Is(),R(F,!1),kr.load(u())}async function $e(){if(i().length===0){se("No cards to export","error");return}R(T,!0);try{await _f(u()),se("Collection exported successfully!")}catch(re){console.error("Export failed:",re),se("Failed to export collection","error")}finally{R(T,!1)}}Lt();var J=Rf(),xe=Or(J),Fe=j(xe),De=j(Fe),He=j(De),qe=j(He),Ce=j(qe),Ve=K(Ce,2);{var ot=re=>{var de=Ef(),Ae=j(de),we=j(Ae),Te=K(Ae,2);{var Xe=vt=>{var yt=Cf(),bt=j(yt);Oe(()=>Se(bt,(h(m),ue(()=>h(m).description)))),z(vt,yt)};pe(Te,vt=>{h(m),ue(()=>h(m).description)&&vt(Xe)})}Oe(()=>Se(we,(h(m),ue(()=>h(m).name)))),z(re,de)};pe(Ve,re=>{h(m)&&re(ot)})}var q=K(qe,2);{var ae=re=>{var de=Of(),Ae=j(de),we=j(Ae);{var Te=bt=>{var jt=Sf();z(bt,jt)},Xe=bt=>{var jt=Af();z(bt,jt)};pe(we,bt=>{h(T)?bt(Te):bt(Xe,!1)})}var vt=K(Ae,2),yt=K(vt,2);Oe(()=>Ae.disabled=h(T)),me("click",Ae,$e),me("click",vt,Be),me("click",yt,ve),z(re,de)};pe(q,re=>{h(g),i(),ue(()=>!h(g)&&i().length>0)&&re(ae)})}var ke=K(He,2);{var Ze=re=>{var de=Pf(),Ae=j(de),we=K(j(Ae),2),Te=j(we),Xe=K(Ae,2),vt=K(j(Xe),2),yt=j(vt);Oe(bt=>{Se(Te,(i(),ue(()=>i().length))),Se(yt,`Updated ${bt??""}`)},[()=>(Ge(mn),h(m),ue(()=>mn(h(m).updatedAt)))]),z(re,de)};pe(ke,re=>{h(m)&&re(Ze)})}var ft=K(Fe,2);{var fe=re=>{var de=Mf(),Ae=j(de);let we;var Te=j(Ae),Xe=j(Te);{var vt=it=>{var Rt=Bf();z(it,Rt)},yt=it=>{var Rt=Df();z(it,Rt)};pe(Xe,it=>{h(V),ue(()=>h(V).type==="success")?it(vt):it(yt,!1)})}var bt=K(Xe,2),jt=j(bt);Oe(()=>{we=Br(Ae,1,"bg-white rounded-lg shadow-lg border-l-4 p-4",null,we,{"border-green-500":h(V).type==="success","border-red-500":h(V).type==="error"}),Se(jt,(h(V),ue(()=>h(V).message)))}),z(re,de)};pe(ft,re=>{h(V),ue(()=>h(V).show)&&re(fe)})}var Re=K(ft,2),dt=j(Re);{var Y=re=>{var de=jf();z(re,de)},Je=re=>{Bc(re,{get cards(){return i()},onCreate:ve,onEdit:ge,onDelete:be})};pe(dt,re=>{h(g)?re(Y):re(Je,!1)})}var he=K(xe,2);of(he,{get isOpen(){return h(y)},get card(){return h(B)},$$events:{create:X,update:ie,close:le}});var lt=K(he,2);{let re=fn(()=>h(A)?"Are you sure you want to delete this card? This action cannot be undone.":"");Ts(lt,{get isOpen(){return h(S)},title:"Delete Card",get message(){return h(re)},confirmLabel:"Delete",cancelLabel:"Cancel",isDanger:!0,$$events:{confirm:ce,cancel:Pe}})}var _e=K(lt,2);{var Me=re=>{{let de=fn(()=>(h(m),ue(()=>h(m)?.name||"")));bf(re,{get collectionId(){return u()},get collectionName(){return h(de)},onExit:Le})}};pe(_e,re=>{h(F)&&re(Me)})}me("click",Ce,function(...re){p()?.apply(this,re)}),z(r,J),Mt(),c()}var If=Et('<svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'),Ff=Et('<svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>'),Kf=Q('<div class="fixed top-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-md z-50 animate-slide-in svelte-anx9w7"><div><div class="flex items-center"><!> <p class="text-gray-900 font-medium"> </p></div></div></div>'),Nf=Et('<svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Exporting...',1),Lf=Et('<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> Export All Collections',1),qf=Q('<p class="text-sm text-gray-500 mt-2">No collections to export</p>'),zf=Et('<svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Importing...',1),Uf=Et('<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg> Import from File',1),Vf=Q('<div class="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50"><header class="bg-white shadow-sm border-b border-gray-200"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex items-center gap-4"><button class="p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors" aria-label="Back to home"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></button> <div><h1 class="text-2xl font-bold text-gray-900">Settings</h1> <p class="text-sm text-gray-600">Manage your data and preferences</p></div></div></div></header> <!> <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="bg-white rounded-lg shadow-md p-6 mb-6"><h2 class="text-xl font-semibold text-gray-900 mb-4">Export Data</h2> <p class="text-gray-600 mb-4">Download all your collections, cards, and media as a JSON file. Use this for backup or to transfer your data to another device.</p> <button class="inline-flex items-center px-6 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"><!></button> <!></div> <div class="bg-white rounded-lg shadow-md p-6"><h2 class="text-xl font-semibold text-gray-900 mb-4">Import Data</h2> <p class="text-gray-600 mb-4">Import collections from a previously exported JSON file. Choose how to handle existing collections.</p> <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Import Strategy</label> <div class="space-y-2"><label class="flex items-center"><input type="radio" class="w-4 h-4 text-indigo-600 focus:ring-indigo-500"/> <span class="ml-2 text-sm"><span class="font-medium text-gray-900">Merge</span> <span class="text-gray-600">- Skip collections that already exist</span></span></label> <label class="flex items-center"><input type="radio" class="w-4 h-4 text-indigo-600 focus:ring-indigo-500"/> <span class="ml-2 text-sm"><span class="font-medium text-gray-900">Replace</span> <span class="text-gray-600">- Overwrite collections with matching IDs</span></span></label></div></div> <input type="file" accept=".json,application/json" class="hidden"/> <button class="inline-flex items-center px-6 py-3 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"><!></button> <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"><p class="text-sm text-yellow-800"><strong>Warning:</strong> Using "Replace" strategy will overwrite existing collections with the same ID. Make sure to export your current data first!</p></div></div> <div class="mt-8 text-center text-sm text-gray-500"><p>Memoria v1.0</p> <p class="mt-1">All data is stored locally on your device</p></div></div></div>');function $f(r,n){Dt(n,!1);const i=()=>Bo(ur,"$collections",s),[s,c]=Do(),u=[];let p=je(n,"onBack",8);kn();let m=oe("merge"),g=oe(!1),y=oe(!1),B=oe(),S=oe({show:!1,message:"",type:"success"});function A(fe,Re="success"){R(S,{show:!0,message:fe,type:Re}),setTimeout(()=>{Pt(S,h(S).show=!1)},4e3)}async function F(){if(i().length===0){A("No collections to export","error");return}R(y,!0);try{await wf(),A(`Exported ${i().length} collection(s) successfully!`)}catch(fe){console.error("Export failed:",fe),A("Failed to export collections","error")}finally{R(y,!1)}}function T(){h(B)&&h(B).click()}async function V(fe){const Re=fe.target.files?.[0];if(!Re)return;const dt=await kf(Re);if(!dt.valid){A(`Invalid file: ${dt.error}`,"error"),h(B)&&Pt(B,h(B).value="");return}R(g,!0);try{const Y=await xf(Re,h(m));await ur.load();const Je=[];Y.imported>0&&Je.push(`${Y.imported} imported`),Y.updated>0&&Je.push(`${Y.updated} updated`),Y.skipped>0&&Je.push(`${Y.skipped} skipped`),A(`Import successful: ${Je.join(", ")}`)}catch(Y){console.error("Import failed:",Y),A(`Failed to import: ${Y.message}`,"error")}finally{R(g,!1),h(B)&&Pt(B,h(B).value="")}}Lt();var ee=Vf(),se=j(ee),ve=j(se),ge=j(ve),be=j(ge),X=K(se,2);{var ie=fe=>{var Re=Kf(),dt=j(Re);let Y;var Je=j(dt),he=j(Je);{var lt=de=>{var Ae=If();z(de,Ae)},_e=de=>{var Ae=Ff();z(de,Ae)};pe(he,de=>{h(S),ue(()=>h(S).type==="success")?de(lt):de(_e,!1)})}var Me=K(he,2),re=j(Me);Oe(()=>{Y=Br(dt,1,"bg-white rounded-lg shadow-lg border-l-4 p-4",null,Y,{"border-green-500":h(S).type==="success","border-red-500":h(S).type==="error"}),Se(re,(h(S),ue(()=>h(S).message)))}),z(fe,Re)};pe(X,fe=>{h(S),ue(()=>h(S).show)&&fe(ie)})}var ce=K(X,2),le=j(ce),Pe=K(j(le),4),Be=j(Pe);{var Le=fe=>{var Re=Nf();z(fe,Re)},$e=fe=>{var Re=Lf();z(fe,Re)};pe(Be,fe=>{h(y)?fe(Le):fe($e,!1)})}var J=K(Pe,2);{var xe=fe=>{var Re=qf();z(fe,Re)};pe(J,fe=>{i(),ue(()=>i().length===0)&&fe(xe)})}var Fe=K(le,2),De=K(j(Fe),4),He=K(j(De),2),qe=j(He),Ce=j(qe);Ce.value=Ce.__value="merge";var Ve=K(qe,2),ot=j(Ve);ot.value=ot.__value="replace";var q=K(De,2);Po(q,fe=>R(B,fe),()=>h(B));var ae=K(q,2),ke=j(ae);{var Ze=fe=>{var Re=zf();z(fe,Re)},ft=fe=>{var Re=Uf();z(fe,Re)};pe(ke,fe=>{h(g)?fe(Ze):fe(ft,!1)})}Oe(()=>{Pe.disabled=(h(y),i(),ue(()=>h(y)||i().length===0)),ae.disabled=h(g)}),me("click",be,function(...fe){p()?.apply(this,fe)}),me("click",Pe,F),Da(u,[],Ce,()=>h(m),fe=>R(m,fe)),Da(u,[],ot,()=>h(m),fe=>R(m,fe)),me("change",q,V),me("click",ae,T),z(r,ee),Mt(),c()}var Hf=Q('<button class="inline-flex items-center min-h-[44px] px-3 py-2 text-gray-700 hover:bg-gray-100 font-medium rounded-lg transition-colors" aria-label="Settings"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> Settings</button>'),Yf=Q('<button class="inline-flex items-center min-h-[44px] px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors shadow-sm"><svg class="w-5 h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> <span class="hidden sm:inline">New Collection</span></button>'),Wf=Q('<header class="bg-white shadow-sm border-b border-gray-200"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex items-center justify-between"><div class="min-w-0"><h1 class="text-2xl font-bold text-gray-900 truncate">Memoria</h1> <p class="text-sm text-gray-600">Your multimedia flashcard companion</p></div> <div class="flex items-center gap-2 flex-shrink-0"><!> <!></div></div></div></header>'),Gf=Et('<svg class="w-5 h-5 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'),Xf=Et('<svg class="w-5 h-5 text-red-500 mr-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>'),Qf=Q('<div class="fixed top-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-md z-50 animate-slide-in svelte-1n46o8q"><div><div class="flex items-center"><!> <p class="text-gray-900 font-medium"> </p></div></div></div>'),Jf=Q('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="bg-white rounded-lg shadow-md p-8 text-center"><div class="inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4"><svg class="w-8 h-8 text-red-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg></div> <h2 class="text-xl font-semibold text-gray-900 mb-2">Database Error</h2> <p class="text-gray-600 mb-4">Failed to initialize the database. Please refresh the page or check browser compatibility.</p> <button class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">Reload Page</button></div></div>'),Zf=Q('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!> <div class="mt-8 text-center"><span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">â Phase 7: Export/Import Functionality</span></div></div>'),ed=Q('<main class="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50"><!> <!> <!></main> <!> <!>',1);function td(r,n){Dt(n,!1);const i=()=>Bo(ur,"$collections",s),[s,c]=Do();let u=oe(!1),p=oe(!1),m=oe(null),g=oe(!1),y=oe(null),B=oe({show:!1,message:"",type:"success"}),S=oe("home"),A=oe(null);Mo(async()=>{Xu(),R(u,await Yu()),h(u)&&await ur.load()});function F(q,ae="success"){R(B,{show:!0,message:q,type:ae}),setTimeout(()=>{Pt(B,h(B).show=!1)},3e3)}function T(){R(m,null),R(p,!0)}function V(q){R(m,q),R(p,!0)}function ee(q){R(y,q),R(g,!0)}async function se(q){try{await ur.create(q.detail),F("Collection created successfully!")}catch{F("Failed to create collection","error")}}async function ve(q){try{const{id:ae,...ke}=q.detail;await ur.update(ae,ke),F("Collection updated successfully!")}catch{F("Failed to update collection","error")}}async function ge(){if(h(y))try{await ur.delete(h(y).id),F("Collection deleted successfully!"),R(y,null)}catch{F("Failed to delete collection","error")}}function be(){R(p,!1),R(m,null)}function X(){R(g,!1),R(y,null)}function ie(q){R(A,q.id),R(S,"collection-detail")}function ce(){R(A,null),R(S,"home")}function le(){R(S,"settings")}Lt();var Pe=ed(),Be=Or(Pe),Le=j(Be);{var $e=q=>{var ae=Wf(),ke=j(ae),Ze=j(ke),ft=K(j(Ze),2),fe=j(ft);{var Re=Je=>{var he=Hf();me("click",he,le),z(Je,he)};pe(fe,Je=>{h(u)&&Je(Re)})}var dt=K(fe,2);{var Y=Je=>{var he=Yf();me("click",he,T),z(Je,he)};pe(dt,Je=>{h(u)&&i().length>0&&Je(Y)})}z(q,ae)};pe(Le,q=>{h(S)==="home"&&q($e)})}var J=K(Le,2);{var xe=q=>{var ae=Qf(),ke=j(ae);let Ze;var ft=j(ke),fe=j(ft);{var Re=he=>{var lt=Gf();z(he,lt)},dt=he=>{var lt=Xf();z(he,lt)};pe(fe,he=>{h(B).type==="success"?he(Re):he(dt,!1)})}var Y=K(fe,2),Je=j(Y);Oe(()=>{Ze=Br(ke,1,"bg-white rounded-lg shadow-lg border-l-4 p-4",null,Ze,{"border-green-500":h(B).type==="success","border-red-500":h(B).type==="error"}),Se(Je,h(B).message)}),z(q,ae)};pe(J,q=>{h(B).show&&q(xe)})}var Fe=K(J,2);{var De=q=>{var ae=Jf(),ke=j(ae),Ze=K(j(ke),6);me("click",Ze,()=>window.location.reload()),z(q,ae)},He=q=>{var ae=Zf(),ke=j(ae);sc(ke,{get collections(){return i()},onCreate:T,onEdit:V,onDelete:ee,onClick:ie}),z(q,ae)},qe=q=>{Tf(q,{get collectionId(){return h(A)},onBack:ce})},Ce=q=>{$f(q,{onBack:ce})};pe(Fe,q=>{h(u)?h(S)==="home"?q(He,1):h(S)==="collection-detail"?q(qe,2):h(S)==="settings"&&q(Ce,3):q(De)})}var Ve=K(Be,2);pc(Ve,{get isOpen(){return h(p)},get collection(){return h(m)},$$events:{create:se,update:ve,close:be}});var ot=K(Ve,2);{let q=fn(()=>h(y)?`Are you sure you want to delete "${h(y).name}"? This will also delete all ${h(y).cardCount||0} cards in this collection. This action cannot be undone.`:"");Ts(ot,{get isOpen(){return h(g)},title:"Delete Collection",get message(){return h(q)},confirmLabel:"Delete",cancelLabel:"Cancel",isDanger:!0,$$events:{confirm:ge,cancel:X}})}z(r,Pe),Mt(),c()}yu(td,{target:document.getElementById("app")});
